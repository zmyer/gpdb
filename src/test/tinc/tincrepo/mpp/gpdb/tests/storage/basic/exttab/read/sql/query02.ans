-- start_ignore
drop external table if exists ext_nation;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_NATION  ( N_NATIONKEY  INTEGER ,
                            N_NAME       CHAR(25) ,
                            N_REGIONKEY  INTEGER ,
                            N_COMMENT    VARCHAR(152))
location ('gpfdist://@hostname@:@gp_port@/nation.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
-- start_ignore
drop external table if exists ext_region;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_REGION  ( R_REGIONKEY  INTEGER ,
                            R_NAME       CHAR(25) ,
                            R_COMMENT    VARCHAR(152))
location ('gpfdist://@hostname@:@gp_port@/region.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
-- start_ignore
drop external table if exists ext_part;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_PART  ( P_PARTKEY     INTEGER ,
                          P_NAME        VARCHAR(55) ,
                          P_MFGR        CHAR(25) ,
                          P_BRAND       CHAR(10) ,
                          P_TYPE        VARCHAR(25) ,
                          P_SIZE        INTEGER ,
                          P_CONTAINER   CHAR(10) ,
                          P_RETAILPRICE DECIMAL(15,2) ,
                          P_COMMENT     VARCHAR(23)  )
location ('gpfdist://@hostname@:@gp_port@/part.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
-- start_ignore
drop external table if exists ext_supplier;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_SUPPLIER ( S_SUPPKEY     INTEGER ,
                             S_NAME        CHAR(25) ,
                             S_ADDRESS     VARCHAR(40) ,
                             S_NATIONKEY   INTEGER ,
                             S_PHONE       CHAR(15) ,
                             S_ACCTBAL     DECIMAL(15,2) ,
                             S_COMMENT     VARCHAR(101) )
location ('gpfdist://@hostname@:@gp_port@/supplier.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
-- start_ignore
drop external table if exists ext_partsupp;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_PARTSUPP ( PS_PARTKEY     INTEGER ,
                             PS_SUPPKEY     INTEGER ,
                             PS_AVAILQTY    INTEGER ,
                             PS_SUPPLYCOST  DECIMAL(15,2)  ,
                             PS_COMMENT     VARCHAR(199)  )
location ('gpfdist://@hostname@:@gp_port@/partsupp.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
-- start_ignore
drop external table if exists ext_customer;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_CUSTOMER ( C_CUSTKEY     INTEGER ,
                             C_NAME        VARCHAR(25) ,
                             C_ADDRESS     VARCHAR(40) ,
                             C_NATIONKEY   INTEGER ,
                             C_PHONE       CHAR(15) ,
                             C_ACCTBAL     DECIMAL(15,2)   ,
                             C_MKTSEGMENT  CHAR(10) ,
                             C_COMMENT     VARCHAR(117) )
location ('gpfdist://@hostname@:@gp_port@/customer.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
-- start_ignore
drop external table if exists ext_orders;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_ORDERS  ( O_ORDERKEY       INTEGER ,
                           O_CUSTKEY        INTEGER ,
                           O_ORDERSTATUS    CHAR(1) ,
                           O_TOTALPRICE     DECIMAL(15,2) ,
                           O_ORDERDATE      DATE ,
                           O_ORDERPRIORITY  CHAR(15) ,  
                           O_CLERK          CHAR(15) , 
                           O_SHIPPRIORITY   INTEGER ,
                           O_COMMENT        VARCHAR(79) )
location ('gpfdist://@hostname@:@gp_port@/orders.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
-- start_ignore
drop external table if exists ext_lineitem;
DROP EXTERNAL TABLE
-- end_ignore
CREATE EXTERNAL TABLE EXT_LINEITEM ( L_ORDERKEY    INTEGER ,
                             L_PARTKEY     INTEGER ,
                             L_SUPPKEY     INTEGER ,
                             L_LINENUMBER  INTEGER ,
                             L_QUANTITY    DECIMAL(15,2) ,
                             L_EXTENDEDPRICE  DECIMAL(15,2) ,
                             L_DISCOUNT    DECIMAL(15,2) ,
                             L_TAX         DECIMAL(15,2) ,
                             L_RETURNFLAG  CHAR(1) ,
                             L_LINESTATUS  CHAR(1) ,
                             L_SHIPDATE    DATE ,
                             L_COMMITDATE  DATE ,
                             L_RECEIPTDATE DATE ,
                             L_SHIPINSTRUCT CHAR(25) ,
                             L_SHIPMODE     CHAR(10) ,
                             L_COMMENT      VARCHAR(44) )
location ('gpfdist://@hostname@:@gp_port@/lineitem.tbl' )
FORMAT 'text' (delimiter '|');
CREATE EXTERNAL TABLE
SELECT * FROM EXT_NATION;
 n_nationkey |          n_name           | n_regionkey |                                                     n_comment                                                      
-------------+---------------------------+-------------+--------------------------------------------------------------------------------------------------------------------
           0 | ALGERIA                   |           0 |  haggle. carefully final deposits detect slyly agai
           1 | ARGENTINA                 |           1 | al foxes promise slyly according to the regular accounts. bold requests alon
           2 | BRAZIL                    |           1 | y alongside of the pending deposits. carefully special packages are about the ironic forges. slyly special 
           3 | CANADA                    |           1 | eas hang ironic, silent packages. slyly regular packages are furiously over the tithes. fluffily bold
           4 | EGYPT                     |           4 | y above the carefully unusual theodolites. final dugouts are quickly across the furiously regular d
           5 | ETHIOPIA                  |           0 | ven packages wake quickly. regu
           6 | FRANCE                    |           3 | refully final requests. regular, ironi
           7 | GERMANY                   |           3 | l platelets. regular accounts x-ray: unusual, regular acco
           8 | INDIA                     |           2 | ss excuses cajole slyly across the packages. deposits print aroun
           9 | INDONESIA                 |           2 |  slyly express asymptotes. regular deposits haggle slyly. carefully ironic hockey players sleep blithely. carefull
          10 | IRAN                      |           4 | efully alongside of the slyly final dependencies. 
          11 | IRAQ                      |           4 | nic deposits boost atop the quickly final requests? quickly regula
          12 | JAPAN                     |           2 | ously. final, express gifts cajole a
          13 | JORDAN                    |           4 | ic deposits are blithely about the carefully regular pa
          14 | KENYA                     |           0 |  pending excuses haggle furiously deposits. pending, express pinto beans wake fluffily past t
          15 | MOROCCO                   |           0 | rns. blithely bold courts among the closely regular packages use furiously bold platelets?
          16 | MOZAMBIQUE                |           0 | s. ironic, unusual asymptotes wake blithely r
          17 | PERU                      |           1 | platelets. blithely pending dependencies use fluffily across the even pinto beans. carefully silent accoun
          18 | CHINA                     |           2 | c dependencies. furiously express notornis sleep slyly regular accounts. ideas sleep. depos
          19 | ROMANIA                   |           3 | ular asymptotes are about the furious multipliers. express dependencies nag above the ironically ironic account
          20 | SAUDI ARABIA              |           4 | ts. silent requests haggle. closely express packages sleep across the blithely
          21 | VIETNAM                   |           2 | hely enticingly express accounts. even, final 
          22 | RUSSIA                    |           3 |  requests against the platelets use never according to the quickly regular pint
          23 | UNITED KINGDOM            |           3 | eans boost carefully special requests. accounts are. carefull
          24 | UNITED STATES             |           1 | y final packages. slow foxes cajole quickly. quickly silent platelets breach ironic accounts. unusual pinto be
(25 rows)

SELECT * FROM EXT_REGION;
 r_regionkey |          r_name           |                                                      r_comment                                                      
-------------+---------------------------+---------------------------------------------------------------------------------------------------------------------
           0 | AFRICA                    | lar deposits. blithely final packages cajole. regular waters are final requests. regular accounts are according to 
           1 | AMERICA                   | hs use ironic, even requests. s
           2 | ASIA                      | ges. thinly even pinto beans ca
           3 | EUROPE                    | ly final courts cajole furiously final excuse
           4 | MIDDLE EAST               | uickly special accounts cajole carefully blithely close requests. carefully final asymptotes haggle furiousl
(5 rows)

SELECT count(*) FROM EXT_PART;
 count 
-------
  2000
(1 row)

SELECT * FROM EXT_SUPPLIER;
 s_suppkey |          s_name           |                s_address                 | s_nationkey |     s_phone     | s_acctbal |                                              s_comment                                               
-----------+---------------------------+------------------------------------------+-------------+-----------------+-----------+------------------------------------------------------------------------------------------------------
         1 | Supplier#000000001        |  N kD4on9OM Ipw3,gf0JBoQDd7tgrzrddZ      |          17 | 27-918-335-1736 |   5755.94 | each slyly above the careful
         2 | Supplier#000000002        | 89eJ5ksX3ImxJQBvxObC,                    |           5 | 15-679-861-2259 |   4032.68 |  slyly bold instructions. idle dependen
         3 | Supplier#000000003        | q1,G3Pj6OjIuUYfUoH18BFTKP5aU9bEV3        |           1 | 11-383-516-1199 |   4192.40 | blithely silent requests after the express dependencies are sl
         4 | Supplier#000000004        | Bk7ah4CK8SYQTepEmvMkkgMwg                |          15 | 25-843-787-7479 |   4641.08 | riously even requests above the exp
         5 | Supplier#000000005        | Gcdm2rJRzl5qlTVzc                        |          11 | 21-151-690-3663 |   -283.84 | . slyly regular pinto bea
         6 | Supplier#000000006        | tQxuVm7s7CnK                             |          14 | 24-696-997-4969 |   1365.79 | final accounts. regular dolphins use against the furiously ironic decoys. 
         7 | Supplier#000000007        | s,4TicNGB4uO6PaSqNBUq                    |          23 | 33-990-965-2201 |   6820.35 | s unwind silently furiously regular courts. final requests are deposits. requests wake quietly blit
         8 | Supplier#000000008        | 9Sq4bBH2FQEmaFOocY45sRTxo6yuoG           |          17 | 27-498-742-3860 |   7627.85 | al pinto beans. asymptotes haggl
         9 | Supplier#000000009        | 1KhUgZegwM3ua7dsYmekYBsK                 |          10 | 20-403-398-8662 |   5302.37 | s. unusual, even requests along the furiously regular pac
        10 | Supplier#000000010        | Saygah3gYWMp72i PY                       |          24 | 34-852-489-8585 |   3891.91 | ing waters. regular requests ar
        11 | Supplier#000000011        | JfwTs,LZrV, M,9C                         |          18 | 28-613-996-1505 |   3393.08 | y ironic packages. slyly ironic accounts affix furiously; ironically unusual excuses across the flu
        12 | Supplier#000000012        | aLIW  q0HYd                              |           8 | 18-179-925-7181 |   1432.69 | al packages nag alongside of the bold instructions. express, daring accounts
        13 | Supplier#000000013        | HK71HQyWoqRWOX8GI FpgAifW,2PoH           |           3 | 13-727-620-7813 |   9107.22 | requests engage regularly instructions. furiously special requests ar
        14 | Supplier#000000014        | EXsnO5pTNj4iZRm                          |          15 | 25-656-247-5058 |   9189.82 | l accounts boost. fluffily bold warhorses wake
        15 | Supplier#000000015        | olXVbNBfVzRqgokr1T,Ie                    |           8 | 18-453-357-6394 |    308.56 |  across the furiously regular platelets wake even deposits. quickly express she
        16 | Supplier#000000016        | YjP5C55zHDXL7LalK27zfQnwejdpin4AMpvh     |          22 | 32-822-502-4215 |   2972.26 | ously express ideas haggle quickly dugouts? fu
        17 | Supplier#000000017        | c2d,ESHRSkK3WYnxpgw6aOqN0q               |          19 | 29-601-884-9219 |   1687.81 | eep against the furiously bold ideas. fluffily bold packa
        18 | Supplier#000000018        | PGGVE5PWAMwKDZw                          |          16 | 26-729-551-1115 |   7040.82 | accounts snooze slyly furiously bold 
        19 | Supplier#000000019        | edZT3es,nBFD8lBXTGeTl                    |          24 | 34-278-310-2731 |   6150.38 | refully final foxes across the dogged theodolites sleep slyly abou
        20 | Supplier#000000020        | iybAE,RmTymrZVYaFZva2SH,j                |           3 | 13-715-945-6730 |    530.82 | n, ironic ideas would nag blithely about the slyly regular accounts. silent, expr
        21 | Supplier#000000021        | 81CavellcrJ0PQ3CPBID0Z0JwyJm0ka5igEs     |           2 | 12-253-590-5816 |   9365.80 | d. instructions integrate sometimes slyly pending instructions. accounts nag among the 
        22 | Supplier#000000022        | okiiQFk 8lm6EVX6Q0,bEcO                  |           4 | 14-144-830-2814 |   -966.20 |  ironically among the deposits. closely expre
        23 | Supplier#000000023        | ssetugTcXc096qlD7 2TL5crEEeS3zk          |           9 | 19-559-422-5776 |   5926.41 | ges could have to are ironic deposits. regular, even request
        24 | Supplier#000000024        | C4nPvLrVmKPPabFCj                        |           0 | 10-620-939-2254 |   9170.71 | usly pending deposits. slyly final accounts run 
        25 | Supplier#000000025        | RCQKONXMFnrodzz6w7fObFVV6CUm2q           |          22 | 32-431-945-3541 |   9198.31 | ely regular deposits. carefully regular sauternes engage furiously above the regular accounts. idly 
        26 | Supplier#000000026        | iV,MHzAx6Z939uzFNkq09M0a1 MBfH7          |          21 | 31-758-894-4436 |     21.18 |  ideas poach carefully after the blithely bold asymptotes. furiously pending theodoli
        27 | Supplier#000000027        | lC4CjKwNHUr6L4xIpzOBK4NlHkFTg            |          18 | 28-708-999-2028 |   1887.62 | s according to the quickly regular hockey playe
        28 | Supplier#000000028        | GBhvoRh,7YIN V                           |           0 | 10-538-384-8460 |   -891.99 | ld requests across the pinto beans are carefully against the quickly final courts. accounts sleep 
        29 | Supplier#000000029        | 658tEqXLPvRd6xpFdqC2                     |           1 | 11-555-705-5922 |   -811.62 | y express ideas play furiously. even accounts sleep fluffily across the accounts. careful
        30 | Supplier#000000030        | 84NmC1rmQfO0fj3zkobLT                    |          16 | 26-940-594-4852 |   8080.14 | ias. carefully silent accounts cajole blithely. pending, special accounts cajole quickly above the f
        31 | Supplier#000000031        | fRJimA7zchyApqRLHcQeocVpP                |          16 | 26-515-530-4159 |   5916.91 | into beans wake after the special packages. slyly fluffy requests cajole furio
        32 | Supplier#000000032        | yvoD3TtZSx1skQNCK8agk5bZlZLug            |          23 | 33-484-637-7873 |   3556.47 | usly even depths. quickly ironic theodolites s
        33 | Supplier#000000033        | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      |           7 | 17-138-897-9374 |   8564.12 | n sauternes along the regular asymptotes are regularly along the 
        34 | Supplier#000000034        | mYRe3KvA2O4lL4HhxDKkkrPUDPMKRCSp,Xpa     |          10 | 20-519-982-2343 |    237.31 | eposits. slyly final deposits toward the slyly regular dependencies sleep among the excu
        35 | Supplier#000000035        | QymmGXxjVVQ5OuABCXVVsu,4eF gU0Qc6        |          21 | 31-720-790-5245 |   4381.41 |  ironic deposits! final, bold platelets haggle quickly quickly pendin
        36 | Supplier#000000036        | mzSpBBJvbjdx3UKTW3bLFewRD78D91lAC879     |          13 | 23-273-493-3679 |   2371.51 | ular theodolites must haggle regular, bold accounts. slyly final pinto beans bo
        37 | Supplier#000000037        | cqjyB5h1nV                               |           0 | 10-470-144-1330 |   3017.47 | iously final instructions. quickly special accounts hang fluffily above the accounts. deposits
        38 | Supplier#000000038        | xEcx45vD0FXHT7c9mvWFY                    |           4 | 14-361-296-6426 |   2512.41 | ins. fluffily special accounts haggle slyly af
        39 | Supplier#000000039        | ZM, nSYpEPWr1yAFHaC91qjFcijjeU5eH        |           8 | 18-851-856-5633 |   6115.65 | le slyly requests. special packages shall are blithely. slyly unusual packages sleep 
        40 | Supplier#000000040        | zyIeWzbbpkTV37vm1nmSGBxSgd2Kp            |          22 | 32-231-247-6991 |   -290.06 |  final patterns. accounts haggle idly pas
        41 | Supplier#000000041        | G 1FKHR435 wMKFmyt                       |          18 | 28-739-447-2525 |   6942.67 | odolites boost across the furiously regular fo
        42 | Supplier#000000042        | 1Y5lwEgpe3j2vbUBYj3SwLhK62JlwEMtDC       |          22 | 32-698-298-6317 |   6565.11 |  fluffily even requests cajole blithely fu
        43 | Supplier#000000043        | Z5mLuAoTUEeKY5v22VnnA4D87Ao6jF2LvMYnlX8h |          12 | 22-421-568-4862 |   7773.41 | unts. unusual, final asymptotes 
        44 | Supplier#000000044        | kERxlLDnlIZJdN66zAPHklyL                 |           7 | 17-713-930-5667 |   9759.38 | x. carefully quiet account
        45 | Supplier#000000045        | LcKnsa8XGtIO0WYSB7hkOrH rnzRg1           |           9 | 19-189-635-8862 |   2944.23 | iously according to the ironic, silent accounts.
        46 | Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap    |          24 | 34-748-308-3215 |   3580.35 | gular, regular ideas across th
        47 | Supplier#000000047        | 3XM1x,Pcxqw,HK4XNlgbnZMbLhBHLA           |          14 | 24-810-354-4471 |   2958.09 | sly ironic deposits sleep carefully along t
        48 | Supplier#000000048        | jg0U FNPMQDuyuKvTnLXXaLf3Wl6OtONA6mQlWJ  |          14 | 24-722-551-9498 |   5630.62 | xpress instructions affix. fluffily even requests boos
        49 | Supplier#000000049        | Nvq 6macF4GtJvz                          |          24 | 34-211-567-6800 |   9915.24 | the finally bold dependencies. dependencies after the fluffily final foxes boost fluffi
        50 | Supplier#000000050        | rGobqSMMYz0ErrPhCGS                      |           9 | 19-561-560-7437 |   4515.87 | warhorses. ironic, regular accounts detect slyly after the quickly f
        51 | Supplier#000000051        | rDkBXb01POIKjOwrij62uM8O4                |           9 | 19-475-537-1368 |   7241.40 | ges nag at the blithely busy instructions. fluffy packages wake quickly. even, ironic ideas boost b
        52 | Supplier#000000052        | WCk XCHYzBA1dvJDSol4ZJQQcQN,             |          19 | 29-974-934-4713 |    287.16 | dolites are slyly against the furiously regular packages. ironic, final deposits cajole quickly
        53 | Supplier#000000053        | i9v3 EsYCfLKFU6PIt8iihBOHBB37yR7b3GD7Rt  |           7 | 17-886-101-6083 |   6177.35 | onic, special deposits wake furio
        54 | Supplier#000000054        | J1s,Wxb5pg                               |          12 | 22-966-435-7200 |   2733.69 | blithely pending dolphins. quickly regular theodolites haggle slyly
        55 | Supplier#000000055        | OqdYSiOQeG4eGi636Tj                      |          24 | 34-876-912-6007 |   7162.15 | kages. blithely even foxes cajole special, final accounts. blithely even dependencies r
        56 | Supplier#000000056        | fUVtlUVal GiHBOuYoUQ XQ9NfNLQR3Gl        |          16 | 26-471-195-5486 |   -632.16 |  sleep special deposits. unusual requests wake blithely slyly regular ideas. 
        57 | Supplier#000000057        | bEWqUVRR f0mb2o18Y                       |          17 | 27-681-514-6892 |   -831.07 | detect according to the furiously br
        58 | Supplier#000000058        | 01dEADIZoCULZXg                          |          16 | 26-659-969-5586 |     92.44 | refully final foxes are. even, express courts according to the b
        59 | Supplier#000000059        | N8lKbYjMnVlEHmTPRmBgtLiX8rrJx            |          17 | 27-249-395-9123 |    586.16 | ffily along the even decoys. final instructions abov
        60 | Supplier#000000060        | cb08ntDTARo47WmnBcYXu                    |           8 | 18-550-360-2464 |   4515.80 | thely express ideas use blithely 
        61 | Supplier#000000061        | Oz0M1qBR9I                               |           8 | 18-396-489-9719 |   6096.58 | s the slyly regular ideas shall 
        62 | Supplier#000000062        | bSmlFYUKBeRsqJxwC9 zS6xpFdEf5jNTb        |          19 | 29-603-653-2494 |   9202.57 | ts. furiously ironic pinto beans are permanently after the bold ideas. regular, express f
        63 | Supplier#000000063        | NlV0OQyIoPvPkw5AYuWGomX,hgqm1            |           5 | 15-781-401-3047 |   5742.03 | ar deposits. blithely bold accounts against the slyly final pinto beans sleep about the exp
        64 | Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU |          24 | 34-278-790-7004 |   1309.70 | uickly regular requests use. carefully i
        65 | Supplier#000000065        | BsAnHUmSFArppKrM                         |          22 | 32-444-835-2434 |   -963.79 | l ideas wake carefully around the regular packages. furiously ruthless pinto bea
        66 | Supplier#000000066        | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 |          23 | 33-300-836-9529 |   2455.98 | ar requests. express orbits de
        67 | Supplier#000000067        | 7YrEKJncHFk5D W7ZaqfAXV                  |           4 | 14-563-538-1657 |   3576.55 | ray slyly final foxes. furio
        68 | Supplier#000000068        | Ue6N50wH2CwE4PPgTGLmat,ibGYYlDoOb3xQwtgb |          21 | 31-267-327-4328 |   5119.38 | inal requests. ruthlessly ironic packages cajole
        69 | Supplier#000000069        | T2Dl9,f97e333eRuMi2z                     |           4 | 14-491-707-8310 |   8466.50 | ! carefully ironic instructions nag quickly pending requests. fluffily even deposits sleep a
        70 | Supplier#000000070        | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        |           6 | 16-821-608-1166 |   9508.37 | ests sleep quickly express ideas. ironic ideas haggle about the final T
        71 | Supplier#000000071        | YFo8an7P6wi Q                            |           1 | 11-743-919-7272 |   8179.68 |  final accounts. bold, final escapades must have to cajole about the special platelets. fu
        72 | Supplier#000000072        | mKpAJojtawk2alqV4 ZEbJ3PH3wfYqy AM8rGq1  |          18 | 28-113-898-6643 |   7014.50 |  theodolites sublate furiously about the regularly e
        73 | Supplier#000000073        | HBZA1NHvrswQCxTTjg 5XrfSOGgMRKNCe2ovE    |          16 | 26-758-310-7496 |   3793.13 | . never pending asymptotes a
        74 | Supplier#000000074        | uM3yV5NOc6b5wNdpxF69CW 8QvDxqvKubRJtA    |          20 | 30-166-486-1559 |   4170.51 | carefully along the quickly regular sentiments. ironic accounts sleep. regular deposits are blith
        75 | Supplier#000000075        | 7f3gN4rP1livII                           |          18 | 28-716-704-8686 |   -224.84 | eans. even, silent packages c
        76 | Supplier#000000076        | JBhSBa3cLYvNgHUYtUHmtECCD                |          14 | 24-228-763-7840 |   2971.10 | , even instructions. furiously unusual deposits wake slyly about the ev
        77 | Supplier#000000077        | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  |           7 | 17-281-345-4863 |   4186.95 | the slyly final asymptotes. blithely pending theodoli
        78 | Supplier#000000078        | 9y3OZ2CV hGrsrQxzB7V3zTtygHVHlG3SD6yrz   |           5 | 15-670-998-6860 |   1044.10 | , regular packages wake quickly bold requests. carefully unusual requests about the unusual request
        79 | Supplier#000000079        | p0u3tztSXUD2J8vFfLNFNKsrRRv7qyUtTBTA     |          14 | 24-402-227-9600 |   1191.94 | nto beans integrate slyly across the fluffily pending multipliers. carefully ste
        80 | Supplier#000000080        | cJ2MHSEJ13rIL2Wj3D5i6hRo30,ZiNUXhqn      |          21 | 31-646-289-1906 |    -40.45 | ackages. blithely bold requests wake quickly. carefully regular foxes are slyly instructions. caref
        81 | Supplier#000000081        | SLlacbhgpKmVa,gF3saYv12e0                |          12 | 22-535-310-6971 |    166.32 | oost carefully quickly regular packages. carefully final excuses sleep blithely slyly pendi
        82 | Supplier#000000082        | WyTKA7ZpF15t1aCNlT3                      |          18 | 28-177-572-9691 |   -724.31 | xpress multipliers wake furiously even foxes. furiously iro
        83 | Supplier#000000083        | WRJUkzCn050seVz57oAfrbCuw                |          14 | 24-529-559-2461 |   1467.77 | ly pending courts would cajole enticingly even deposits. slyly express
        84 | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx              |          24 | 34-869-118-7803 |   4780.93 | even depths. regular foxes use slyly. theod
        85 | Supplier#000000085        | Ckls9RtlzKSF                             |           7 | 17-167-806-8199 |   7174.74 | egular packages. bold pinto beans wake fur
        86 | Supplier#000000086        | J1fgg5QaqnN                              |          19 | 29-903-665-7065 |   1883.37 | cajole furiously special, final requests: furiously spec
        87 | Supplier#000000087        | WCw7URDj8zoZ7tqC3cpm7                    |          24 | 34-860-229-1674 |   4746.66 | all are quickly after the ironic platelets. pending dolphins are. final the
        88 | Supplier#000000088        | yOshY8wwzMgS                             |          11 | 21-191-938-9469 |   3086.13 | furiously special excuses aff
        89 | Supplier#000000089        | fhtzZcSorhud1                            |           9 | 19-259-876-1014 |   1638.02 | en instructions across the slyly ironic requests engage
        90 | Supplier#000000090        | bPE6Uhz1f2m3gwSGMrnRt,g,3gq37r5kxgphqss1 |           6 | 16-380-123-9217 |   6201.77 | hely fluffily regular theodoli
        91 | Supplier#000000091        | YV45D7TkfdQanOOZ7q9QxkyGUapU1oOWU6q3     |           3 | 13-604-986-9056 |   6255.87 | nstructions use carefully according to the special packages: quickly silent th
        92 | Supplier#000000092        | n48Wy4QI3lml8T217rk                      |           2 | 12-701-432-8346 |   2470.84 |  even theodolites wake against the blithely fluffy packages
        93 | Supplier#000000093        | wd1djjKXT,4zBm                           |          16 | 26-528-528-1157 |    368.76 | yly final accounts could are carefully. fluffily ironic instruct
        94 | Supplier#000000094        | lK,pLPjAMVGJOXN80zPZuNQjpChliE           |           4 | 14-728-888-8882 |   2766.80 | usly. furiously slow theodolites could haggle carefully fina
        95 | Supplier#000000095        | p2 2hBfH5TD                              |          19 | 29-142-539-1403 |   2588.83 | sual instructions cajole slyly with the final ac
        96 | Supplier#000000096        | Lbxp3WIipye o2wZme1i9iJx,xTt1Mp          |          12 | 22-888-654-7193 |   3437.24 | efully unusual excuses wake fluffily regular theodo
        97 | Supplier#000000097        | MrCQha2G6ndX1fp6CA                       |           4 | 14-618-678-1789 |   6642.22 | s, regular accounts. furiously bold ideas u
        98 | Supplier#000000098        | ogHn8dpXB5Q                              |          21 | 31-914-775-1978 |   5873.07 | esias use slyly under the ironic foxes. re
        99 | Supplier#000000099        | 4SxkTHG28nZrtT0,MnVF9H                   |          18 | 28-272-909-1617 |   3671.34 | nic dependencies dazzle flu
       100 | Supplier#000000100        | rIlN li8zvW22l2slbcx ECP4fL              |          21 | 31-351-324-5062 |   3191.70 | es. regular instructions sleep carefully. slyly ironic packages across the foxes boost 
(100 rows)

SELECT count(*) FROM EXT_PARTSUPP;
 count 
-------
  8000
(1 row)

SELECT count(*) FROM EXT_CUSTOMER;
 count 
-------
  1500
(1 row)

SELECT count(*) FROM EXT_ORDERS;
 count 
-------
 15000
(1 row)

SELECT count(*) FROM EXT_LINEITEM;
 count 
-------
 60175
(1 row)

SELECT 
l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue,o_orderdate, o_shippriority
FROM
ext_customer, ext_orders, ext_lineitem 
WHERE 
c_mktsegment = 'BUILDING' and 
c_custkey = o_custkey and 
l_orderkey = o_orderkey and 
o_orderdate < date '15-mar-1995' and l_shipdate > date '15-mar-1995' 
GROUP BY l_orderkey, o_orderdate, o_shippriority
ORDER BY revenue desc, o_orderdate limit 10;
 l_orderkey |   revenue   | o_orderdate | o_shippriority 
------------+-------------+-------------+----------------
      47714 | 267010.5894 | 1995-03-11  |              0
      22276 | 266351.5562 | 1995-01-29  |              0
      32965 | 263768.3414 | 1995-02-25  |              0
      21956 | 254541.1285 | 1995-02-02  |              0
       1637 | 243512.7981 | 1995-02-08  |              0
      10916 | 241320.0814 | 1995-03-11  |              0
      30497 | 208566.6969 | 1995-02-07  |              0
        450 | 205447.4232 | 1995-03-05  |              0
      47204 | 204478.5213 | 1995-03-13  |              0
       9696 | 201502.2188 | 1995-02-20  |              0
(10 rows)

select n_name, 
sum(l_extendedprice * (1 - l_discount)) as revenue 
from 
ext_customer,   ext_orders,  ext_lineitem,  ext_supplier,  ext_nation,  ext_region 
where 
c_custkey = o_custkey and l_orderkey = o_orderkey and 
l_suppkey = s_suppkey and c_nationkey = s_nationkey and 
s_nationkey = n_nationkey and n_regionkey = r_regionkey and 
r_name = 'ASIA' and o_orderdate >= date '1-jan-1994' and 
o_orderdate < date '1-jan-1994' + interval '1 year' 
group by n_name order by revenue desc;
          n_name           |   revenue    
---------------------------+--------------
 VIETNAM                   | 1000926.6999
 CHINA                     |  740210.7570
 JAPAN                     |  660651.2425
 INDONESIA                 |  566379.5276
 INDIA                     |  422874.6844
(5 rows)

select supp_nation,cust_nation,l_year, 
sum(volume) as revenue 
from ( 
    select n1.n_name as supp_nation,n2.n_name as cust_nation, 
    extract(year from l_shipdate) as l_year, 
    l_extendedprice * (1 - l_discount) as volume 
    from 
    ext_supplier,  ext_lineitem, ext_orders, ext_customer, ext_nation n1, ext_nation n2 
    where 
    s_suppkey = l_suppkey and o_orderkey = l_orderkey and 
    c_custkey = o_custkey and s_nationkey = n1.n_nationkey and 
    c_nationkey = n2.n_nationkey and 
    ( (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY') or 
    (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE')) and 
    l_shipdate between date '1995-01-01' and 
    date '1996-12-31') as shipping 
    group by supp_nation,cust_nation,l_year 
    order by supp_nation,cust_nation,l_year;
        supp_nation        |        cust_nation        | l_year |   revenue   
---------------------------+---------------------------+--------+-------------
 FRANCE                    | GERMANY                   |   1995 | 268068.5774
 FRANCE                    | GERMANY                   |   1996 | 303862.2980
 GERMANY                   | FRANCE                    |   1995 | 621159.4882
 GERMANY                   | FRANCE                    |   1996 | 379095.8854
(4 rows)

select nation,o_year,sum(amount) as sum_profit 
from (
    select n_name as nation, extract(year from o_orderdate) as o_year, 
    l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
    from 
    ext_part,  ext_supplier, ext_lineitem, ext_partsupp, ext_orders, ext_nation
    where 
    s_suppkey = l_suppkey and ps_suppkey = l_suppkey and 
    ps_partkey = l_partkey and p_partkey = l_partkey and 
    o_orderkey = l_orderkey and s_nationkey = n_nationkey and 
    p_name like '%green%') as profit 
    group by nation,o_year 
    order by nation,o_year desc;
          nation           | o_year |  sum_profit  
---------------------------+--------+--------------
 ALGERIA                   |   1998 |  386617.8283
 ALGERIA                   |   1997 |  401601.1258
 ALGERIA                   |   1996 |  156938.7971
 ALGERIA                   |   1995 |  486706.0631
 ALGERIA                   |   1994 |  426573.4415
 ALGERIA                   |   1993 |  448371.4336
 ALGERIA                   |   1992 |  285188.4503
 ARGENTINA                 |   1998 |  136458.3471
 ARGENTINA                 |   1997 |  423877.6754
 ARGENTINA                 |   1996 |  325019.6263
 ARGENTINA                 |   1995 |  399583.4009
 ARGENTINA                 |   1994 |  374046.7888
 ARGENTINA                 |   1993 |  351669.5325
 ARGENTINA                 |   1992 |  312412.4307
 BRAZIL                    |   1998 |  265032.7654
 BRAZIL                    |   1997 |  275700.7887
 BRAZIL                    |   1996 |  490362.6267
 BRAZIL                    |   1995 |  349754.1082
 BRAZIL                    |   1994 |  348798.4066
 BRAZIL                    |   1993 |  457273.7693
 BRAZIL                    |   1992 |  280563.4508
 CANADA                    |   1998 |  249632.9034
 CANADA                    |   1997 |  486581.6822
 CANADA                    |   1996 |  359393.5226
 CANADA                    |   1995 |  243051.8308
 CANADA                    |   1994 |  188897.4377
 CANADA                    |   1993 |  546007.0343
 CANADA                    |   1992 |  275013.2650
 CHINA                     |   1998 |  391223.3132
 CHINA                     |   1997 |  585354.2015
 CHINA                     |   1996 |  555841.0120
 CHINA                     |   1995 |  864856.4126
 CHINA                     |   1994 |  669658.4851
 CHINA                     |   1993 |  621317.0197
 CHINA                     |   1992 |  932500.7559
 EGYPT                     |   1998 |  367340.0376
 EGYPT                     |   1997 |  958524.1565
 EGYPT                     |   1996 |  417700.6911
 EGYPT                     |   1995 |  852185.4611
 EGYPT                     |   1994 |  442097.3675
 EGYPT                     |   1993 |  677948.0185
 EGYPT                     |   1992 |  666425.4212
 ETHIOPIA                  |   1998 |  146634.8925
 ETHIOPIA                  |   1997 |  264122.6167
 ETHIOPIA                  |   1996 |  193275.0975
 ETHIOPIA                  |   1995 |  220253.5131
 ETHIOPIA                  |   1994 |  296634.2600
 ETHIOPIA                  |   1993 |  304224.8129
 ETHIOPIA                  |   1992 |  297588.3116
 FRANCE                    |   1998 |   72506.5000
 FRANCE                    |   1997 |  237462.1240
 FRANCE                    |   1996 |  151017.7675
 FRANCE                    |   1995 |  296667.9453
 FRANCE                    |   1994 |  233805.7419
 FRANCE                    |   1993 |  168968.1550
 FRANCE                    |   1992 |  127349.1738
 GERMANY                   |   1998 |  223811.2759
 GERMANY                   |   1997 |  661263.7764
 GERMANY                   |   1996 |  482126.6721
 GERMANY                   |   1995 |  571466.4843
 GERMANY                   |   1994 |  322330.4404
 GERMANY                   |   1993 |  428314.7853
 GERMANY                   |   1992 |  273675.9499
 INDIA                     |   1998 |  418144.1956
 INDIA                     |   1997 |  859947.3428
 INDIA                     |   1996 |  515838.8397
 INDIA                     |   1995 |  631351.5802
 INDIA                     |   1994 |  798279.5615
 INDIA                     |   1993 |  767946.7017
 INDIA                     |   1992 |  797101.9729
 INDONESIA                 |   1998 |  386787.9168
 INDONESIA                 |   1997 |  311837.4839
 INDONESIA                 |   1996 |  421631.7918
 INDONESIA                 |   1995 |  479331.3577
 INDONESIA                 |   1994 |  602376.9040
 INDONESIA                 |   1993 |  496450.6942
 INDONESIA                 |   1992 |  561262.1781
 IRAN                      |   1998 |    8996.5540
 IRAN                      |   1997 |  201653.8389
 IRAN                      |   1996 |  281658.4382
 IRAN                      |   1995 |   50873.1323
 IRAN                      |   1994 |   53387.1992
 IRAN                      |   1993 |  107749.9627
 IRAN                      |   1992 |   67888.7176
 IRAQ                      |   1998 |  113434.1032
 IRAQ                      |   1997 |   86656.8062
 IRAQ                      |   1996 |  359937.8761
 IRAQ                      |   1995 |  218221.7756
 IRAQ                      |   1994 |  360489.8843
 IRAQ                      |   1993 |  559990.6546
 IRAQ                      |   1992 |  211655.9396
 JAPAN                     |   1998 |  278531.8011
 JAPAN                     |   1997 |  426945.7933
 JAPAN                     |   1996 |  501942.5698
 JAPAN                     |   1995 |  474025.8492
 JAPAN                     |   1994 |  706404.4339
 JAPAN                     |   1993 |  695412.9084
 JAPAN                     |   1992 |  613125.5417
 JORDAN                    |   1998 |   73080.7362
 JORDAN                    |   1997 |  117104.2978
 JORDAN                    |   1996 |   94740.7164
 JORDAN                    |   1995 |  164684.4569
 JORDAN                    |   1994 |   51403.2065
 JORDAN                    |   1993 |   38718.7839
 JORDAN                    |   1992 |  132028.5385
 KENYA                     |   1998 |  351661.8184
 KENYA                     |   1997 |  542347.9571
 KENYA                     |   1996 |  466964.0397
 KENYA                     |   1995 |  795396.7551
 KENYA                     |   1994 |  740881.7388
 KENYA                     |   1993 |  603341.1861
 KENYA                     |   1992 |  774761.2393
 MOROCCO                   |   1998 |  118171.3902
 MOROCCO                   |   1997 |   96442.7008
 MOROCCO                   |   1996 |  118984.8785
 MOROCCO                   |   1995 |  158240.6598
 MOROCCO                   |   1994 |  148951.6794
 MOROCCO                   |   1993 |   48279.6548
 MOROCCO                   |   1992 |  146068.2550
 MOZAMBIQUE                |   1998 |  343227.8816
 MOZAMBIQUE                |   1997 |  831834.1044
 MOZAMBIQUE                |   1996 |  888199.0121
 MOZAMBIQUE                |   1995 | 1249272.9387
 MOZAMBIQUE                |   1994 |  594096.0637
 MOZAMBIQUE                |   1993 | 1200185.0713
 MOZAMBIQUE                |   1992 |  994120.0362
 PERU                      |   1998 |  352324.2789
 PERU                      |   1997 |  319502.2255
 PERU                      |   1996 |  391644.9686
 PERU                      |   1995 |  360028.0705
 PERU                      |   1994 |  460058.1291
 PERU                      |   1993 |  382460.0831
 PERU                      |   1992 |  312613.1714
 ROMANIA                   |   1998 |  340984.6297
 ROMANIA                   |   1997 |  444095.1884
 ROMANIA                   |   1996 |  426472.5967
 ROMANIA                   |   1995 |  616350.9394
 ROMANIA                   |   1994 |  430563.1943
 ROMANIA                   |   1993 |  769406.9533
 ROMANIA                   |   1992 |  543722.1295
 RUSSIA                    |   1998 |  217747.8262
 RUSSIA                    |   1997 |  644719.5017
 RUSSIA                    |   1996 |  501019.7684
 RUSSIA                    |   1995 |  717528.7447
 RUSSIA                    |   1994 |  441262.6350
 RUSSIA                    |   1993 |  529422.5932
 RUSSIA                    |   1992 |  469683.7369
 SAUDI ARABIA              |   1998 |   57980.2356
 SAUDI ARABIA              |   1997 |   17173.1210
 SAUDI ARABIA              |   1996 |   14229.6253
 SAUDI ARABIA              |   1995 |   98053.2309
 SAUDI ARABIA              |   1993 |   42289.6310
 SAUDI ARABIA              |   1992 |   50978.9572
 UNITED KINGDOM            |   1998 |  127808.1215
 UNITED KINGDOM            |   1997 |  407935.6606
 UNITED KINGDOM            |   1996 |  499957.5199
 UNITED KINGDOM            |   1995 |  480575.5026
 UNITED KINGDOM            |   1994 |  513252.8116
 UNITED KINGDOM            |   1993 |  697570.9412
 UNITED KINGDOM            |   1992 |  361516.4116
 UNITED STATES             |   1998 |  503864.6963
 UNITED STATES             |   1997 |  649175.2847
 UNITED STATES             |   1996 |  831723.1557
 UNITED STATES             |   1995 |  902131.2862
 UNITED STATES             |   1994 |  460768.5468
 UNITED STATES             |   1993 |  656092.8661
 UNITED STATES             |   1992 |  714228.6231
 VIETNAM                   |   1998 |  578857.0410
 VIETNAM                   |   1997 |  596114.8585
 VIETNAM                   |   1996 |  832979.0530
 VIETNAM                   |   1995 |  757862.0438
 VIETNAM                   |   1994 | 1003275.5371
 VIETNAM                   |   1993 |  461389.0037
 VIETNAM                   |   1992 |  820665.7064
(174 rows)

DROP EXTERNAL TABLE EXT_NATION;
DROP EXTERNAL TABLE
DROP EXTERNAL TABLE EXT_REGION;
DROP EXTERNAL TABLE
DROP EXTERNAL TABLE EXT_PART;
DROP EXTERNAL TABLE
DROP EXTERNAL TABLE EXT_SUPPLIER;
DROP EXTERNAL TABLE
DROP EXTERNAL TABLE EXT_PARTSUPP;
DROP EXTERNAL TABLE
DROP EXTERNAL TABLE EXT_CUSTOMER;
DROP EXTERNAL TABLE
DROP EXTERNAL TABLE EXT_ORDERS;
DROP EXTERNAL TABLE
DROP EXTERNAL TABLE EXT_LINEITEM;
DROP EXTERNAL TABLE
