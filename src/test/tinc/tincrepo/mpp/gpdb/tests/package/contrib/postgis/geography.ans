-- start_ignore
-- ST_Area
-- ST_AsBinary
-- ST_AsEWKT
-- ST_AsGML
-- ST_AsGeoJSON
-- ST_AsKML
-- ST_AsSVG
-- ST_AsText
-- ST_Azimuth
-- ST_Buffer
-- ST_CoveredBy
-- ST_Covers
-- ST_DWithin
-- ST_Distance
-- ST_GeogFromText
-- ST_GeogFromWKB
-- ST_GeographyFromText
-- =
-- ST_Intersection
-- ST_Intersects
-- ST_Length
-- ST_Perimeter
-- ST_Project
-- ST_Summary
-- &&
DROP TABLE IF EXISTS geography_test;
psql:/path/sql_file:1: NOTICE:  table "geography_test" does not exist, skipping
DROP TABLE
-- end_ignore
CREATE TABLE geography_test (id INT4, name text, geog GEOGRAPHY);
psql:/path/sql_file:1: NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'id' as the Greenplum Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
CREATE TABLE
INSERT INTO geography_test(id, name, geog) VALUES (1, 'A1', 'POINT(10 10)');
INSERT 0 1
INSERT INTO geography_test(id, name, geog) VALUES (11, 'A2', 'POINT(10 30)');
INSERT 0 1
INSERT INTO geography_test(id, name, geog) VALUES (2, 'B', 'POLYGON((1 1, 2 2, 2 4, 4 2, 1 1))');
INSERT 0 1
INSERT INTO geography_test(id, name, geog) VALUES (3, 'C', 'MULTIPOLYGON(((0 0,4 0,4 4,0 4,0 0),(1 1,2 1,2 2,1 2,1 1)), ((-1 -1,-1 -2,-2 -2,-2 -1,-1 -1)))');
INSERT 0 1
INSERT INTO geography_test(id, name, geog) VALUES (4, 'D', 'MULTILINESTRING((0 0,1 1,1 2),(2 3,3 2,5 4))');
INSERT 0 1
INSERT INTO geography_test(id, name, geog) VALUES (5, 'A1', 'LINESTRINg(1 1, 2 2, 2 3, 3 3)');
INSERT 0 1
SELECT GeometryType(geog) FROM geography_test ORDER BY id;
  geometrytype   
-----------------
 POINT
 POLYGON
 MULTIPOLYGON
 MULTILINESTRING
 LINESTRING
 POINT
(6 rows)

SELECT id, name, ST_AsGML(geog) FROM geography_test;
 id | name |                                                                                                                                                                                                                                                                                                   st_asgml                                                                                                                                                                                                                                                                                                    
----+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  2 | B    | <gml:Polygon srsName="EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>1,1 2,2 2,4 4,2 1,1</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon>
  4 | D    | <gml:MultiLineString srsName="EPSG:4326"><gml:lineStringMember><gml:LineString><gml:coordinates>0,0 1,1 1,2</gml:coordinates></gml:LineString></gml:lineStringMember><gml:lineStringMember><gml:LineString><gml:coordinates>2,3 3,2 5,4</gml:coordinates></gml:LineString></gml:lineStringMember></gml:MultiLineString>
  1 | A1   | <gml:Point srsName="EPSG:4326"><gml:coordinates>10,10</gml:coordinates></gml:Point>
 11 | A2   | <gml:Point srsName="EPSG:4326"><gml:coordinates>10,30</gml:coordinates></gml:Point>
  3 | C    | <gml:MultiPolygon srsName="EPSG:4326"><gml:polygonMember><gml:Polygon><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>0,0 4,0 4,4 0,4 0,0</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs><gml:innerBoundaryIs><gml:LinearRing><gml:coordinates>1,1 2,1 2,2 1,2 1,1</gml:coordinates></gml:LinearRing></gml:innerBoundaryIs></gml:Polygon></gml:polygonMember><gml:polygonMember><gml:Polygon><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>-1,-1 -1,-2 -2,-2 -2,-1 -1,-1</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon></gml:polygonMember></gml:MultiPolygon>
  5 | A1   | <gml:LineString srsName="EPSG:4326"><gml:coordinates>1,1 2,2 2,3 3,3</gml:coordinates></gml:LineString>
(6 rows)

SELECT id, name, ST_AsText(geog), ST_AsBinary(geog), ST_AsEWKT(geog), ST_AsGeoJSON(geog), ST_AsKML(geog), ST_AsSVG(geog)  FROM geography_test ORDER BY id;
 id | name |                                           st_astext                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    st_asbinary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                st_asewkt                                                |                                                                     st_asgeojson                                                                      |                                                                                                                                                                                                   st_askml                                                                                                                                                                                                    |                                  st_assvg                                   
----+------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------
  1 | A1   | POINT(10 10)                                                                                  | \001\001\000\000\000\000\000\000\000\000\000$@\000\000\000\000\000\000$@                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | SRID=4326;POINT(10 10)                                                                                  | {"type":"Point","coordinates":[10,10]}                                                                                                                | <Point><coordinates>10,10</coordinates></Point>                                                                                                                                                                                                                                                                                                                                                               | cx="10" cy="-10"
  2 | B    | POLYGON((1 1,2 2,2 4,4 2,1 1))                                                                | \001\003\000\000\000\001\000\000\000\005\000\000\000\000\000\000\000\000\000\360?\000\000\000\000\000\000\360?\000\000\000\000\000\000\000@\000\000\000\000\000\000\000@\000\000\000\000\000\000\000@\000\000\000\000\000\000\020@\000\000\000\000\000\000\020@\000\000\000\000\000\000\000@\000\000\000\000\000\000\360?\000\000\000\000\000\000\360?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | SRID=4326;POLYGON((1 1,2 2,2 4,4 2,1 1))                                                                | {"type":"Polygon","coordinates":[[[1,1],[2,2],[2,4],[4,2],[1,1]]]}                                                                                    | <Polygon><outerBoundaryIs><LinearRing><coordinates>1,1 2,2 2,4 4,2 1,1</coordinates></LinearRing></outerBoundaryIs></Polygon>                                                                                                                                                                                                                                                                                 | M 1 -1 L 2 -2 2 -4 4 -2 Z
  3 | C    | MULTIPOLYGON(((0 0,4 0,4 4,0 4,0 0),(1 1,2 1,2 2,1 2,1 1)),((-1 -1,-1 -2,-2 -2,-2 -1,-1 -1))) | \001\006\000\000\000\002\000\000\000\001\003\000\000\000\002\000\000\000\005\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\020@\000\000\000\000\000\000\000\000\000\000\000\000\000\000\020@\000\000\000\000\000\000\020@\000\000\000\000\000\000\000\000\000\000\000\000\000\000\020@\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\005\000\000\000\000\000\000\000\000\000\360?\000\000\000\000\000\000\360?\000\000\000\000\000\000\000@\000\000\000\000\000\000\360?\000\000\000\000\000\000\000@\000\000\000\000\000\000\000@\000\000\000\000\000\000\360?\000\000\000\000\000\000\000@\000\000\000\000\000\000\360?\000\000\000\000\000\000\360?\001\003\000\000\000\001\000\000\000\005\000\000\000\000\000\000\000\000\000\360\277\000\000\000\000\000\000\360\277\000\000\000\000\000\000\360\277\000\000\000\000\000\000\000\300\000\000\000\000\000\000\000\300\000\000\000\000\000\000\000\300\000\000\000\000\000\000\000\300\000\000\000\000\000\000\360\277\000\000\000\000\000\000\360\277\000\000\000\000\000\000\360\277 | SRID=4326;MULTIPOLYGON(((0 0,4 0,4 4,0 4,0 0),(1 1,2 1,2 2,1 2,1 1)),((-1 -1,-1 -2,-2 -2,-2 -1,-1 -1))) | {"type":"MultiPolygon","coordinates":[[[[0,0],[4,0],[4,4],[0,4],[0,0]],[[1,1],[2,1],[2,2],[1,2],[1,1]]],[[[-1,-1],[-1,-2],[-2,-2],[-2,-1],[-1,-1]]]]} | <MultiGeometry><Polygon><outerBoundaryIs><LinearRing><coordinates>0,0 4,0 4,4 0,4 0,0</coordinates></LinearRing></outerBoundaryIs><innerBoundaryIs><LinearRing><coordinates>1,1 2,1 2,2 1,2 1,1</coordinates></LinearRing></innerBoundaryIs></Polygon><Polygon><outerBoundaryIs><LinearRing><coordinates>-1,-1 -1,-2 -2,-2 -2,-1 -1,-1</coordinates></LinearRing></outerBoundaryIs></Polygon></MultiGeometry> | M 0 0 L 4 0 4 -4 0 -4 Z M 1 -1 L 2 -1 2 -2 1 -2 Z M -1 1 L -1 2 -2 2 -2 1 Z
  4 | D    | MULTILINESTRING((0 0,1 1,1 2),(2 3,3 2,5 4))                                                  | \001\005\000\000\000\002\000\000\000\001\002\000\000\000\003\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\360?\000\000\000\000\000\000\360?\000\000\000\000\000\000\360?\000\000\000\000\000\000\000@\001\002\000\000\000\003\000\000\000\000\000\000\000\000\000\000@\000\000\000\000\000\000\010@\000\000\000\000\000\000\010@\000\000\000\000\000\000\000@\000\000\000\000\000\000\024@\000\000\000\000\000\000\020@                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | SRID=4326;MULTILINESTRING((0 0,1 1,1 2),(2 3,3 2,5 4))                                                  | {"type":"MultiLineString","coordinates":[[[0,0],[1,1],[1,2]],[[2,3],[3,2],[5,4]]]}                                                                    | <MultiGeometry><LineString><coordinates>0,0 1,1 1,2</coordinates></LineString><LineString><coordinates>2,3 3,2 5,4</coordinates></LineString></MultiGeometry>                                                                                                                                                                                                                                                 | M 0 0 L 1 -1 1 -2 M 2 -3 L 3 -2 5 -4
  5 | A1   | LINESTRING(1 1,2 2,2 3,3 3)                                                                   | \001\002\000\000\000\004\000\000\000\000\000\000\000\000\000\360?\000\000\000\000\000\000\360?\000\000\000\000\000\000\000@\000\000\000\000\000\000\000@\000\000\000\000\000\000\000@\000\000\000\000\000\000\010@\000\000\000\000\000\000\010@\000\000\000\000\000\000\010@                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | SRID=4326;LINESTRING(1 1,2 2,2 3,3 3)                                                                   | {"type":"LineString","coordinates":[[1,1],[2,2],[2,3],[3,3]]}                                                                                         | <LineString><coordinates>1,1 2,2 2,3 3,3</coordinates></LineString>                                                                                                                                                                                                                                                                                                                                           | M 1 -1 L 2 -2 2 -3 3 -3
 11 | A2   | POINT(10 30)                                                                                  | \001\001\000\000\000\000\000\000\000\000\000$@\000\000\000\000\000\000>@                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | SRID=4326;POINT(10 30)                                                                                  | {"type":"Point","coordinates":[10,30]}                                                                                                                | <Point><coordinates>10,30</coordinates></Point>                                                                                                                                                                                                                                                                                                                                                               | cx="10" cy="-30"
(6 rows)

SELECT ST_Azimuth(ST_GeogFromText('POINT(10 10)'), ST_GeogFromText('POINT(10 30)')) FROM geography_test ORDER BY id;
 st_azimuth 
------------
          0
          0
          0
          0
          0
          0
(6 rows)

SELECT ST_Azimuth(ST_GeogFromText('POINT(10 10)'), ST_GeogFromText('POINT(30 10)')) FROM geography_test ORDER BY id;
    st_azimuth    
------------------
 1.54018503506234
 1.54018503506234
 1.54018503506234
 1.54018503506234
 1.54018503506234
 1.54018503506234
(6 rows)

SELECT ST_AsText(ST_SnapToGrid(ST_Buffer(ST_GeogFromText(ST_AsText(geog)), 1)::geometry, 0.00001)) FROM geography_test ORDER BY id;
                                                                                                                                                                                                                  st_astext                                                                                                                                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 POLYGON((10.00001 10,10.00001 9.99999,10 9.99999,9.99999 9.99999,9.99999 10,9.99999 10.00001,10 10.00001,10.00001 10.00001,10.00001 10))
 POLYGON((1 0.99999,0.99999 0.99999,0.99999 1,0.99999 1.00001,1.99999 2,1.99999 4,1.99999 4.00001,2 4.00001,2.00001 4.00001,4.00001 2.00001,4.00001 2,4.00001 1.99999,4 1.99999,1 0.99999))
 MULTIPOLYGON(((-1e-05 0,-1e-05 4,-1e-05 4.00001,0 4.00001,4 4.00001,4.00001 4.00001,4.00001 4,4.00001 0,4.00001 -1e-05,4 -1e-05,0 -1e-05,-1e-05 -1e-05,-1e-05 0),(1.00001 1.00001,1.99999 1.00001,1.99999 1.99999,1.00001 1.99999,1.00001 1.00001)),((-1 -0.99999,-0.99999 -0.99999,-0.99999 -1,-0.99999 -2,-0.99999 -2.00001,-1 -2.00001,-2 -2.00001,-2.00001 -2.00001,-2.00001 -2,-2.00001 -1,-2.00001 -0.99999,-2 -0.99999,-1 -0.99999)))
 MULTIPOLYGON(((3 2.00001,4.99999 4.00001,5 4.00001,5.00001 4.00001,5.00001 4,5.00001 3.99999,3.00001 1.99999,3 1.99999,2.99999 1.99999,1.99999 2.99999,1.99999 3,1.99999 3.00001,2 3.00001,2.00001 3.00001,3 2.00001)),((0.99999 1,0.99999 2,0.99999 2.00001,1 2.00001,1.00001 2.00001,1.00001 2,1.00001 1,1.00001 0.99999,1e-05 -1e-05,0 -1e-05,-1e-05 -1e-05,-1e-05 0,-1e-05 1e-05,0.99999 1)))
 POLYGON((1.99999 2,1.99999 3,1.99999 3.00001,2 3.00001,3 3.00001,3.00001 3.00001,3.00001 3,3.00001 2.99999,3 2.99999,2.00001 2.99999,2.00001 2,2.00001 1.99999,1.00001 0.99999,1 0.99999,0.99999 0.99999,0.99999 1,0.99999 1.00001,1.99999 2))
 POLYGON((10.00001 30,10.00001 29.99999,10 29.99999,9.99999 29.99999,9.99999 30,9.99999 30.00001,10 30.00001,10.00001 30.00001,10.00001 30))
(6 rows)

SELECT ST_CoveredBy(geog, ST_GeogFromText('POLYGON((1 1, 5 1, 10 2, 2 5, 1 1))')) FROM geography_test WHERE GeometryType(geog) = 'POINT' ORDER BY id;
 st_coveredby 
--------------
 f
 f
(2 rows)

SELECT ST_Covers(ST_GeogFromText('POLYGON((1 1, 5 1, 10 2, 2 5, 1 1))'), geog) FROM geography_test WHERE GeometryType(geog) = 'POINT' ORDER BY id;
 st_covers 
-----------
 f
 f
(2 rows)

SELECT ST_DWithin(geog, geog, 1) FROM geography_test ORDER BY id;
 st_dwithin 
------------
 t
 t
 t
 t
 t
 t
(6 rows)

SELECT a.id, a.name, b.name FROM geography_test a LEFT JOIN geography_test b ON ST_DWithin(a.geog, b.geog, 100000);
 id | name | name 
----+------+------
  2 | B    | C
  2 | B    | A1
  2 | B    | B
  2 | B    | D
  4 | D    | C
  4 | D    | A1
  4 | D    | B
  4 | D    | D
  1 | A1   | A1
 11 | A2   | A2
  3 | C    | C
  3 | C    | A1
  3 | C    | B
  3 | C    | D
  5 | A1   | C
  5 | A1   | A1
  5 | A1   | B
  5 | A1   | D
(18 rows)

SELECT ST_Distance(geog, ST_GeomFromText('POINT(10 10)', 4326)), ST_Distance(geog, ST_GeomFromText('POINT(0 0)', 4326)) FROM geography_test ORDER BY id;
   st_distance    |   st_distance    
------------------+------------------
                0 | 1565109.09912302
 1094431.41094604 | 156899.568281358
 937766.951787417 |                0
 863270.749388453 |                0
 1094520.51481332 | 156899.568281358
 2214258.56470579 | 3485311.26453287
(6 rows)

SELECT ST_GeogFromText(ST_AsText(geog)), ST_GeogFromWKB(ST_AsBinary(geog)), ST_GeographyFromText(ST_AsText(geog)) FROM geography_test ORDER BY id;
                                                                                                                                                                                                                                                                                    st_geogfromtext                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                     st_geogfromwkb                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                  st_geographyfromtext                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0101000020E610000000000000000024400000000000002440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 0101000020E610000000000000000024400000000000002440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 0101000020E610000000000000000024400000000000002440
 0103000020E61000000100000005000000000000000000F03F000000000000F03F000000000000004000000000000000400000000000000040000000000000104000000000000010400000000000000040000000000000F03F000000000000F03F                                                                                                                                                                                                                                                                                                                                                                                     | 0103000020E61000000100000005000000000000000000F03F000000000000F03F000000000000004000000000000000400000000000000040000000000000104000000000000010400000000000000040000000000000F03F000000000000F03F                                                                                                                                                                                                                                                                                                                                                                                     | 0103000020E61000000100000005000000000000000000F03F000000000000F03F000000000000004000000000000000400000000000000040000000000000104000000000000010400000000000000040000000000000F03F000000000000F03F
 0106000020E61000000200000001030000000200000005000000000000000000000000000000000000000000000000001040000000000000000000000000000010400000000000001040000000000000000000000000000010400000000000000000000000000000000005000000000000000000F03F000000000000F03F0000000000000040000000000000F03F00000000000000400000000000000040000000000000F03F0000000000000040000000000000F03F000000000000F03F01030000000100000005000000000000000000F0BF000000000000F0BF000000000000F0BF00000000000000C000000000000000C000000000000000C000000000000000C0000000000000F0BF000000000000F0BF000000000000F0BF | 0106000020E61000000200000001030000000200000005000000000000000000000000000000000000000000000000001040000000000000000000000000000010400000000000001040000000000000000000000000000010400000000000000000000000000000000005000000000000000000F03F000000000000F03F0000000000000040000000000000F03F00000000000000400000000000000040000000000000F03F0000000000000040000000000000F03F000000000000F03F01030000000100000005000000000000000000F0BF000000000000F0BF000000000000F0BF00000000000000C000000000000000C000000000000000C000000000000000C0000000000000F0BF000000000000F0BF000000000000F0BF | 0106000020E61000000200000001030000000200000005000000000000000000000000000000000000000000000000001040000000000000000000000000000010400000000000001040000000000000000000000000000010400000000000000000000000000000000005000000000000000000F03F000000000000F03F0000000000000040000000000000F03F00000000000000400000000000000040000000000000F03F0000000000000040000000000000F03F000000000000F03F01030000000100000005000000000000000000F0BF000000000000F0BF000000000000F0BF00000000000000C000000000000000C000000000000000C000000000000000C0000000000000F0BF000000000000F0BF000000000000F0BF
 0105000020E61000000200000001020000000300000000000000000000000000000000000000000000000000F03F000000000000F03F000000000000F03F0000000000000040010200000003000000000000000000004000000000000008400000000000000840000000000000004000000000000014400000000000001040                                                                                                                                                                                                                                                                                                                         | 0105000020E61000000200000001020000000300000000000000000000000000000000000000000000000000F03F000000000000F03F000000000000F03F0000000000000040010200000003000000000000000000004000000000000008400000000000000840000000000000004000000000000014400000000000001040                                                                                                                                                                                                                                                                                                                         | 0105000020E61000000200000001020000000300000000000000000000000000000000000000000000000000F03F000000000000F03F000000000000F03F0000000000000040010200000003000000000000000000004000000000000008400000000000000840000000000000004000000000000014400000000000001040
 0102000020E610000004000000000000000000F03F000000000000F03F000000000000004000000000000000400000000000000040000000000000084000000000000008400000000000000840                                                                                                                                                                                                                                                                                                                                                                                                                             | 0102000020E610000004000000000000000000F03F000000000000F03F000000000000004000000000000000400000000000000040000000000000084000000000000008400000000000000840                                                                                                                                                                                                                                                                                                                                                                                                                             | 0102000020E610000004000000000000000000F03F000000000000F03F000000000000004000000000000000400000000000000040000000000000084000000000000008400000000000000840
 0101000020E610000000000000000024400000000000003E40                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 0101000020E610000000000000000024400000000000003E40                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 0101000020E610000000000000000024400000000000003E40
(6 rows)

SELECT ST_AsText(ST_Intersection(geog, ST_GeogFromText('POLYGON((1 1, 5 1, 10 2, 2 5, 1 1))'))) FROM geography_test ORDER BY id;
                                                                                                                              st_astext                                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GEOMETRYCOLLECTION EMPTY
 POLYGON((1 0.999999999986592,2 1.99999999997326,2 3.99999999999966,4 1.99999999997326,1 0.999999999986592))
 GEOMETRYCOLLECTION(LINESTRING(1 0.999999999986592,2 0.999999999986592),POLYGON((1.7496134612028 3.99999999999966,4 3.99999999999966,4 0.999999999986592,2 0.999999999986592,2 1.99999999997326,1.24969106714786 1.99999999997326,1.7496134612028 3.99999999999966)))
 GEOMETRYCOLLECTION(POINT(1 0.999999999986592),LINESTRING(2 2.99999999999974,3 1.99999999997326,4.90987831907499 3.90996612423391))
 LINESTRING(1 0.999999999986592,2 1.99999999997326,2 2.99999999999974,3 2.99999999999974)
 GEOMETRYCOLLECTION EMPTY
(6 rows)

SELECT ST_Intersects(geog, ST_GeogFromText('POLYGON((1 1, 5 1, 10 2, 2 5, 1 1))')) FROM geography_test ORDER BY id;
 st_intersects 
---------------
 f
 t
 t
 t
 t
 f
(6 rows)

--SELECT ST_Length(ST_GeogFromText('LINESTRING(1 1, 5 1, 10 2, 2 5)')) ORDER BY id;
SELECT id, name, ST_Length(geog) FROM geography_test ORDER BY id;
 id | name |    st_length     
----+------+------------------
  1 | A1   |                0
  2 | B    |                0
  3 | C    |                0
  4 | D    | 737892.359394937
  5 | A1   | 378620.512544212
 11 | A2   |                0
(6 rows)

SELECT ST_AsText(geog), ST_Perimeter(geog::geometry) FROM geography_test ORDER BY id;
                                           st_astext                                           |   st_perimeter   
-----------------------------------------------------------------------------------------------+------------------
 POINT(10 10)                                                                                  |                0
 POLYGON((1 1,2 2,2 4,4 2,1 1))                                                                | 9.40491834728767
 MULTIPOLYGON(((0 0,4 0,4 4,0 4,0 0),(1 1,2 1,2 2,1 2,1 1)),((-1 -1,-1 -2,-2 -2,-2 -1,-1 -1))) |               24
 MULTILINESTRING((0 0,1 1,1 2),(2 3,3 2,5 4))                                                  |                0
 LINESTRING(1 1,2 2,2 3,3 3)                                                                   |                0
 POINT(10 30)                                                                                  |                0
(6 rows)

SELECT ST_AsText(geog), ST_Summary(geog) FROM geography_test ORDER BY id;
                                           st_astext                                           |             st_summary              
-----------------------------------------------------------------------------------------------+-------------------------------------
 POINT(10 10)                                                                                  | Point[G]
 POLYGON((1 1,2 2,2 4,4 2,1 1))                                                                | Polygon[BG] with 1 rings            
                                                                                               :    ring 0 has 5 points
 MULTIPOLYGON(((0 0,4 0,4 4,0 4,0 0),(1 1,2 1,2 2,1 2,1 1)),((-1 -1,-1 -2,-2 -2,-2 -1,-1 -1))) | MultiPolygon[BG] with 2 elements    
                                                                                               :   Polygon[G] with 2 rings           
                                                                                               :    ring 0 has 5 points              
                                                                                               :    ring 1 has 5 points              
                                                                                               :   Polygon[G] with 1 rings           
                                                                                               :    ring 0 has 5 points
 MULTILINESTRING((0 0,1 1,1 2),(2 3,3 2,5 4))                                                  | MultiLineString[BG] with 2 elements 
                                                                                               :   LineString[G] with 3 points       
                                                                                               :   LineString[G] with 3 points
 LINESTRING(1 1,2 2,2 3,3 3)                                                                   | LineString[BG] with 4 points
 POINT(10 30)                                                                                  | Point[G]
(6 rows)

SELECT ST_AsText(geog), geog && ST_GeogFromText('LINESTRING(1 1, 5 1, 10 2, 2 5)') FROM geography_test ORDER BY id;
                                           st_astext                                           | ?column? 
-----------------------------------------------------------------------------------------------+----------
 POINT(10 10)                                                                                  | f
 POLYGON((1 1,2 2,2 4,4 2,1 1))                                                                | t
 MULTIPOLYGON(((0 0,4 0,4 4,0 4,0 0),(1 1,2 1,2 2,1 2,1 1)),((-1 -1,-1 -2,-2 -2,-2 -1,-1 -1))) | t
 MULTILINESTRING((0 0,1 1,1 2),(2 3,3 2,5 4))                                                  | t
 LINESTRING(1 1,2 2,2 3,3 3)                                                                   | t
 POINT(10 30)                                                                                  | f
(6 rows)

DROP TABLE geography_test;
DROP TABLE
