\c mpph_heap
select 'mpph00-1',count(*), sum(n_nationkey), min(n_nationkey), max(n_nationkey) from nation;
 ?column? | count | sum | min | max 
----------+-------+-----+-----+-----
 mpph00-1 |    25 | 300 |   0 |  24
(1 row)

select 'mpph00-2',count(*), sum(r_regionkey), min(r_regionkey), max(r_regionkey) from region;
 ?column? | count | sum | min | max 
----------+-------+-----+-----+-----
 mpph00-2 |     5 |  10 |   0 |   4
(1 row)

select 'mpph00-3',count(*), sum(p_partkey), min(p_partkey), max(p_partkey) from part;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-3 |  2000 | 2001000 |   1 | 2000
(1 row)

select 'mpph00-4',count(*), sum(s_suppkey), min(s_suppkey), max(s_suppkey) from supplier;
 ?column? | count | sum  | min | max 
----------+-------+------+-----+-----
 mpph00-4 |   100 | 5050 |   1 | 100
(1 row)

select 'mpph00-5',count(*), sum(ps_partkey + ps_suppkey), min(ps_partkey + ps_suppkey), max(ps_partkey + ps_suppkey) from partsupp;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-5 |  8000 | 8408000 |   3 | 2099
(1 row)

select 'mpph00-6',count(*), sum(c_custkey), min(c_custkey), max(c_custkey) from customer;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-6 |  1500 | 1125750 |   1 | 1500
(1 row)

select 'mpph00-7',count(*), sum(o_orderkey), min(o_orderkey), max(o_orderkey) from orders;
 ?column? | count |    sum    | min |  max  
----------+-------+-----------+-----+-------
 mpph00-7 | 15000 | 449872500 |   1 | 60000
(1 row)

select 'mpph00-8',count(*), sum(l_linenumber), min(l_linenumber), max(l_linenumber) from lineitem;
 ?column? | count |  sum   | min | max 
----------+-------+--------+-----+-----
 mpph00-8 | 60175 | 180782 |   1 |   7
(1 row)

select  'mpph1',
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '108 day'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
 ?column? | l_returnflag | l_linestatus |  sum_qty  | sum_base_price | sum_disc_price |    sum_charge     |       avg_qty       |     avg_price      |        avg_disc        | count_order 
----------+--------------+--------------+-----------+----------------+----------------+-------------------+---------------------+--------------------+------------------------+-------------
 mpph1    | A            | F            | 380456.00 |   532348211.65 | 505822441.4861 |  526165934.000839 | 25.5751546114546921 | 35785.709306937349 | 0.05008133906964237698 |       14876
 mpph1    | N            | F            |   8971.00 |    12384801.37 |  11798257.2080 |   12282485.056933 | 25.7787356321839080 | 35588.509683908046 | 0.04775862068965517241 |         348
 mpph1    | N            | O            | 733323.00 |  1028186527.78 | 977118238.4241 | 1016280268.835844 | 25.4466999791796794 | 35678.621964744257 | 0.04991255465334166146 |       28818
 mpph1    | R            | F            | 381449.00 |   534594445.35 | 507996454.4067 |  528524219.358903 | 25.5971681653469333 | 35874.006532680177 | 0.04982753992752650651 |       14902
(4 rows)

select  'mpph2',
	s.s_acctbal,
	s.s_name,
	n.n_name,
	p.p_partkey,
	p.p_mfgr,
	s.s_address,
	s.s_phone,
	s.s_comment 
from 
	supplier s, 
	partsupp ps, 
	nation n, 
	region r, 
	part p, 
	(select p_partkey, min(ps_supplycost) as min_ps_cost 
		from 
			part, 
			partsupp , 	
			supplier,
			nation, 
			region 
		where 
			p_partkey=ps_partkey 
			and s_suppkey = ps_suppkey 
			and s_nationkey = n_nationkey 
			and n_regionkey = r_regionkey 
			and r_name = 'EUROPE' 
		group by p_partkey ) g 
where 
	p.p_partkey = ps.ps_partkey 
	and g.p_partkey = p.p_partkey 
	and g. min_ps_cost = ps.ps_supplycost 
	and s.s_suppkey = ps.ps_suppkey 
	and p.p_size = 45 
	and p.p_type like '%NICKEL' 
	and s.s_nationkey = n.n_nationkey 
	and n.n_regionkey = r.r_regionkey 
	and r.r_name = 'EUROPE' 
order by 
	s.s_acctbal desc,
	n.n_name,
	s.s_name,
	p.p_partkey
LIMIT 100;
 ?column? | s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
----------+-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
 mpph2    |   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
 mpph2    |   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
 mpph2    |   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 45
	and p_type like '%NICKEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
 s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select  'mpph3',
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'MACHINERY'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-15'
	and l_shipdate > date '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
 ?column? | l_orderkey |   revenue   | o_orderdate | o_shippriority 
----------+------------+-------------+-------------+----------------
 mpph3    |      12641 | 222127.6271 | 02-23-1995  |              0
 mpph3    |      39878 | 219714.3069 | 03-06-1995  |              0
 mpph3    |      34243 | 214308.7196 | 02-12-1995  |              0
 mpph3    |       7171 | 202398.1900 | 02-14-1995  |              0
 mpph3    |      55271 | 195237.8000 | 03-12-1995  |              0
 mpph3    |      50145 | 189500.1602 | 02-27-1995  |              0
 mpph3    |      12867 | 185769.1004 | 03-12-1995  |              0
 mpph3    |      12066 | 180776.3231 | 02-07-1995  |              0
 mpph3    |      41926 | 180459.9518 | 02-06-1995  |              0
 mpph3    |      46307 | 180383.2464 | 02-07-1995  |              0
(10 rows)

select  'mpph4',
        o_orderpriority,
        count(*) as order_count
from
        orders
where
        o_orderdate >= date '1994-05-01'
        and o_orderdate < date '1994-05-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
 ?column? | o_orderpriority | order_count 
----------+-----------------+-------------
 mpph4    | 1-URGENT        |         108
 mpph4    | 2-HIGH          |         117
 mpph4    | 3-MEDIUM        |          95
 mpph4    | 4-NOT SPECIFIED |         111
 mpph4    | 5-LOW           |         116
(5 rows)

select  'mpph5',
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '1 year'
group by
	n_name
order by
	revenue desc;
 ?column? |          n_name           |   revenue   
----------+---------------------------+-------------
 mpph5    | UNITED STATES             | 721432.9139
 mpph5    | CANADA                    | 451731.0802
 mpph5    | PERU                      | 317553.7203
 mpph5    | BRAZIL                    | 275951.7747
 mpph5    | ARGENTINA                 | 225713.4702
(5 rows)

select  'mpph6',
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= date '1996-01-01'
	and l_shipdate < date '1996-01-01' + interval '1 year'
	and l_discount between 0.04 - 0.01 and 0.04 + 0.01
	and l_quantity < 24;
 ?column? |   revenue   
----------+-------------
 mpph6    | 740117.7050
(1 row)

select  'mpph7',
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'MOZAMBIQUE')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
 ?column? |        supp_nation        |        cust_nation        | l_year |   revenue    
----------+---------------------------+---------------------------+--------+--------------
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1995 |  749611.6213
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1996 |  838743.2524
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1995 |  669933.3036
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1996 | 1084686.2375
(4 rows)

select  'mpph8',
	o_year,
	sum(case
		when nation = 'PERU' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'MEDIUM POLISHED TIN'
	) as all_nations
group by
	o_year
order by
	o_year;
 ?column? | o_year |         mkt_share          
----------+--------+----------------------------
 mpph8    |   1995 | 0.000000000000000000000000
 mpph8    |   1996 |     0.17380660267693394854
(2 rows)

select  'mpph9',
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%tan%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
 ?column? |          nation           | o_year | sum_profit  
----------+---------------------------+--------+-------------
 mpph9    | ALGERIA                   |   1998 | 203717.6183
 mpph9    | ALGERIA                   |   1997 | 277895.7940
 mpph9    | ALGERIA                   |   1996 | 285313.9627
 mpph9    | ALGERIA                   |   1995 | 309375.7934
 mpph9    | ALGERIA                   |   1994 | 288152.6449
 mpph9    | ALGERIA                   |   1993 | 321222.9401
 mpph9    | ALGERIA                   |   1992 | 436020.6807
 mpph9    | ARGENTINA                 |   1998 | 217919.0097
 mpph9    | ARGENTINA                 |   1997 |  47720.1989
 mpph9    | ARGENTINA                 |   1996 | 373086.6814
 mpph9    | ARGENTINA                 |   1995 | 256403.9057
 mpph9    | ARGENTINA                 |   1994 | 172411.8182
 mpph9    | ARGENTINA                 |   1993 | 414051.7103
 mpph9    | ARGENTINA                 |   1992 | 497745.7196
 mpph9    | BRAZIL                    |   1998 |   9402.1360
 mpph9    | BRAZIL                    |   1996 | 130680.4872
 mpph9    | BRAZIL                    |   1995 |  47629.8480
 mpph9    | BRAZIL                    |   1994 |  22440.1440
 mpph9    | BRAZIL                    |   1993 | 106237.4759
 mpph9    | BRAZIL                    |   1992 | 116994.4770
 mpph9    | CANADA                    |   1998 |  67660.5389
 mpph9    | CANADA                    |   1997 | 167179.5520
 mpph9    | CANADA                    |   1996 | 147802.3006
 mpph9    | CANADA                    |   1995 |  84817.9292
 mpph9    | CANADA                    |   1994 |  49027.1082
 mpph9    | CANADA                    |   1993 | 157886.0056
 mpph9    | CANADA                    |   1992 | 191231.3590
 mpph9    | CHINA                     |   1998 | 382876.9927
 mpph9    | CHINA                     |   1997 | 787527.2369
 mpph9    | CHINA                     |   1996 | 605901.5293
 mpph9    | CHINA                     |   1995 | 587705.6412
 mpph9    | CHINA                     |   1994 | 917527.5948
 mpph9    | CHINA                     |   1993 | 839365.4133
 mpph9    | CHINA                     |   1992 | 748324.7469
 mpph9    | EGYPT                     |   1998 | 220523.2078
 mpph9    | EGYPT                     |   1997 | 554962.2792
 mpph9    | EGYPT                     |   1996 | 526118.5876
 mpph9    | EGYPT                     |   1995 | 406448.9115
 mpph9    | EGYPT                     |   1994 | 404925.7193
 mpph9    | EGYPT                     |   1993 | 296691.1725
 mpph9    | EGYPT                     |   1992 | 449161.6055
 mpph9    | ETHIOPIA                  |   1998 | 178828.6942
 mpph9    | ETHIOPIA                  |   1997 | 322949.1543
 mpph9    | ETHIOPIA                  |   1996 | 179589.0062
 mpph9    | ETHIOPIA                  |   1995 | 215017.5362
 mpph9    | ETHIOPIA                  |   1994 | 509710.4645
 mpph9    | ETHIOPIA                  |   1993 | 251330.1758
 mpph9    | ETHIOPIA                  |   1992 | 225397.2384
 mpph9    | FRANCE                    |   1998 | 210901.9632
 mpph9    | FRANCE                    |   1997 | 234428.9324
 mpph9    | FRANCE                    |   1996 | 283026.6644
 mpph9    | FRANCE                    |   1995 | 428615.5897
 mpph9    | FRANCE                    |   1994 | 233410.4344
 mpph9    | FRANCE                    |   1993 | 420330.4447
 mpph9    | FRANCE                    |   1992 | 359496.0042
 mpph9    | GERMANY                   |   1998 | 229863.3768
 mpph9    | GERMANY                   |   1997 | 519160.2856
 mpph9    | GERMANY                   |   1996 | 533764.1221
 mpph9    | GERMANY                   |   1995 | 621744.7373
 mpph9    | GERMANY                   |   1994 | 340785.3795
 mpph9    | GERMANY                   |   1993 | 673651.1393
 mpph9    | GERMANY                   |   1992 | 524002.5977
 mpph9    | INDIA                     |   1998 | 334403.8655
 mpph9    | INDIA                     |   1997 | 156434.8865
 mpph9    | INDIA                     |   1996 | 265093.2063
 mpph9    | INDIA                     |   1995 | 137842.0462
 mpph9    | INDIA                     |   1994 | 262710.5074
 mpph9    | INDIA                     |   1993 | 328441.1285
 mpph9    | INDIA                     |   1992 | 199589.6727
 mpph9    | INDONESIA                 |   1998 | 155973.1013
 mpph9    | INDONESIA                 |   1997 | 316792.0784
 mpph9    | INDONESIA                 |   1996 | 422245.5263
 mpph9    | INDONESIA                 |   1995 | 235242.8814
 mpph9    | INDONESIA                 |   1994 | 326775.3396
 mpph9    | INDONESIA                 |   1993 | 327711.7699
 mpph9    | INDONESIA                 |   1992 | 243688.5923
 mpph9    | IRAN                      |   1998 |  27198.8568
 mpph9    | IRAN                      |   1997 | 174737.8001
 mpph9    | IRAN                      |   1996 |  50121.8822
 mpph9    | IRAN                      |   1995 |  70977.8022
 mpph9    | IRAN                      |   1994 | 104593.0442
 mpph9    | IRAN                      |   1993 |  25867.0544
 mpph9    | IRAN                      |   1992 |  82988.9337
 mpph9    | IRAQ                      |   1998 | 157348.1240
 mpph9    | IRAQ                      |   1997 | 227619.0410
 mpph9    | IRAQ                      |   1996 | 114431.2136
 mpph9    | IRAQ                      |   1995 |  83702.7028
 mpph9    | IRAQ                      |   1994 | 189246.3076
 mpph9    | IRAQ                      |   1993 | 172977.0040
 mpph9    | IRAQ                      |   1992 | 165679.6544
 mpph9    | JAPAN                     |   1998 | 301448.7416
 mpph9    | JAPAN                     |   1997 | 274224.7673
 mpph9    | JAPAN                     |   1996 | 365055.9942
 mpph9    | JAPAN                     |   1995 | 273486.9553
 mpph9    | JAPAN                     |   1994 | 306480.9939
 mpph9    | JAPAN                     |   1993 | 309841.9310
 mpph9    | JAPAN                     |   1992 | 257133.6723
 mpph9    | JORDAN                    |   1998 |  51101.6440
 mpph9    | JORDAN                    |   1996 |   6016.6285
 mpph9    | JORDAN                    |   1995 |  58278.1892
 mpph9    | JORDAN                    |   1994 |  59604.3204
 mpph9    | JORDAN                    |   1993 | 110544.8190
 mpph9    | KENYA                     |   1998 | 239097.5320
 mpph9    | KENYA                     |   1997 | 177292.9690
 mpph9    | KENYA                     |   1996 | 597636.7126
 mpph9    | KENYA                     |   1995 | 434837.8428
 mpph9    | KENYA                     |   1994 | 511118.7047
 mpph9    | KENYA                     |   1993 | 181482.4886
 mpph9    | KENYA                     |   1992 | 442814.6201
 mpph9    | MOROCCO                   |   1998 |  94153.7562
 mpph9    | MOROCCO                   |   1997 |   1952.7200
 mpph9    | MOROCCO                   |   1996 | 184609.4769
 mpph9    | MOROCCO                   |   1995 | 138773.7720
 mpph9    | MOROCCO                   |   1994 | 141735.9952
 mpph9    | MOROCCO                   |   1993 | 240971.4009
 mpph9    | MOROCCO                   |   1992 |  76485.6974
 mpph9    | MOZAMBIQUE                |   1998 | 315271.5330
 mpph9    | MOZAMBIQUE                |   1997 | 593511.8009
 mpph9    | MOZAMBIQUE                |   1996 | 463830.0035
 mpph9    | MOZAMBIQUE                |   1995 | 463982.1278
 mpph9    | MOZAMBIQUE                |   1994 | 402790.4493
 mpph9    | MOZAMBIQUE                |   1993 | 765203.5080
 mpph9    | MOZAMBIQUE                |   1992 | 552780.7126
 mpph9    | PERU                      |   1998 | 291043.9094
 mpph9    | PERU                      |   1997 | 332386.6526
 mpph9    | PERU                      |   1996 | 271308.8627
 mpph9    | PERU                      |   1995 | 136468.6570
 mpph9    | PERU                      |   1994 | 231696.8464
 mpph9    | PERU                      |   1993 | 319175.9000
 mpph9    | PERU                      |   1992 | 296178.1348
 mpph9    | ROMANIA                   |   1998 | 366693.1531
 mpph9    | ROMANIA                   |   1997 | 313915.6675
 mpph9    | ROMANIA                   |   1996 | 257449.7931
 mpph9    | ROMANIA                   |   1995 | 613689.1994
 mpph9    | ROMANIA                   |   1994 | 514683.8323
 mpph9    | ROMANIA                   |   1993 | 301818.9752
 mpph9    | ROMANIA                   |   1992 | 445559.9618
 mpph9    | RUSSIA                    |   1998 | 215635.7552
 mpph9    | RUSSIA                    |   1997 | 263377.9773
 mpph9    | RUSSIA                    |   1996 | 292798.2473
 mpph9    | RUSSIA                    |   1995 | 202559.9044
 mpph9    | RUSSIA                    |   1994 | 287175.8782
 mpph9    | RUSSIA                    |   1993 | 163995.8157
 mpph9    | RUSSIA                    |   1992 | 356477.2999
 mpph9    | SAUDI ARABIA              |   1998 |  22338.7375
 mpph9    | SAUDI ARABIA              |   1997 |  89352.2847
 mpph9    | SAUDI ARABIA              |   1996 | 172227.1252
 mpph9    | SAUDI ARABIA              |   1995 | 104670.1059
 mpph9    | SAUDI ARABIA              |   1994 |  39327.6690
 mpph9    | SAUDI ARABIA              |   1993 |  76176.8010
 mpph9    | SAUDI ARABIA              |   1992 |  71000.2760
 mpph9    | UNITED KINGDOM            |   1998 |  57011.9084
 mpph9    | UNITED KINGDOM            |   1997 |  86313.0141
 mpph9    | UNITED KINGDOM            |   1996 |  93430.0955
 mpph9    | UNITED KINGDOM            |   1995 | 105005.8744
 mpph9    | UNITED KINGDOM            |   1994 | 111953.2358
 mpph9    | UNITED KINGDOM            |   1993 | 161721.5622
 mpph9    | UNITED KINGDOM            |   1992 | 173519.0108
 mpph9    | UNITED STATES             |   1998 | 382856.8948
 mpph9    | UNITED STATES             |   1997 | 494438.3396
 mpph9    | UNITED STATES             |   1996 | 548337.7007
 mpph9    | UNITED STATES             |   1995 | 720764.4099
 mpph9    | UNITED STATES             |   1994 | 695834.7785
 mpph9    | UNITED STATES             |   1993 | 593012.3919
 mpph9    | UNITED STATES             |   1992 | 801814.0301
 mpph9    | VIETNAM                   |   1998 | 253199.9819
 mpph9    | VIETNAM                   |   1997 | 551578.3779
 mpph9    | VIETNAM                   |   1996 | 309940.0530
 mpph9    | VIETNAM                   |   1995 | 491467.2046
 mpph9    | VIETNAM                   |   1994 | 510626.2215
 mpph9    | VIETNAM                   |   1993 | 786734.2542
 mpph9    | VIETNAM                   |   1992 | 511062.6378
(172 rows)

select  'mpph10',
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1994-10-01'
	and o_orderdate < date '1994-10-01' + interval '3 month'
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 ?column? | c_custkey |       c_name       |   revenue   | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                      c_comment                                                      
----------+-----------+--------------------+-------------+-----------+---------------------------+------------------------------------------+-----------------+---------------------------------------------------------------------------------------------------------------------
 mpph10   |       643 | Customer#000000643 | 379216.9236 |   5184.70 | ALGERIA                   | 9T 2avhfyF PQ                            | 10-978-597-2747 | fily along the quickly ironic ideas. final, final
 mpph10   |      1255 | Customer#000001255 | 348227.6139 |   6487.71 | KENYA                     | UC6I32JjBU62t4WgDe e2pDYbuM3VAt4MPM      | 24-359-633-2713 | s deposits sleep. blithely ironic dependencies wake. blithely even theodolites sleep. blithely 
 mpph10   |      1144 | Customer#000001144 | 344762.9152 |   4189.04 | ARGENTINA                 | DGLUWG9evYLNbYhOXVzqZ LdfIMVfBjDf        | 11-336-453-4489 |  ideas. even, regular excuses after the ironic requests cajole blithe
 mpph10   |       871 | Customer#000000871 | 336419.8098 |   -395.89 | SAUDI ARABIA              | KcLmBKitbx7NvU7bpu9clIyccxWG             | 30-933-714-8982 | ts. blithely silent courts doze. regular atta
 mpph10   |       421 | Customer#000000421 | 335198.8566 |   7073.17 | JORDAN                    | it3mUlkZAe9J8gmy                         | 23-918-228-2560 | lithely final deposits haggle furiously above the
 mpph10   |        61 | Customer#000000061 | 332777.6898 |   1536.24 | PERU                      | 9kndve4EAJxhg3veF BfXr7AqOsT39o gtqjaYE  | 27-626-559-8599 | egular packages shall have to impress along the 
 mpph10   |      1121 | Customer#000001121 | 320274.8995 |   3942.11 | SAUDI ARABIA              | o2uc3AHYz,m 3vYg8YxBwI0XuG               | 30-197-936-4724 | usly? final theodolites are carefully 
 mpph10   |       532 | Customer#000000532 | 296758.8028 |   1725.68 | MOROCCO                   | xwWO3lWjgVJTZwhnltyH6zj5ddkzgH8RbF       | 25-875-978-2232 | usly regular deposits kindle. quickly even depos
 mpph10   |       584 | Customer#000000584 | 286297.8180 |   8825.71 | MOROCCO                   | jebKvptmHtS9,YE1qOjl2AOw38P,8skngJZh     | 25-352-778-1041 | ages boost regular deposits. blithely stealthy depo
 mpph10   |       892 | Customer#000000892 | 284479.7745 |   4799.98 | INDONESIA                 | N KwiRAwIk6KL9WJ6vt0G                    | 19-589-784-1249 | ses are carefully. quickly regular theodolites cajole. carefully express accounts wake sly
 mpph10   |       169 | Customer#000000169 | 277234.4946 |   4483.83 | CHINA                     | NjhmHa7xrcjE                             | 28-362-499-3728 | fully unusual pinto beans. blithely express asymptotes lose carefully regular instructions? accounts b
 mpph10   |      1036 | Customer#000001036 | 270725.2873 |   1766.23 | INDIA                     | fxujgj8DOFO6oKrH                         | 18-791-577-7691 | ins sleep. slyly express platelets cajol
 mpph10   |       608 | Customer#000000608 | 268304.6758 |   2256.36 | MOZAMBIQUE                | luMI1JpfrrILCEeTgz8k98z                  | 26-767-193-8671 | ld packages. special requests along the accounts are after the carefully unusual deposits. blithely quiet excuses c
 mpph10   |       635 | Customer#000000635 | 261889.3542 |   8216.79 | BRAZIL                    | Ftqi0UYvzz56Ov,J6,ySp5WE4vJ2rtY          | 12-399-186-7550 | efully bold deposits doubt above the clos
 mpph10   |      1279 | Customer#000001279 | 261726.8460 |   7915.06 | KENYA                     | fkrzLacsqCnwUwgjjttKmY                   | 24-742-587-6985 | tes are. ideas above the carefully ironic d
 mpph10   |      1483 | Customer#000001483 | 256807.2933 |   4409.70 | GERMANY                   | ZjY1C b6cOnY3                            | 17-202-113-4814 | nts sleep around the carefully express theodolites. requests nag 
 mpph10   |        71 | Customer#000000071 | 251773.7061 |   -611.19 | GERMANY                   | TlGalgdXWBmMV,6agLyWYDyIz9MKzcY8gl,w6t1B | 17-710-812-5403 | g courts across the regular, final pinto beans are blithely pending ac
 mpph10   |       664 | Customer#000000664 | 244482.6132 |   8878.22 | MOROCCO                   | viRe1P6HiyL4LXpU7HPwu                    | 25-329-655-5068 | yly ironic requests cajole pending pla
 mpph10   |       883 | Customer#000000883 | 238622.1581 |    479.96 | CANADA                    | qVQ8rWNU5KZYDcS                          | 13-526-239-6950 | uctions are carefully across the regular, regular asymptote
 mpph10   |      1288 | Customer#000001288 | 236676.5999 |   6603.43 | CANADA                    | wQDTTCkSGxic2d66                         | 13-533-256-9320 | equests detect atop the ironic deposits. final requests according to the blithely sp
(20 rows)

select  'mpph11',
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ROMANIA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ROMANIA'
		)
order by
	value desc;
 ?column? | ps_partkey |    value    
----------+------------+-------------
 mpph11   |        917 | 12344895.22
 mpph11   |        685 | 11950940.60
 mpph11   |       1081 | 10580686.59
 mpph11   |       1011 |  9608892.80
 mpph11   |        623 |  9343081.80
 mpph11   |        787 |  8569925.48
 mpph11   |       1185 |  8073895.00
 mpph11   |        367 |  7883443.69
 mpph11   |        109 |  7657641.60
 mpph11   |       1451 |  7613526.60
 mpph11   |       1899 |  7550881.80
 mpph11   |       1842 |  7505106.20
 mpph11   |        213 |  7479470.28
 mpph11   |        161 |  7398630.95
 mpph11   |       1416 |  7287490.02
 mpph11   |       1309 |  7213260.60
 mpph11   |        949 |  7197510.84
 mpph11   |       1323 |  7140115.71
 mpph11   |       1046 |  7046743.50
 mpph11   |         69 |  6970845.15
 mpph11   |       1581 |  6760133.10
 mpph11   |        862 |  6658234.84
 mpph11   |       1283 |  6609824.32
 mpph11   |       1277 |  6599037.12
 mpph11   |        828 |  6565785.62
 mpph11   |       1536 |  6561151.80
 mpph11   |        207 |  6537250.98
 mpph11   |       1085 |  6537104.27
 mpph11   |        751 |  6531660.40
 mpph11   |        360 |  6530297.41
 mpph11   |       1984 |  6495512.50
 mpph11   |        765 |  6460546.80
 mpph11   |       1917 |  6227301.68
 mpph11   |       1716 |  6116013.75
 mpph11   |        730 |  6100067.88
 mpph11   |        994 |  6032702.08
 mpph11   |       1144 |  6012205.92
 mpph11   |       1108 |  5914872.72
 mpph11   |       1950 |  5912352.20
 mpph11   |       1963 |  5873329.44
 mpph11   |         26 |  5867999.40
 mpph11   |        983 |  5846645.17
 mpph11   |       1808 |  5835183.38
 mpph11   |        504 |  5770344.51
 mpph11   |       1016 |  5718859.87
 mpph11   |       1494 |  5687809.60
 mpph11   |       1551 |  5668132.44
 mpph11   |        262 |  5625893.82
 mpph11   |        465 |  5537420.64
 mpph11   |        125 |  5533747.40
 mpph11   |       1972 |  5526059.28
 mpph11   |       1125 |  5514223.46
 mpph11   |        601 |  5513532.30
 mpph11   |        886 |  5450951.91
 mpph11   |        173 |  5409250.08
 mpph11   |       1752 |  5389034.04
 mpph11   |       1644 |  5387317.60
 mpph11   |        526 |  5350481.57
 mpph11   |        895 |  5346555.18
 mpph11   |       1576 |  5301661.68
 mpph11   |        692 |  5269557.57
 mpph11   |        951 |  5264770.02
 mpph11   |        861 |  5214617.22
 mpph11   |       1545 |  5196334.26
 mpph11   |       1356 |  5192649.28
 mpph11   |        789 |  5162645.80
 mpph11   |       1516 |  5107050.00
 mpph11   |       1616 |  5091834.00
 mpph11   |       1116 |  4992110.70
 mpph11   |        551 |  4982558.21
 mpph11   |       1887 |  4934262.24
 mpph11   |        885 |  4876658.57
 mpph11   |        116 |  4852263.60
 mpph11   |        251 |  4747015.56
 mpph11   |        394 |  4624460.10
 mpph11   |       1091 |  4589240.04
 mpph11   |        329 |  4558084.80
 mpph11   |        632 |  4494879.28
 mpph11   |       1485 |  4482428.50
 mpph11   |       1725 |  4340873.16
 mpph11   |        816 |  4326623.61
 mpph11   |        699 |  4310431.00
 mpph11   |        403 |  4283221.60
 mpph11   |       1768 |  4251602.98
 mpph11   |       1158 |  4229896.16
 mpph11   |        591 |  4216726.24
 mpph11   |       1248 |  4157093.60
 mpph11   |       1679 |  4156156.64
 mpph11   |        663 |  4142402.22
 mpph11   |       1719 |  4101486.48
 mpph11   |        395 |  4052997.76
 mpph11   |       1351 |  4045565.12
 mpph11   |        531 |  4042060.39
 mpph11   |       1951 |  4023967.36
 mpph11   |       1294 |  4009307.81
 mpph11   |        616 |  4004057.26
 mpph11   |        316 |  3986943.88
 mpph11   |       1928 |  3964898.76
 mpph11   |       1337 |  3951488.10
 mpph11   |       1851 |  3918641.34
 mpph11   |        521 |  3913058.16
 mpph11   |        883 |  3908087.82
 mpph11   |        961 |  3814756.38
 mpph11   |        366 |  3812257.88
 mpph11   |       1875 |  3800216.84
 mpph11   |        668 |  3772880.16
 mpph11   |        107 |  3756380.24
 mpph11   |       1061 |  3747377.84
 mpph11   |         16 |  3745783.12
 mpph11   |        294 |  3744033.70
 mpph11   |       1561 |  3711744.00
 mpph11   |       1574 |  3702071.64
 mpph11   |       1732 |  3695765.58
 mpph11   |        564 |  3680200.80
 mpph11   |       1371 |  3677874.16
 mpph11   |        516 |  3664770.45
 mpph11   |       1585 |  3641002.20
 mpph11   |        755 |  3635116.80
 mpph11   |        959 |  3620453.76
 mpph11   |        190 |  3559078.95
 mpph11   |       1194 |  3479709.09
 mpph11   |        416 |  3452131.59
 mpph11   |        333 |  3446486.38
 mpph11   |        377 |  3359789.30
 mpph11   |       1455 |  3342304.35
 mpph11   |        289 |  3270429.10
 mpph11   |        689 |  3260147.55
 mpph11   |       1919 |  3239067.00
 mpph11   |       1603 |  3194711.46
 mpph11   |       1438 |  3163393.12
 mpph11   |       1777 |  3107373.72
 mpph11   |         11 |  3035887.92
 mpph11   |       1340 |  3030301.09
 mpph11   |       1287 |  2985392.48
 mpph11   |       1347 |  2983078.12
 mpph11   |       1205 |  2971470.28
 mpph11   |        285 |  2967973.75
 mpph11   |        357 |  2967100.97
 mpph11   |        429 |  2962631.88
 mpph11   |         91 |  2951493.40
 mpph11   |       1161 |  2928475.76
 mpph11   |        914 |  2927894.16
 mpph11   |       1962 |  2925555.12
 mpph11   |       1483 |  2918425.86
 mpph11   |        561 |  2904720.39
 mpph11   |        258 |  2895651.20
 mpph11   |        194 |  2840047.13
 mpph11   |       1671 |  2818290.28
 mpph11   |       1477 |  2777362.76
 mpph11   |       1505 |  2766157.98
 mpph11   |        332 |  2741984.16
 mpph11   |        301 |  2737431.90
 mpph11   |        729 |  2706503.68
 mpph11   |        654 |  2662180.27
 mpph11   |        142 |  2647051.80
 mpph11   |        164 |  2643604.15
 mpph11   |       1662 |  2642551.92
 mpph11   |       1554 |  2639338.38
 mpph11   |        280 |  2631317.56
 mpph11   |       1541 |  2603175.96
 mpph11   |       1610 |  2463001.95
 mpph11   |        407 |  2460304.47
 mpph11   |        199 |  2442107.46
 mpph11   |        534 |  2420752.38
 mpph11   |       1313 |  2408870.75
 mpph11   |       1759 |  2387379.32
 mpph11   |       1115 |  2321227.26
 mpph11   |       1251 |  2311454.53
 mpph11   |       1285 |  2260852.77
 mpph11   |        159 |  2256004.65
 mpph11   |       1973 |  2243745.69
 mpph11   |       1638 |  2232762.96
 mpph11   |       1774 |  2217104.85
 mpph11   |        556 |  2195013.90
 mpph11   |       1694 |  2163305.16
 mpph11   |        819 |  2152055.50
 mpph11   |        992 |  2121582.28
 mpph11   |        785 |  2121133.75
 mpph11   |       1985 |  2069183.28
 mpph11   |        794 |  2059945.54
 mpph11   |        498 |  2055444.32
 mpph11   |       1385 |  2051890.11
 mpph11   |       1916 |  2032768.96
 mpph11   |        361 |  2017055.81
 mpph11   |         76 |  2012711.58
 mpph11   |       1873 |  2000792.40
 mpph11   |         94 |  1986087.48
 mpph11   |       1651 |  1980440.40
 mpph11   |       1059 |  1959087.04
 mpph11   |       1122 |  1942108.90
 mpph11   |        261 |  1928153.10
 mpph11   |       1861 |  1928114.84
 mpph11   |        461 |  1877992.32
 mpph11   |        224 |  1863852.24
 mpph11   |       1242 |  1851493.60
 mpph11   |       1634 |  1743866.22
 mpph11   |        761 |  1741958.65
 mpph11   |       1080 |  1741751.34
 mpph11   |        338 |  1724805.12
 mpph11   |        661 |  1709946.82
 mpph11   |        388 |  1696006.86
 mpph11   |        231 |  1655972.00
 mpph11   |        525 |  1633729.79
 mpph11   |       1906 |  1626282.30
 mpph11   |         85 |  1599847.56
 mpph11   |         60 |  1579401.77
 mpph11   |        926 |  1570368.78
 mpph11   |       1511 |  1569870.02
 mpph11   |       1113 |  1516263.20
 mpph11   |       1089 |  1477486.65
 mpph11   |       1422 |  1435904.00
 mpph11   |        458 |  1433040.45
 mpph11   |       1907 |  1421100.55
 mpph11   |        323 |  1419854.80
 mpph11   |        851 |  1400193.30
 mpph11   |         44 |  1353557.34
 mpph11   |        595 |  1350125.70
 mpph11   |       1822 |  1337990.67
 mpph11   |          1 |  1333528.04
 mpph11   |       1710 |  1331788.48
 mpph11   |         61 |  1322305.60
 mpph11   |        798 |  1313571.96
 mpph11   |        784 |  1309867.02
 mpph11   |        651 |  1307083.56
 mpph11   |       1468 |  1302397.20
 mpph11   |       1149 |  1289607.35
 mpph11   |       1179 |  1242058.40
 mpph11   |        818 |  1225981.68
 mpph11   |       1189 |  1204828.08
 mpph11   |        797 |  1181263.32
 mpph11   |       1375 |  1178128.60
 mpph11   |       1015 |  1164198.48
 mpph11   |       1994 |  1149222.96
 mpph11   |         66 |  1148101.44
 mpph11   |       1929 |  1131697.92
 mpph11   |        240 |  1126682.48
 mpph11   |       1378 |  1121941.05
 mpph11   |        762 |  1109467.26
 mpph11   |        586 |  1108200.58
 mpph11   |        716 |  1107627.42
 mpph11   |        752 |  1102384.63
 mpph11   |       1220 |  1083540.00
 mpph11   |       1675 |  1064600.76
 mpph11   |       1380 |  1020105.06
 mpph11   |        204 |  1014095.32
 mpph11   |       1214 |  1013602.86
 mpph11   |       1186 |  1006354.08
 mpph11   |        927 |  1003227.51
 mpph11   |       1473 |   997508.48
 mpph11   |       1701 |   994231.40
 mpph11   |        168 |   988803.90
 mpph11   |        852 |   977609.14
 mpph11   |        235 |   977200.14
 mpph11   |        501 |   961161.66
 mpph11   |       1620 |   950561.25
 mpph11   |       1709 |   927244.00
 mpph11   |       1565 |   921078.22
 mpph11   |        960 |   913060.80
 mpph11   |        385 |   910892.90
 mpph11   |       1434 |   905713.25
 mpph11   |        658 |   894649.92
 mpph11   |       1865 |   886024.01
 mpph11   |        487 |   883607.88
 mpph11   |       1279 |   877210.28
 mpph11   |       1211 |   875261.76
 mpph11   |        555 |   869246.77
 mpph11   |       1521 |   866284.81
 mpph11   |        427 |   839771.02
 mpph11   |       1628 |   832363.52
 mpph11   |        297 |   832286.88
 mpph11   |       1051 |   824164.90
 mpph11   |        185 |   794405.50
 mpph11   |       1412 |   793718.80
 mpph11   |        432 |   782403.82
 mpph11   |        216 |   776184.13
 mpph11   |       1056 |   772092.44
 mpph11   |        494 |   768524.43
 mpph11   |       1446 |   746482.32
 mpph11   |       1661 |   733795.56
 mpph11   |       1274 |   711073.48
 mpph11   |        451 |   676703.28
 mpph11   |       1685 |   661635.90
 mpph11   |       1143 |   660014.26
 mpph11   |       1318 |   655995.66
 mpph11   |       1531 |   649589.40
 mpph11   |       1514 |   627482.08
 mpph11   |       1612 |   626730.56
 mpph11   |        948 |   622068.66
 mpph11   |        571 |   619871.04
 mpph11   |       1767 |   614422.00
 mpph11   |        351 |   601983.45
 mpph11   |       1499 |   594599.22
 mpph11   |       1941 |   594211.48
 mpph11   |       1153 |   584114.56
 mpph11   |       1257 |   580110.85
 mpph11   |       1461 |   576845.88
 mpph11   |       1361 |   570409.02
 mpph11   |       1250 |   567963.36
 mpph11   |        422 |   530847.10
 mpph11   |       1653 |   525077.35
 mpph11   |       1669 |   513932.46
 mpph11   |       1596 |   505225.82
 mpph11   |        850 |   483358.05
 mpph11   |       1151 |   481433.04
 mpph11   |         86 |   471697.70
 mpph11   |        894 |   465151.80
 mpph11   |         19 |   464872.80
 mpph11   |        474 |   455889.28
 mpph11   |        493 |   455628.44
 mpph11   |        267 |   453340.80
 mpph11   |       1856 |   450086.28
 mpph11   |       1830 |   446553.54
 mpph11   |        456 |   439968.00
 mpph11   |        305 |   421891.68
 mpph11   |       1594 |   417994.09
 mpph11   |       1894 |   414577.35
 mpph11   |       1240 |   413718.76
 mpph11   |         35 |   398837.24
 mpph11   |       1180 |   391898.15
 mpph11   |       1794 |   355474.42
 mpph11   |       1024 |   319659.12
 mpph11   |        594 |   315583.24
 mpph11   |         10 |   314550.82
 mpph11   |       1953 |   314372.14
 mpph11   |       1261 |   312283.65
 mpph11   |       1832 |   308459.25
 mpph11   |       1785 |   300945.33
 mpph11   |        138 |   298832.01
 mpph11   |        753 |   297884.88
 mpph11   |       1790 |   277454.80
 mpph11   |        133 |   262568.64
 mpph11   |         51 |   260089.38
 mpph11   |        620 |   246511.60
 mpph11   |       1961 |   232870.27
 mpph11   |       1224 |   227429.47
 mpph11   |        183 |   225827.28
 mpph11   |       1735 |   219074.20
 mpph11   |       1816 |   218339.50
 mpph11   |       1743 |   217085.97
 mpph11   |        985 |   182239.20
 mpph11   |       1761 |   182100.00
 mpph11   |        464 |   179639.88
 mpph11   |        817 |   170795.52
 mpph11   |        485 |   170664.12
 mpph11   |       1818 |   161250.35
 mpph11   |        630 |   158427.72
 mpph11   |       1571 |   156406.05
 mpph11   |       1094 |   155577.60
 mpph11   |        436 |   147283.92
 mpph11   |        916 |   146788.80
 mpph11   |        310 |   145905.18
 mpph11   |       1751 |   140193.69
 mpph11   |        993 |   136907.25
 mpph11   |       1050 |   136152.30
 mpph11   |       1394 |   120166.11
 mpph11   |       1177 |   115967.72
 mpph11   |        151 |   110222.90
(357 rows)

select  'mpph12',
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('RAIL', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1993-01-01'
	and l_receiptdate < date '1993-01-01' + interval '1 year'
group by
	l_shipmode
order by
	l_shipmode;
 ?column? | l_shipmode | high_line_count | low_line_count 
----------+------------+-----------------+----------------
 mpph12   | MAIL       |              41 |             99
 mpph12   | RAIL       |              54 |            102
(2 rows)

select  'mpph13',
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%express%deposits%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;
 ?column? | c_count | custdist 
----------+---------+----------
 mpph13   |       0 |      500
 mpph13   |      11 |       66
 mpph13   |      10 |       64
 mpph13   |       8 |       63
 mpph13   |      12 |       61
 mpph13   |       9 |       60
 mpph13   |      20 |       58
 mpph13   |      13 |       58
 mpph13   |      14 |       53
 mpph13   |      15 |       48
 mpph13   |       7 |       47
 mpph13   |      18 |       43
 mpph13   |      17 |       40
 mpph13   |      21 |       38
 mpph13   |      16 |       38
 mpph13   |      19 |       36
 mpph13   |       6 |       35
 mpph13   |      22 |       34
 mpph13   |      24 |       32
 mpph13   |      23 |       30
 mpph13   |      25 |       22
 mpph13   |      26 |       19
 mpph13   |       5 |       13
 mpph13   |      27 |       10
 mpph13   |      28 |        9
 mpph13   |       4 |        7
 mpph13   |      32 |        4
 mpph13   |      30 |        4
 mpph13   |      29 |        3
 mpph13   |       3 |        2
 mpph13   |       2 |        2
 mpph13   |      31 |        1
(32 rows)

select  'mpph14',
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1993-01-01'
	and l_shipdate < date '1993-01-01' + interval '1 month';
 ?column? |    promo_revenue    
----------+---------------------
 mpph14   | 11.5452471385458443
(1 row)

create view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= date '1993-01-01'
		and l_shipdate < date '1993-01-01' + interval '3 month'
	group by
		l_suppkey;
select  'mpph15',
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;
 ?column? | s_suppkey |          s_name           |          s_address          |     s_phone     | total_revenue 
----------+-----------+---------------------------+-----------------------------+-----------------+---------------
 mpph15   |        84 | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx | 34-869-118-7803 |  1134618.0543
(1 row)

drop view revenue0;
select 'mpph16',
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	part, 
	partsupp left join supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
 ?column? |  p_brand   |          p_type           | p_size | supplier_cnt 
----------+------------+---------------------------+--------+--------------
 mpph16   | Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 mpph16   | Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 mpph16   | Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 mpph16   | Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 mpph16   | Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 mpph16   | Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 mpph16   | Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 mpph16   | Brand#11   | SMALL PLATED COPPER       |     46 |            4
 mpph16   | Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 mpph16   | Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 mpph16   | Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 mpph16   | Brand#11   | STANDARD PLATED TIN       |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 mpph16   | Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 mpph16   | Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 mpph16   | Brand#12   | LARGE PLATED COPPER       |     46 |            4
 mpph16   | Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 mpph16   | Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 mpph16   | Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 mpph16   | Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 mpph16   | Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 mpph16   | Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 mpph16   | Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 mpph16   | Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 mpph16   | Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 mpph16   | Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 mpph16   | Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 mpph16   | Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 mpph16   | Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 mpph16   | Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 mpph16   | Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 mpph16   | Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 mpph16   | Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 mpph16   | Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 mpph16   | Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 mpph16   | Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 mpph16   | Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 mpph16   | Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 mpph16   | Brand#15   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 mpph16   | Brand#15   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 mpph16   | Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 mpph16   | Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 mpph16   | Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 mpph16   | Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 mpph16   | Brand#21   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 mpph16   | Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 mpph16   | Brand#21   | PROMO PLATED COPPER       |     20 |            4
 mpph16   | Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 mpph16   | Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 mpph16   | Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 mpph16   | Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 mpph16   | Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 mpph16   | Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 mpph16   | Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 mpph16   | Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 mpph16   | Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 mpph16   | Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 mpph16   | Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 mpph16   | Brand#23   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 mpph16   | Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 mpph16   | Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 mpph16   | Brand#23   | SMALL PLATED TIN          |     42 |            4
 mpph16   | Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 mpph16   | Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 mpph16   | Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 mpph16   | Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 mpph16   | Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 mpph16   | Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 mpph16   | Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 mpph16   | Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 mpph16   | Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 mpph16   | Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 mpph16   | Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 mpph16   | Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 mpph16   | Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 mpph16   | Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 mpph16   | Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 mpph16   | Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 mpph16   | Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 mpph16   | Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 mpph16   | Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 mpph16   | Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 mpph16   | Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 mpph16   | Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 mpph16   | Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 mpph16   | Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 mpph16   | Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#32   | SMALL PLATED BRASS        |     31 |            4
 mpph16   | Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 mpph16   | Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 mpph16   | Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 mpph16   | Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 mpph16   | Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 mpph16   | Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 mpph16   | Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 mpph16   | Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 mpph16   | Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 mpph16   | Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 mpph16   | Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 mpph16   | Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 mpph16   | Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 mpph16   | Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 mpph16   | Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 mpph16   | Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 mpph16   | Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 mpph16   | Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 mpph16   | Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 mpph16   | Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 mpph16   | Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 mpph16   | Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 mpph16   | Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 mpph16   | Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#42   | PROMO POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     24 |            4
 mpph16   | Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 mpph16   | Brand#43   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#43   | LARGE PLATED TIN          |     24 |            4
 mpph16   | Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 mpph16   | Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 mpph16   | Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 mpph16   | Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 mpph16   | Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 mpph16   | Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 mpph16   | Brand#45   | LARGE PLATED STEEL        |     22 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#45   | SMALL PLATED COPPER       |     15 |            4
 mpph16   | Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 mpph16   | Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 mpph16   | Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 mpph16   | Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 mpph16   | Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 mpph16   | Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 mpph16   | Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 mpph16   | Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 mpph16   | Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 mpph16   | Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 mpph16   | Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 mpph16   | Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 mpph16   | Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 mpph16   | Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 mpph16   | Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#52   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 mpph16   | Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 mpph16   | Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 mpph16   | Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 mpph16   | Brand#53   | SMALL PLATED STEEL        |     31 |            4
 mpph16   | Brand#53   | SMALL POLISHED TIN        |     42 |            4
 mpph16   | Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 mpph16   | Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 mpph16   | Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 mpph16   | Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 mpph16   | Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 mpph16   | Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 mpph16   | Brand#54   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 mpph16   | Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 mpph16   | Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 mpph16   | Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 mpph16   | Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 mpph16   | Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 mpph16   | Brand#55   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 mpph16   | Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 mpph16   | Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 mpph16   | Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;select 'mpph17',
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

      sum(l_extendedprice) / 7.0 as avg_yearly
from
      lineitem,
      (
          select
              p_partkey as x_partkey,
              0.2 * avg(l_quantity) as x_avg_20
          from
              part,
              lineitem
          where
              p_partkey = l_partkey
              and p_brand = 'Brand#32'
              and p_container = 'JUMBO PACK'
          group by
              p_partkey
      ) x
where
      x_partkey = l_partkey
and l_quantity < x_avg_20;
 ?column? |      avg_yearly       
----------+-----------------------
 mpph17   | 1278.3700000000000000
(1 row)

select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#32'
	and p_container = 'JUMBO PACK'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);
      avg_yearly       
-----------------------
 1278.3700000000000000
(1 row)

select  'mpph18',
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
 ?column? |       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice |  sum   
----------+--------------------+-----------+------------+-------------+--------------+--------
 mpph18   | Customer#000000667 |       667 |      29158 | 10-21-1995  |    439687.23 | 305.00
 mpph18   | Customer#000000178 |       178 |       6882 | 04-09-1997  |    422359.65 | 303.00
(2 rows)

select  'mpph19',
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#53'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);select  'mpph20',
 ?column? |  revenue   
----------+------------
 mpph19   | 10604.0448
(1 row)

	s_name,
	s_address 
from 
	supplier, 
	nation 
where 
	s_suppkey in( 
		select 
			ps_suppkey 
		from 
			partsupp, 
			( 
				select 
					sum(l_quantity) as qty_sum, l_partkey, l_suppkey 
				from 
					lineitem 
				where 
					l_shipdate >= date '1996-01-01' 
					and l_shipdate < date '1996-01-01' + interval '1 year' 
				group by l_partkey, l_suppkey ) g 
		where 
			g.l_partkey = ps_partkey 
			and g.l_suppkey = ps_suppkey 
			and ps_availqty > 0.5 * g.qty_sum 
			and ps_partkey in ( select p_partkey from part where p_name like 'medium%' ) 
		) 
	and s_nationkey = n_nationkey 
	and n_name = 'UNITED STATES'
order by 
	s_name;
 ?column? |          s_name           |                s_address                 
----------+---------------------------+------------------------------------------
 mpph20   | Supplier#000000010        | Saygah3gYWMp72i PY
 mpph20   | Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 mpph20   | Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 mpph20   | Supplier#000000049        | Nvq 6macF4GtJvz
 mpph20   | Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 mpph20   | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					part
				where
					p_name like 'medium%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= date '1996-01-01'
					and l_shipdate < date '1996-01-01' + interval '1 year'
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
order by
	s_name;select  'mpph21',
          s_name           |                s_address                 
---------------------------+------------------------------------------
 Supplier#000000010        | Saygah3gYWMp72i PY
 Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 Supplier#000000049        | Nvq 6macF4GtJvz
 Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

	s_name, 
	count(distinct(l1.l_orderkey::text||l1.l_linenumber::text)) as numwait 
from 
	supplier, 
	orders, 
	nation, 
	lineitem l1 
		left join lineitem l2 
			on (l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) 
		left join (
			select 
				l3.l_orderkey,
				l3.l_suppkey 
			from 
				lineitem l3 
			where 
				l3.l_receiptdate > l3.l_commitdate) l4 
			on (l4.l_orderkey = l1.l_orderkey and l4.l_suppkey <> l1.l_suppkey) 
where 
	s_suppkey = l1.l_suppkey 
	and o_orderkey = l1.l_orderkey 
	and o_orderstatus = 'F' 
	and l1.l_receiptdate > l1.l_commitdate 
	and l2.l_orderkey is not null 
	and l4.l_orderkey is null 
	and s_nationkey = n_nationkey 
	and n_name = 'MOZAMBIQUE' 
group by 
	s_name 
order by 
	numwait desc, 
	s_name
LIMIT 100;
 ?column? |          s_name           | numwait 
----------+---------------------------+---------
 mpph21   | Supplier#000000056        |      18
 mpph21   | Supplier#000000073        |      13
 mpph21   | Supplier#000000018        |      12
 mpph21   | Supplier#000000058        |      10
 mpph21   | Supplier#000000030        |       9
 mpph21   | Supplier#000000093        |       9
 mpph21   | Supplier#000000031        |       6
(7 rows)

select  'mpph22',
	cntrycode, 
	count(*) as numcust, 
	sum(c_acctbal) as totacctbal 
from 
	( 
		select 
			substring(c_phone from 1 for 2) as cntrycode, 
			c_acctbal 
		from 
			customer left join orders 
				on c_custkey = o_custkey 
		where 
			substring(c_phone from 1 for 2) in 
				('11', '28', '21', '26', '19', '13', '22') 
			and c_acctbal > ( 
				select 
					avg(c_acctbal) 
				from 
					customer 
				where 
					c_acctbal > 0.00 
					and substring(c_phone from 1 for 2) in 
						('11', '28', '21', '26', '19', '13', '22') 
			) 
			and o_custkey is null 
	) as custsale 
group by 
	cntrycode 
order by 
	cntrycode;
 ?column? | cntrycode | numcust | totacctbal 
----------+-----------+---------+------------
 mpph22   | 11        |      11 |   82845.34
 mpph22   | 13        |      10 |   75359.29
 mpph22   | 19        |      17 |  132118.07
 mpph22   | 21        |       9 |   73087.05
 mpph22   | 22        |       9 |   65544.55
 mpph22   | 26        |       6 |   47747.11
 mpph22   | 28        |      10 |   79310.33
(7 rows)

select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('11', '28', '21', '26', '19', '13', '22')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('11', '28', '21', '26', '19', '13', '22')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;
 cntrycode | numcust | totacctbal 
-----------+---------+------------
 11        |      11 |   82845.34
 13        |      10 |   75359.29
 19        |      17 |  132118.07
 21        |       9 |   73087.05
 22        |       9 |   65544.55
 26        |       6 |   47747.11
 28        |      10 |   79310.33
(7 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	part, 
	partsupp left join supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

\c mpph_ao
select 'mpph00-1',count(*), sum(n_nationkey), min(n_nationkey), max(n_nationkey) from nation;
 ?column? | count | sum | min | max 
----------+-------+-----+-----+-----
 mpph00-1 |    25 | 300 |   0 |  24
(1 row)

select 'mpph00-2',count(*), sum(r_regionkey), min(r_regionkey), max(r_regionkey) from region;
 ?column? | count | sum | min | max 
----------+-------+-----+-----+-----
 mpph00-2 |     5 |  10 |   0 |   4
(1 row)

select 'mpph00-3',count(*), sum(p_partkey), min(p_partkey), max(p_partkey) from part;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-3 |  2000 | 2001000 |   1 | 2000
(1 row)

select 'mpph00-4',count(*), sum(s_suppkey), min(s_suppkey), max(s_suppkey) from supplier;
 ?column? | count | sum  | min | max 
----------+-------+------+-----+-----
 mpph00-4 |   100 | 5050 |   1 | 100
(1 row)

select 'mpph00-5',count(*), sum(ps_partkey + ps_suppkey), min(ps_partkey + ps_suppkey), max(ps_partkey + ps_suppkey) from partsupp;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-5 |  8000 | 8408000 |   3 | 2099
(1 row)

select 'mpph00-6',count(*), sum(c_custkey), min(c_custkey), max(c_custkey) from customer;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-6 |  1500 | 1125750 |   1 | 1500
(1 row)

select 'mpph00-7',count(*), sum(o_orderkey), min(o_orderkey), max(o_orderkey) from orders;
 ?column? | count |    sum    | min |  max  
----------+-------+-----------+-----+-------
 mpph00-7 | 15000 | 449872500 |   1 | 60000
(1 row)

select 'mpph00-8',count(*), sum(l_linenumber), min(l_linenumber), max(l_linenumber) from lineitem;
 ?column? | count |  sum   | min | max 
----------+-------+--------+-----+-----
 mpph00-8 | 60175 | 180782 |   1 |   7
(1 row)

select  'mpph1',
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '108 day'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
 ?column? | l_returnflag | l_linestatus |  sum_qty  | sum_base_price | sum_disc_price |    sum_charge     |       avg_qty       |     avg_price      |        avg_disc        | count_order 
----------+--------------+--------------+-----------+----------------+----------------+-------------------+---------------------+--------------------+------------------------+-------------
 mpph1    | A            | F            | 380456.00 |   532348211.65 | 505822441.4861 |  526165934.000839 | 25.5751546114546921 | 35785.709306937349 | 0.05008133906964237698 |       14876
 mpph1    | N            | F            |   8971.00 |    12384801.37 |  11798257.2080 |   12282485.056933 | 25.7787356321839080 | 35588.509683908046 | 0.04775862068965517241 |         348
 mpph1    | N            | O            | 733323.00 |  1028186527.78 | 977118238.4241 | 1016280268.835844 | 25.4466999791796794 | 35678.621964744257 | 0.04991255465334166146 |       28818
 mpph1    | R            | F            | 381449.00 |   534594445.35 | 507996454.4067 |  528524219.358903 | 25.5971681653469333 | 35874.006532680177 | 0.04982753992752650651 |       14902
(4 rows)

select  'mpph2',
	s.s_acctbal,
	s.s_name,
	n.n_name,
	p.p_partkey,
	p.p_mfgr,
	s.s_address,
	s.s_phone,
	s.s_comment 
from 
	supplier s, 
	partsupp ps, 
	nation n, 
	region r, 
	part p, 
	(select p_partkey, min(ps_supplycost) as min_ps_cost 
		from 
			part, 
			partsupp , 	
			supplier,
			nation, 
			region 
		where 
			p_partkey=ps_partkey 
			and s_suppkey = ps_suppkey 
			and s_nationkey = n_nationkey 
			and n_regionkey = r_regionkey 
			and r_name = 'EUROPE' 
		group by p_partkey ) g 
where 
	p.p_partkey = ps.ps_partkey 
	and g.p_partkey = p.p_partkey 
	and g. min_ps_cost = ps.ps_supplycost 
	and s.s_suppkey = ps.ps_suppkey 
	and p.p_size = 45 
	and p.p_type like '%NICKEL' 
	and s.s_nationkey = n.n_nationkey 
	and n.n_regionkey = r.r_regionkey 
	and r.r_name = 'EUROPE' 
order by 
	s.s_acctbal desc,
	n.n_name,
	s.s_name,
	p.p_partkey
LIMIT 100;
 ?column? | s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
----------+-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
 mpph2    |   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
 mpph2    |   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
 mpph2    |   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 45
	and p_type like '%NICKEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
 s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select  'mpph3',
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'MACHINERY'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-15'
	and l_shipdate > date '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
 ?column? | l_orderkey |   revenue   | o_orderdate | o_shippriority 
----------+------------+-------------+-------------+----------------
 mpph3    |      12641 | 222127.6271 | 02-23-1995  |              0
 mpph3    |      39878 | 219714.3069 | 03-06-1995  |              0
 mpph3    |      34243 | 214308.7196 | 02-12-1995  |              0
 mpph3    |       7171 | 202398.1900 | 02-14-1995  |              0
 mpph3    |      55271 | 195237.8000 | 03-12-1995  |              0
 mpph3    |      50145 | 189500.1602 | 02-27-1995  |              0
 mpph3    |      12867 | 185769.1004 | 03-12-1995  |              0
 mpph3    |      12066 | 180776.3231 | 02-07-1995  |              0
 mpph3    |      41926 | 180459.9518 | 02-06-1995  |              0
 mpph3    |      46307 | 180383.2464 | 02-07-1995  |              0
(10 rows)

select  'mpph4',
        o_orderpriority,
        count(*) as order_count
from
        orders
where
        o_orderdate >= date '1994-05-01'
        and o_orderdate < date '1994-05-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
 ?column? | o_orderpriority | order_count 
----------+-----------------+-------------
 mpph4    | 1-URGENT        |         108
 mpph4    | 2-HIGH          |         117
 mpph4    | 3-MEDIUM        |          95
 mpph4    | 4-NOT SPECIFIED |         111
 mpph4    | 5-LOW           |         116
(5 rows)

select  'mpph5',
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '1 year'
group by
	n_name
order by
	revenue desc;
 ?column? |          n_name           |   revenue   
----------+---------------------------+-------------
 mpph5    | UNITED STATES             | 721432.9139
 mpph5    | CANADA                    | 451731.0802
 mpph5    | PERU                      | 317553.7203
 mpph5    | BRAZIL                    | 275951.7747
 mpph5    | ARGENTINA                 | 225713.4702
(5 rows)

select  'mpph6',
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= date '1996-01-01'
	and l_shipdate < date '1996-01-01' + interval '1 year'
	and l_discount between 0.04 - 0.01 and 0.04 + 0.01
	and l_quantity < 24;
 ?column? |   revenue   
----------+-------------
 mpph6    | 740117.7050
(1 row)

select  'mpph7',
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'MOZAMBIQUE')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
 ?column? |        supp_nation        |        cust_nation        | l_year |   revenue    
----------+---------------------------+---------------------------+--------+--------------
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1995 |  749611.6213
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1996 |  838743.2524
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1995 |  669933.3036
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1996 | 1084686.2375
(4 rows)

select  'mpph8',
	o_year,
	sum(case
		when nation = 'PERU' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'MEDIUM POLISHED TIN'
	) as all_nations
group by
	o_year
order by
	o_year;
 ?column? | o_year |         mkt_share          
----------+--------+----------------------------
 mpph8    |   1995 | 0.000000000000000000000000
 mpph8    |   1996 |     0.17380660267693394854
(2 rows)

select  'mpph9',
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%tan%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
 ?column? |          nation           | o_year | sum_profit  
----------+---------------------------+--------+-------------
 mpph9    | ALGERIA                   |   1998 | 203717.6183
 mpph9    | ALGERIA                   |   1997 | 277895.7940
 mpph9    | ALGERIA                   |   1996 | 285313.9627
 mpph9    | ALGERIA                   |   1995 | 309375.7934
 mpph9    | ALGERIA                   |   1994 | 288152.6449
 mpph9    | ALGERIA                   |   1993 | 321222.9401
 mpph9    | ALGERIA                   |   1992 | 436020.6807
 mpph9    | ARGENTINA                 |   1998 | 217919.0097
 mpph9    | ARGENTINA                 |   1997 |  47720.1989
 mpph9    | ARGENTINA                 |   1996 | 373086.6814
 mpph9    | ARGENTINA                 |   1995 | 256403.9057
 mpph9    | ARGENTINA                 |   1994 | 172411.8182
 mpph9    | ARGENTINA                 |   1993 | 414051.7103
 mpph9    | ARGENTINA                 |   1992 | 497745.7196
 mpph9    | BRAZIL                    |   1998 |   9402.1360
 mpph9    | BRAZIL                    |   1996 | 130680.4872
 mpph9    | BRAZIL                    |   1995 |  47629.8480
 mpph9    | BRAZIL                    |   1994 |  22440.1440
 mpph9    | BRAZIL                    |   1993 | 106237.4759
 mpph9    | BRAZIL                    |   1992 | 116994.4770
 mpph9    | CANADA                    |   1998 |  67660.5389
 mpph9    | CANADA                    |   1997 | 167179.5520
 mpph9    | CANADA                    |   1996 | 147802.3006
 mpph9    | CANADA                    |   1995 |  84817.9292
 mpph9    | CANADA                    |   1994 |  49027.1082
 mpph9    | CANADA                    |   1993 | 157886.0056
 mpph9    | CANADA                    |   1992 | 191231.3590
 mpph9    | CHINA                     |   1998 | 382876.9927
 mpph9    | CHINA                     |   1997 | 787527.2369
 mpph9    | CHINA                     |   1996 | 605901.5293
 mpph9    | CHINA                     |   1995 | 587705.6412
 mpph9    | CHINA                     |   1994 | 917527.5948
 mpph9    | CHINA                     |   1993 | 839365.4133
 mpph9    | CHINA                     |   1992 | 748324.7469
 mpph9    | EGYPT                     |   1998 | 220523.2078
 mpph9    | EGYPT                     |   1997 | 554962.2792
 mpph9    | EGYPT                     |   1996 | 526118.5876
 mpph9    | EGYPT                     |   1995 | 406448.9115
 mpph9    | EGYPT                     |   1994 | 404925.7193
 mpph9    | EGYPT                     |   1993 | 296691.1725
 mpph9    | EGYPT                     |   1992 | 449161.6055
 mpph9    | ETHIOPIA                  |   1998 | 178828.6942
 mpph9    | ETHIOPIA                  |   1997 | 322949.1543
 mpph9    | ETHIOPIA                  |   1996 | 179589.0062
 mpph9    | ETHIOPIA                  |   1995 | 215017.5362
 mpph9    | ETHIOPIA                  |   1994 | 509710.4645
 mpph9    | ETHIOPIA                  |   1993 | 251330.1758
 mpph9    | ETHIOPIA                  |   1992 | 225397.2384
 mpph9    | FRANCE                    |   1998 | 210901.9632
 mpph9    | FRANCE                    |   1997 | 234428.9324
 mpph9    | FRANCE                    |   1996 | 283026.6644
 mpph9    | FRANCE                    |   1995 | 428615.5897
 mpph9    | FRANCE                    |   1994 | 233410.4344
 mpph9    | FRANCE                    |   1993 | 420330.4447
 mpph9    | FRANCE                    |   1992 | 359496.0042
 mpph9    | GERMANY                   |   1998 | 229863.3768
 mpph9    | GERMANY                   |   1997 | 519160.2856
 mpph9    | GERMANY                   |   1996 | 533764.1221
 mpph9    | GERMANY                   |   1995 | 621744.7373
 mpph9    | GERMANY                   |   1994 | 340785.3795
 mpph9    | GERMANY                   |   1993 | 673651.1393
 mpph9    | GERMANY                   |   1992 | 524002.5977
 mpph9    | INDIA                     |   1998 | 334403.8655
 mpph9    | INDIA                     |   1997 | 156434.8865
 mpph9    | INDIA                     |   1996 | 265093.2063
 mpph9    | INDIA                     |   1995 | 137842.0462
 mpph9    | INDIA                     |   1994 | 262710.5074
 mpph9    | INDIA                     |   1993 | 328441.1285
 mpph9    | INDIA                     |   1992 | 199589.6727
 mpph9    | INDONESIA                 |   1998 | 155973.1013
 mpph9    | INDONESIA                 |   1997 | 316792.0784
 mpph9    | INDONESIA                 |   1996 | 422245.5263
 mpph9    | INDONESIA                 |   1995 | 235242.8814
 mpph9    | INDONESIA                 |   1994 | 326775.3396
 mpph9    | INDONESIA                 |   1993 | 327711.7699
 mpph9    | INDONESIA                 |   1992 | 243688.5923
 mpph9    | IRAN                      |   1998 |  27198.8568
 mpph9    | IRAN                      |   1997 | 174737.8001
 mpph9    | IRAN                      |   1996 |  50121.8822
 mpph9    | IRAN                      |   1995 |  70977.8022
 mpph9    | IRAN                      |   1994 | 104593.0442
 mpph9    | IRAN                      |   1993 |  25867.0544
 mpph9    | IRAN                      |   1992 |  82988.9337
 mpph9    | IRAQ                      |   1998 | 157348.1240
 mpph9    | IRAQ                      |   1997 | 227619.0410
 mpph9    | IRAQ                      |   1996 | 114431.2136
 mpph9    | IRAQ                      |   1995 |  83702.7028
 mpph9    | IRAQ                      |   1994 | 189246.3076
 mpph9    | IRAQ                      |   1993 | 172977.0040
 mpph9    | IRAQ                      |   1992 | 165679.6544
 mpph9    | JAPAN                     |   1998 | 301448.7416
 mpph9    | JAPAN                     |   1997 | 274224.7673
 mpph9    | JAPAN                     |   1996 | 365055.9942
 mpph9    | JAPAN                     |   1995 | 273486.9553
 mpph9    | JAPAN                     |   1994 | 306480.9939
 mpph9    | JAPAN                     |   1993 | 309841.9310
 mpph9    | JAPAN                     |   1992 | 257133.6723
 mpph9    | JORDAN                    |   1998 |  51101.6440
 mpph9    | JORDAN                    |   1996 |   6016.6285
 mpph9    | JORDAN                    |   1995 |  58278.1892
 mpph9    | JORDAN                    |   1994 |  59604.3204
 mpph9    | JORDAN                    |   1993 | 110544.8190
 mpph9    | KENYA                     |   1998 | 239097.5320
 mpph9    | KENYA                     |   1997 | 177292.9690
 mpph9    | KENYA                     |   1996 | 597636.7126
 mpph9    | KENYA                     |   1995 | 434837.8428
 mpph9    | KENYA                     |   1994 | 511118.7047
 mpph9    | KENYA                     |   1993 | 181482.4886
 mpph9    | KENYA                     |   1992 | 442814.6201
 mpph9    | MOROCCO                   |   1998 |  94153.7562
 mpph9    | MOROCCO                   |   1997 |   1952.7200
 mpph9    | MOROCCO                   |   1996 | 184609.4769
 mpph9    | MOROCCO                   |   1995 | 138773.7720
 mpph9    | MOROCCO                   |   1994 | 141735.9952
 mpph9    | MOROCCO                   |   1993 | 240971.4009
 mpph9    | MOROCCO                   |   1992 |  76485.6974
 mpph9    | MOZAMBIQUE                |   1998 | 315271.5330
 mpph9    | MOZAMBIQUE                |   1997 | 593511.8009
 mpph9    | MOZAMBIQUE                |   1996 | 463830.0035
 mpph9    | MOZAMBIQUE                |   1995 | 463982.1278
 mpph9    | MOZAMBIQUE                |   1994 | 402790.4493
 mpph9    | MOZAMBIQUE                |   1993 | 765203.5080
 mpph9    | MOZAMBIQUE                |   1992 | 552780.7126
 mpph9    | PERU                      |   1998 | 291043.9094
 mpph9    | PERU                      |   1997 | 332386.6526
 mpph9    | PERU                      |   1996 | 271308.8627
 mpph9    | PERU                      |   1995 | 136468.6570
 mpph9    | PERU                      |   1994 | 231696.8464
 mpph9    | PERU                      |   1993 | 319175.9000
 mpph9    | PERU                      |   1992 | 296178.1348
 mpph9    | ROMANIA                   |   1998 | 366693.1531
 mpph9    | ROMANIA                   |   1997 | 313915.6675
 mpph9    | ROMANIA                   |   1996 | 257449.7931
 mpph9    | ROMANIA                   |   1995 | 613689.1994
 mpph9    | ROMANIA                   |   1994 | 514683.8323
 mpph9    | ROMANIA                   |   1993 | 301818.9752
 mpph9    | ROMANIA                   |   1992 | 445559.9618
 mpph9    | RUSSIA                    |   1998 | 215635.7552
 mpph9    | RUSSIA                    |   1997 | 263377.9773
 mpph9    | RUSSIA                    |   1996 | 292798.2473
 mpph9    | RUSSIA                    |   1995 | 202559.9044
 mpph9    | RUSSIA                    |   1994 | 287175.8782
 mpph9    | RUSSIA                    |   1993 | 163995.8157
 mpph9    | RUSSIA                    |   1992 | 356477.2999
 mpph9    | SAUDI ARABIA              |   1998 |  22338.7375
 mpph9    | SAUDI ARABIA              |   1997 |  89352.2847
 mpph9    | SAUDI ARABIA              |   1996 | 172227.1252
 mpph9    | SAUDI ARABIA              |   1995 | 104670.1059
 mpph9    | SAUDI ARABIA              |   1994 |  39327.6690
 mpph9    | SAUDI ARABIA              |   1993 |  76176.8010
 mpph9    | SAUDI ARABIA              |   1992 |  71000.2760
 mpph9    | UNITED KINGDOM            |   1998 |  57011.9084
 mpph9    | UNITED KINGDOM            |   1997 |  86313.0141
 mpph9    | UNITED KINGDOM            |   1996 |  93430.0955
 mpph9    | UNITED KINGDOM            |   1995 | 105005.8744
 mpph9    | UNITED KINGDOM            |   1994 | 111953.2358
 mpph9    | UNITED KINGDOM            |   1993 | 161721.5622
 mpph9    | UNITED KINGDOM            |   1992 | 173519.0108
 mpph9    | UNITED STATES             |   1998 | 382856.8948
 mpph9    | UNITED STATES             |   1997 | 494438.3396
 mpph9    | UNITED STATES             |   1996 | 548337.7007
 mpph9    | UNITED STATES             |   1995 | 720764.4099
 mpph9    | UNITED STATES             |   1994 | 695834.7785
 mpph9    | UNITED STATES             |   1993 | 593012.3919
 mpph9    | UNITED STATES             |   1992 | 801814.0301
 mpph9    | VIETNAM                   |   1998 | 253199.9819
 mpph9    | VIETNAM                   |   1997 | 551578.3779
 mpph9    | VIETNAM                   |   1996 | 309940.0530
 mpph9    | VIETNAM                   |   1995 | 491467.2046
 mpph9    | VIETNAM                   |   1994 | 510626.2215
 mpph9    | VIETNAM                   |   1993 | 786734.2542
 mpph9    | VIETNAM                   |   1992 | 511062.6378
(172 rows)

select  'mpph10',
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1994-10-01'
	and o_orderdate < date '1994-10-01' + interval '3 month'
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 ?column? | c_custkey |       c_name       |   revenue   | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                      c_comment                                                      
----------+-----------+--------------------+-------------+-----------+---------------------------+------------------------------------------+-----------------+---------------------------------------------------------------------------------------------------------------------
 mpph10   |       643 | Customer#000000643 | 379216.9236 |   5184.70 | ALGERIA                   | 9T 2avhfyF PQ                            | 10-978-597-2747 | fily along the quickly ironic ideas. final, final
 mpph10   |      1255 | Customer#000001255 | 348227.6139 |   6487.71 | KENYA                     | UC6I32JjBU62t4WgDe e2pDYbuM3VAt4MPM      | 24-359-633-2713 | s deposits sleep. blithely ironic dependencies wake. blithely even theodolites sleep. blithely 
 mpph10   |      1144 | Customer#000001144 | 344762.9152 |   4189.04 | ARGENTINA                 | DGLUWG9evYLNbYhOXVzqZ LdfIMVfBjDf        | 11-336-453-4489 |  ideas. even, regular excuses after the ironic requests cajole blithe
 mpph10   |       871 | Customer#000000871 | 336419.8098 |   -395.89 | SAUDI ARABIA              | KcLmBKitbx7NvU7bpu9clIyccxWG             | 30-933-714-8982 | ts. blithely silent courts doze. regular atta
 mpph10   |       421 | Customer#000000421 | 335198.8566 |   7073.17 | JORDAN                    | it3mUlkZAe9J8gmy                         | 23-918-228-2560 | lithely final deposits haggle furiously above the
 mpph10   |        61 | Customer#000000061 | 332777.6898 |   1536.24 | PERU                      | 9kndve4EAJxhg3veF BfXr7AqOsT39o gtqjaYE  | 27-626-559-8599 | egular packages shall have to impress along the 
 mpph10   |      1121 | Customer#000001121 | 320274.8995 |   3942.11 | SAUDI ARABIA              | o2uc3AHYz,m 3vYg8YxBwI0XuG               | 30-197-936-4724 | usly? final theodolites are carefully 
 mpph10   |       532 | Customer#000000532 | 296758.8028 |   1725.68 | MOROCCO                   | xwWO3lWjgVJTZwhnltyH6zj5ddkzgH8RbF       | 25-875-978-2232 | usly regular deposits kindle. quickly even depos
 mpph10   |       584 | Customer#000000584 | 286297.8180 |   8825.71 | MOROCCO                   | jebKvptmHtS9,YE1qOjl2AOw38P,8skngJZh     | 25-352-778-1041 | ages boost regular deposits. blithely stealthy depo
 mpph10   |       892 | Customer#000000892 | 284479.7745 |   4799.98 | INDONESIA                 | N KwiRAwIk6KL9WJ6vt0G                    | 19-589-784-1249 | ses are carefully. quickly regular theodolites cajole. carefully express accounts wake sly
 mpph10   |       169 | Customer#000000169 | 277234.4946 |   4483.83 | CHINA                     | NjhmHa7xrcjE                             | 28-362-499-3728 | fully unusual pinto beans. blithely express asymptotes lose carefully regular instructions? accounts b
 mpph10   |      1036 | Customer#000001036 | 270725.2873 |   1766.23 | INDIA                     | fxujgj8DOFO6oKrH                         | 18-791-577-7691 | ins sleep. slyly express platelets cajol
 mpph10   |       608 | Customer#000000608 | 268304.6758 |   2256.36 | MOZAMBIQUE                | luMI1JpfrrILCEeTgz8k98z                  | 26-767-193-8671 | ld packages. special requests along the accounts are after the carefully unusual deposits. blithely quiet excuses c
 mpph10   |       635 | Customer#000000635 | 261889.3542 |   8216.79 | BRAZIL                    | Ftqi0UYvzz56Ov,J6,ySp5WE4vJ2rtY          | 12-399-186-7550 | efully bold deposits doubt above the clos
 mpph10   |      1279 | Customer#000001279 | 261726.8460 |   7915.06 | KENYA                     | fkrzLacsqCnwUwgjjttKmY                   | 24-742-587-6985 | tes are. ideas above the carefully ironic d
 mpph10   |      1483 | Customer#000001483 | 256807.2933 |   4409.70 | GERMANY                   | ZjY1C b6cOnY3                            | 17-202-113-4814 | nts sleep around the carefully express theodolites. requests nag 
 mpph10   |        71 | Customer#000000071 | 251773.7061 |   -611.19 | GERMANY                   | TlGalgdXWBmMV,6agLyWYDyIz9MKzcY8gl,w6t1B | 17-710-812-5403 | g courts across the regular, final pinto beans are blithely pending ac
 mpph10   |       664 | Customer#000000664 | 244482.6132 |   8878.22 | MOROCCO                   | viRe1P6HiyL4LXpU7HPwu                    | 25-329-655-5068 | yly ironic requests cajole pending pla
 mpph10   |       883 | Customer#000000883 | 238622.1581 |    479.96 | CANADA                    | qVQ8rWNU5KZYDcS                          | 13-526-239-6950 | uctions are carefully across the regular, regular asymptote
 mpph10   |      1288 | Customer#000001288 | 236676.5999 |   6603.43 | CANADA                    | wQDTTCkSGxic2d66                         | 13-533-256-9320 | equests detect atop the ironic deposits. final requests according to the blithely sp
(20 rows)

select  'mpph11',
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ROMANIA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ROMANIA'
		)
order by
	value desc;
 ?column? | ps_partkey |    value    
----------+------------+-------------
 mpph11   |        917 | 12344895.22
 mpph11   |        685 | 11950940.60
 mpph11   |       1081 | 10580686.59
 mpph11   |       1011 |  9608892.80
 mpph11   |        623 |  9343081.80
 mpph11   |        787 |  8569925.48
 mpph11   |       1185 |  8073895.00
 mpph11   |        367 |  7883443.69
 mpph11   |        109 |  7657641.60
 mpph11   |       1451 |  7613526.60
 mpph11   |       1899 |  7550881.80
 mpph11   |       1842 |  7505106.20
 mpph11   |        213 |  7479470.28
 mpph11   |        161 |  7398630.95
 mpph11   |       1416 |  7287490.02
 mpph11   |       1309 |  7213260.60
 mpph11   |        949 |  7197510.84
 mpph11   |       1323 |  7140115.71
 mpph11   |       1046 |  7046743.50
 mpph11   |         69 |  6970845.15
 mpph11   |       1581 |  6760133.10
 mpph11   |        862 |  6658234.84
 mpph11   |       1283 |  6609824.32
 mpph11   |       1277 |  6599037.12
 mpph11   |        828 |  6565785.62
 mpph11   |       1536 |  6561151.80
 mpph11   |        207 |  6537250.98
 mpph11   |       1085 |  6537104.27
 mpph11   |        751 |  6531660.40
 mpph11   |        360 |  6530297.41
 mpph11   |       1984 |  6495512.50
 mpph11   |        765 |  6460546.80
 mpph11   |       1917 |  6227301.68
 mpph11   |       1716 |  6116013.75
 mpph11   |        730 |  6100067.88
 mpph11   |        994 |  6032702.08
 mpph11   |       1144 |  6012205.92
 mpph11   |       1108 |  5914872.72
 mpph11   |       1950 |  5912352.20
 mpph11   |       1963 |  5873329.44
 mpph11   |         26 |  5867999.40
 mpph11   |        983 |  5846645.17
 mpph11   |       1808 |  5835183.38
 mpph11   |        504 |  5770344.51
 mpph11   |       1016 |  5718859.87
 mpph11   |       1494 |  5687809.60
 mpph11   |       1551 |  5668132.44
 mpph11   |        262 |  5625893.82
 mpph11   |        465 |  5537420.64
 mpph11   |        125 |  5533747.40
 mpph11   |       1972 |  5526059.28
 mpph11   |       1125 |  5514223.46
 mpph11   |        601 |  5513532.30
 mpph11   |        886 |  5450951.91
 mpph11   |        173 |  5409250.08
 mpph11   |       1752 |  5389034.04
 mpph11   |       1644 |  5387317.60
 mpph11   |        526 |  5350481.57
 mpph11   |        895 |  5346555.18
 mpph11   |       1576 |  5301661.68
 mpph11   |        692 |  5269557.57
 mpph11   |        951 |  5264770.02
 mpph11   |        861 |  5214617.22
 mpph11   |       1545 |  5196334.26
 mpph11   |       1356 |  5192649.28
 mpph11   |        789 |  5162645.80
 mpph11   |       1516 |  5107050.00
 mpph11   |       1616 |  5091834.00
 mpph11   |       1116 |  4992110.70
 mpph11   |        551 |  4982558.21
 mpph11   |       1887 |  4934262.24
 mpph11   |        885 |  4876658.57
 mpph11   |        116 |  4852263.60
 mpph11   |        251 |  4747015.56
 mpph11   |        394 |  4624460.10
 mpph11   |       1091 |  4589240.04
 mpph11   |        329 |  4558084.80
 mpph11   |        632 |  4494879.28
 mpph11   |       1485 |  4482428.50
 mpph11   |       1725 |  4340873.16
 mpph11   |        816 |  4326623.61
 mpph11   |        699 |  4310431.00
 mpph11   |        403 |  4283221.60
 mpph11   |       1768 |  4251602.98
 mpph11   |       1158 |  4229896.16
 mpph11   |        591 |  4216726.24
 mpph11   |       1248 |  4157093.60
 mpph11   |       1679 |  4156156.64
 mpph11   |        663 |  4142402.22
 mpph11   |       1719 |  4101486.48
 mpph11   |        395 |  4052997.76
 mpph11   |       1351 |  4045565.12
 mpph11   |        531 |  4042060.39
 mpph11   |       1951 |  4023967.36
 mpph11   |       1294 |  4009307.81
 mpph11   |        616 |  4004057.26
 mpph11   |        316 |  3986943.88
 mpph11   |       1928 |  3964898.76
 mpph11   |       1337 |  3951488.10
 mpph11   |       1851 |  3918641.34
 mpph11   |        521 |  3913058.16
 mpph11   |        883 |  3908087.82
 mpph11   |        961 |  3814756.38
 mpph11   |        366 |  3812257.88
 mpph11   |       1875 |  3800216.84
 mpph11   |        668 |  3772880.16
 mpph11   |        107 |  3756380.24
 mpph11   |       1061 |  3747377.84
 mpph11   |         16 |  3745783.12
 mpph11   |        294 |  3744033.70
 mpph11   |       1561 |  3711744.00
 mpph11   |       1574 |  3702071.64
 mpph11   |       1732 |  3695765.58
 mpph11   |        564 |  3680200.80
 mpph11   |       1371 |  3677874.16
 mpph11   |        516 |  3664770.45
 mpph11   |       1585 |  3641002.20
 mpph11   |        755 |  3635116.80
 mpph11   |        959 |  3620453.76
 mpph11   |        190 |  3559078.95
 mpph11   |       1194 |  3479709.09
 mpph11   |        416 |  3452131.59
 mpph11   |        333 |  3446486.38
 mpph11   |        377 |  3359789.30
 mpph11   |       1455 |  3342304.35
 mpph11   |        289 |  3270429.10
 mpph11   |        689 |  3260147.55
 mpph11   |       1919 |  3239067.00
 mpph11   |       1603 |  3194711.46
 mpph11   |       1438 |  3163393.12
 mpph11   |       1777 |  3107373.72
 mpph11   |         11 |  3035887.92
 mpph11   |       1340 |  3030301.09
 mpph11   |       1287 |  2985392.48
 mpph11   |       1347 |  2983078.12
 mpph11   |       1205 |  2971470.28
 mpph11   |        285 |  2967973.75
 mpph11   |        357 |  2967100.97
 mpph11   |        429 |  2962631.88
 mpph11   |         91 |  2951493.40
 mpph11   |       1161 |  2928475.76
 mpph11   |        914 |  2927894.16
 mpph11   |       1962 |  2925555.12
 mpph11   |       1483 |  2918425.86
 mpph11   |        561 |  2904720.39
 mpph11   |        258 |  2895651.20
 mpph11   |        194 |  2840047.13
 mpph11   |       1671 |  2818290.28
 mpph11   |       1477 |  2777362.76
 mpph11   |       1505 |  2766157.98
 mpph11   |        332 |  2741984.16
 mpph11   |        301 |  2737431.90
 mpph11   |        729 |  2706503.68
 mpph11   |        654 |  2662180.27
 mpph11   |        142 |  2647051.80
 mpph11   |        164 |  2643604.15
 mpph11   |       1662 |  2642551.92
 mpph11   |       1554 |  2639338.38
 mpph11   |        280 |  2631317.56
 mpph11   |       1541 |  2603175.96
 mpph11   |       1610 |  2463001.95
 mpph11   |        407 |  2460304.47
 mpph11   |        199 |  2442107.46
 mpph11   |        534 |  2420752.38
 mpph11   |       1313 |  2408870.75
 mpph11   |       1759 |  2387379.32
 mpph11   |       1115 |  2321227.26
 mpph11   |       1251 |  2311454.53
 mpph11   |       1285 |  2260852.77
 mpph11   |        159 |  2256004.65
 mpph11   |       1973 |  2243745.69
 mpph11   |       1638 |  2232762.96
 mpph11   |       1774 |  2217104.85
 mpph11   |        556 |  2195013.90
 mpph11   |       1694 |  2163305.16
 mpph11   |        819 |  2152055.50
 mpph11   |        992 |  2121582.28
 mpph11   |        785 |  2121133.75
 mpph11   |       1985 |  2069183.28
 mpph11   |        794 |  2059945.54
 mpph11   |        498 |  2055444.32
 mpph11   |       1385 |  2051890.11
 mpph11   |       1916 |  2032768.96
 mpph11   |        361 |  2017055.81
 mpph11   |         76 |  2012711.58
 mpph11   |       1873 |  2000792.40
 mpph11   |         94 |  1986087.48
 mpph11   |       1651 |  1980440.40
 mpph11   |       1059 |  1959087.04
 mpph11   |       1122 |  1942108.90
 mpph11   |        261 |  1928153.10
 mpph11   |       1861 |  1928114.84
 mpph11   |        461 |  1877992.32
 mpph11   |        224 |  1863852.24
 mpph11   |       1242 |  1851493.60
 mpph11   |       1634 |  1743866.22
 mpph11   |        761 |  1741958.65
 mpph11   |       1080 |  1741751.34
 mpph11   |        338 |  1724805.12
 mpph11   |        661 |  1709946.82
 mpph11   |        388 |  1696006.86
 mpph11   |        231 |  1655972.00
 mpph11   |        525 |  1633729.79
 mpph11   |       1906 |  1626282.30
 mpph11   |         85 |  1599847.56
 mpph11   |         60 |  1579401.77
 mpph11   |        926 |  1570368.78
 mpph11   |       1511 |  1569870.02
 mpph11   |       1113 |  1516263.20
 mpph11   |       1089 |  1477486.65
 mpph11   |       1422 |  1435904.00
 mpph11   |        458 |  1433040.45
 mpph11   |       1907 |  1421100.55
 mpph11   |        323 |  1419854.80
 mpph11   |        851 |  1400193.30
 mpph11   |         44 |  1353557.34
 mpph11   |        595 |  1350125.70
 mpph11   |       1822 |  1337990.67
 mpph11   |          1 |  1333528.04
 mpph11   |       1710 |  1331788.48
 mpph11   |         61 |  1322305.60
 mpph11   |        798 |  1313571.96
 mpph11   |        784 |  1309867.02
 mpph11   |        651 |  1307083.56
 mpph11   |       1468 |  1302397.20
 mpph11   |       1149 |  1289607.35
 mpph11   |       1179 |  1242058.40
 mpph11   |        818 |  1225981.68
 mpph11   |       1189 |  1204828.08
 mpph11   |        797 |  1181263.32
 mpph11   |       1375 |  1178128.60
 mpph11   |       1015 |  1164198.48
 mpph11   |       1994 |  1149222.96
 mpph11   |         66 |  1148101.44
 mpph11   |       1929 |  1131697.92
 mpph11   |        240 |  1126682.48
 mpph11   |       1378 |  1121941.05
 mpph11   |        762 |  1109467.26
 mpph11   |        586 |  1108200.58
 mpph11   |        716 |  1107627.42
 mpph11   |        752 |  1102384.63
 mpph11   |       1220 |  1083540.00
 mpph11   |       1675 |  1064600.76
 mpph11   |       1380 |  1020105.06
 mpph11   |        204 |  1014095.32
 mpph11   |       1214 |  1013602.86
 mpph11   |       1186 |  1006354.08
 mpph11   |        927 |  1003227.51
 mpph11   |       1473 |   997508.48
 mpph11   |       1701 |   994231.40
 mpph11   |        168 |   988803.90
 mpph11   |        852 |   977609.14
 mpph11   |        235 |   977200.14
 mpph11   |        501 |   961161.66
 mpph11   |       1620 |   950561.25
 mpph11   |       1709 |   927244.00
 mpph11   |       1565 |   921078.22
 mpph11   |        960 |   913060.80
 mpph11   |        385 |   910892.90
 mpph11   |       1434 |   905713.25
 mpph11   |        658 |   894649.92
 mpph11   |       1865 |   886024.01
 mpph11   |        487 |   883607.88
 mpph11   |       1279 |   877210.28
 mpph11   |       1211 |   875261.76
 mpph11   |        555 |   869246.77
 mpph11   |       1521 |   866284.81
 mpph11   |        427 |   839771.02
 mpph11   |       1628 |   832363.52
 mpph11   |        297 |   832286.88
 mpph11   |       1051 |   824164.90
 mpph11   |        185 |   794405.50
 mpph11   |       1412 |   793718.80
 mpph11   |        432 |   782403.82
 mpph11   |        216 |   776184.13
 mpph11   |       1056 |   772092.44
 mpph11   |        494 |   768524.43
 mpph11   |       1446 |   746482.32
 mpph11   |       1661 |   733795.56
 mpph11   |       1274 |   711073.48
 mpph11   |        451 |   676703.28
 mpph11   |       1685 |   661635.90
 mpph11   |       1143 |   660014.26
 mpph11   |       1318 |   655995.66
 mpph11   |       1531 |   649589.40
 mpph11   |       1514 |   627482.08
 mpph11   |       1612 |   626730.56
 mpph11   |        948 |   622068.66
 mpph11   |        571 |   619871.04
 mpph11   |       1767 |   614422.00
 mpph11   |        351 |   601983.45
 mpph11   |       1499 |   594599.22
 mpph11   |       1941 |   594211.48
 mpph11   |       1153 |   584114.56
 mpph11   |       1257 |   580110.85
 mpph11   |       1461 |   576845.88
 mpph11   |       1361 |   570409.02
 mpph11   |       1250 |   567963.36
 mpph11   |        422 |   530847.10
 mpph11   |       1653 |   525077.35
 mpph11   |       1669 |   513932.46
 mpph11   |       1596 |   505225.82
 mpph11   |        850 |   483358.05
 mpph11   |       1151 |   481433.04
 mpph11   |         86 |   471697.70
 mpph11   |        894 |   465151.80
 mpph11   |         19 |   464872.80
 mpph11   |        474 |   455889.28
 mpph11   |        493 |   455628.44
 mpph11   |        267 |   453340.80
 mpph11   |       1856 |   450086.28
 mpph11   |       1830 |   446553.54
 mpph11   |        456 |   439968.00
 mpph11   |        305 |   421891.68
 mpph11   |       1594 |   417994.09
 mpph11   |       1894 |   414577.35
 mpph11   |       1240 |   413718.76
 mpph11   |         35 |   398837.24
 mpph11   |       1180 |   391898.15
 mpph11   |       1794 |   355474.42
 mpph11   |       1024 |   319659.12
 mpph11   |        594 |   315583.24
 mpph11   |         10 |   314550.82
 mpph11   |       1953 |   314372.14
 mpph11   |       1261 |   312283.65
 mpph11   |       1832 |   308459.25
 mpph11   |       1785 |   300945.33
 mpph11   |        138 |   298832.01
 mpph11   |        753 |   297884.88
 mpph11   |       1790 |   277454.80
 mpph11   |        133 |   262568.64
 mpph11   |         51 |   260089.38
 mpph11   |        620 |   246511.60
 mpph11   |       1961 |   232870.27
 mpph11   |       1224 |   227429.47
 mpph11   |        183 |   225827.28
 mpph11   |       1735 |   219074.20
 mpph11   |       1816 |   218339.50
 mpph11   |       1743 |   217085.97
 mpph11   |        985 |   182239.20
 mpph11   |       1761 |   182100.00
 mpph11   |        464 |   179639.88
 mpph11   |        817 |   170795.52
 mpph11   |        485 |   170664.12
 mpph11   |       1818 |   161250.35
 mpph11   |        630 |   158427.72
 mpph11   |       1571 |   156406.05
 mpph11   |       1094 |   155577.60
 mpph11   |        436 |   147283.92
 mpph11   |        916 |   146788.80
 mpph11   |        310 |   145905.18
 mpph11   |       1751 |   140193.69
 mpph11   |        993 |   136907.25
 mpph11   |       1050 |   136152.30
 mpph11   |       1394 |   120166.11
 mpph11   |       1177 |   115967.72
 mpph11   |        151 |   110222.90
(357 rows)

select  'mpph12',
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('RAIL', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1993-01-01'
	and l_receiptdate < date '1993-01-01' + interval '1 year'
group by
	l_shipmode
order by
	l_shipmode;
 ?column? | l_shipmode | high_line_count | low_line_count 
----------+------------+-----------------+----------------
 mpph12   | MAIL       |              41 |             99
 mpph12   | RAIL       |              54 |            102
(2 rows)

select  'mpph13',
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%express%deposits%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;
 ?column? | c_count | custdist 
----------+---------+----------
 mpph13   |       0 |      500
 mpph13   |      11 |       66
 mpph13   |      10 |       64
 mpph13   |       8 |       63
 mpph13   |      12 |       61
 mpph13   |       9 |       60
 mpph13   |      20 |       58
 mpph13   |      13 |       58
 mpph13   |      14 |       53
 mpph13   |      15 |       48
 mpph13   |       7 |       47
 mpph13   |      18 |       43
 mpph13   |      17 |       40
 mpph13   |      21 |       38
 mpph13   |      16 |       38
 mpph13   |      19 |       36
 mpph13   |       6 |       35
 mpph13   |      22 |       34
 mpph13   |      24 |       32
 mpph13   |      23 |       30
 mpph13   |      25 |       22
 mpph13   |      26 |       19
 mpph13   |       5 |       13
 mpph13   |      27 |       10
 mpph13   |      28 |        9
 mpph13   |       4 |        7
 mpph13   |      32 |        4
 mpph13   |      30 |        4
 mpph13   |      29 |        3
 mpph13   |       3 |        2
 mpph13   |       2 |        2
 mpph13   |      31 |        1
(32 rows)

select  'mpph14',
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1993-01-01'
	and l_shipdate < date '1993-01-01' + interval '1 month';
 ?column? |    promo_revenue    
----------+---------------------
 mpph14   | 11.5452471385458443
(1 row)

create view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= date '1993-01-01'
		and l_shipdate < date '1993-01-01' + interval '3 month'
	group by
		l_suppkey;
select  'mpph15',
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;
 ?column? | s_suppkey |          s_name           |          s_address          |     s_phone     | total_revenue 
----------+-----------+---------------------------+-----------------------------+-----------------+---------------
 mpph15   |        84 | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx | 34-869-118-7803 |  1134618.0543
(1 row)

drop view revenue0;
select 'mpph16',
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	part, 
	partsupp left join supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
 ?column? |  p_brand   |          p_type           | p_size | supplier_cnt 
----------+------------+---------------------------+--------+--------------
 mpph16   | Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 mpph16   | Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 mpph16   | Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 mpph16   | Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 mpph16   | Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 mpph16   | Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 mpph16   | Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 mpph16   | Brand#11   | SMALL PLATED COPPER       |     46 |            4
 mpph16   | Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 mpph16   | Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 mpph16   | Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 mpph16   | Brand#11   | STANDARD PLATED TIN       |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 mpph16   | Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 mpph16   | Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 mpph16   | Brand#12   | LARGE PLATED COPPER       |     46 |            4
 mpph16   | Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 mpph16   | Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 mpph16   | Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 mpph16   | Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 mpph16   | Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 mpph16   | Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 mpph16   | Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 mpph16   | Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 mpph16   | Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 mpph16   | Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 mpph16   | Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 mpph16   | Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 mpph16   | Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 mpph16   | Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 mpph16   | Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 mpph16   | Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 mpph16   | Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 mpph16   | Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 mpph16   | Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 mpph16   | Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 mpph16   | Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 mpph16   | Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 mpph16   | Brand#15   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 mpph16   | Brand#15   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 mpph16   | Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 mpph16   | Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 mpph16   | Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 mpph16   | Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 mpph16   | Brand#21   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 mpph16   | Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 mpph16   | Brand#21   | PROMO PLATED COPPER       |     20 |            4
 mpph16   | Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 mpph16   | Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 mpph16   | Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 mpph16   | Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 mpph16   | Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 mpph16   | Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 mpph16   | Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 mpph16   | Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 mpph16   | Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 mpph16   | Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 mpph16   | Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 mpph16   | Brand#23   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 mpph16   | Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 mpph16   | Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 mpph16   | Brand#23   | SMALL PLATED TIN          |     42 |            4
 mpph16   | Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 mpph16   | Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 mpph16   | Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 mpph16   | Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 mpph16   | Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 mpph16   | Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 mpph16   | Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 mpph16   | Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 mpph16   | Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 mpph16   | Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 mpph16   | Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 mpph16   | Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 mpph16   | Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 mpph16   | Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 mpph16   | Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 mpph16   | Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 mpph16   | Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 mpph16   | Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 mpph16   | Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 mpph16   | Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 mpph16   | Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 mpph16   | Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 mpph16   | Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 mpph16   | Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 mpph16   | Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#32   | SMALL PLATED BRASS        |     31 |            4
 mpph16   | Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 mpph16   | Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 mpph16   | Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 mpph16   | Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 mpph16   | Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 mpph16   | Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 mpph16   | Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 mpph16   | Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 mpph16   | Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 mpph16   | Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 mpph16   | Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 mpph16   | Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 mpph16   | Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 mpph16   | Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 mpph16   | Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 mpph16   | Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 mpph16   | Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 mpph16   | Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 mpph16   | Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 mpph16   | Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 mpph16   | Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 mpph16   | Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 mpph16   | Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 mpph16   | Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#42   | PROMO POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     24 |            4
 mpph16   | Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 mpph16   | Brand#43   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#43   | LARGE PLATED TIN          |     24 |            4
 mpph16   | Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 mpph16   | Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 mpph16   | Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 mpph16   | Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 mpph16   | Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 mpph16   | Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 mpph16   | Brand#45   | LARGE PLATED STEEL        |     22 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#45   | SMALL PLATED COPPER       |     15 |            4
 mpph16   | Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 mpph16   | Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 mpph16   | Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 mpph16   | Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 mpph16   | Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 mpph16   | Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 mpph16   | Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 mpph16   | Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 mpph16   | Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 mpph16   | Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 mpph16   | Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 mpph16   | Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 mpph16   | Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 mpph16   | Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 mpph16   | Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#52   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 mpph16   | Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 mpph16   | Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 mpph16   | Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 mpph16   | Brand#53   | SMALL PLATED STEEL        |     31 |            4
 mpph16   | Brand#53   | SMALL POLISHED TIN        |     42 |            4
 mpph16   | Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 mpph16   | Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 mpph16   | Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 mpph16   | Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 mpph16   | Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 mpph16   | Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 mpph16   | Brand#54   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 mpph16   | Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 mpph16   | Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 mpph16   | Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 mpph16   | Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 mpph16   | Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 mpph16   | Brand#55   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 mpph16   | Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 mpph16   | Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 mpph16   | Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;select 'mpph17',
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

      sum(l_extendedprice) / 7.0 as avg_yearly
from
      lineitem,
      (
          select
              p_partkey as x_partkey,
              0.2 * avg(l_quantity) as x_avg_20
          from
              part,
              lineitem
          where
              p_partkey = l_partkey
              and p_brand = 'Brand#32'
              and p_container = 'JUMBO PACK'
          group by
              p_partkey
      ) x
where
      x_partkey = l_partkey
and l_quantity < x_avg_20;
 ?column? |      avg_yearly       
----------+-----------------------
 mpph17   | 1278.3700000000000000
(1 row)

select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#32'
	and p_container = 'JUMBO PACK'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);
      avg_yearly       
-----------------------
 1278.3700000000000000
(1 row)

select  'mpph18',
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
 ?column? |       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice |  sum   
----------+--------------------+-----------+------------+-------------+--------------+--------
 mpph18   | Customer#000000667 |       667 |      29158 | 10-21-1995  |    439687.23 | 305.00
 mpph18   | Customer#000000178 |       178 |       6882 | 04-09-1997  |    422359.65 | 303.00
(2 rows)

select  'mpph19',
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#53'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);select  'mpph20',
 ?column? |  revenue   
----------+------------
 mpph19   | 10604.0448
(1 row)

	s_name,
	s_address 
from 
	supplier, 
	nation 
where 
	s_suppkey in( 
		select 
			ps_suppkey 
		from 
			partsupp, 
			( 
				select 
					sum(l_quantity) as qty_sum, l_partkey, l_suppkey 
				from 
					lineitem 
				where 
					l_shipdate >= date '1996-01-01' 
					and l_shipdate < date '1996-01-01' + interval '1 year' 
				group by l_partkey, l_suppkey ) g 
		where 
			g.l_partkey = ps_partkey 
			and g.l_suppkey = ps_suppkey 
			and ps_availqty > 0.5 * g.qty_sum 
			and ps_partkey in ( select p_partkey from part where p_name like 'medium%' ) 
		) 
	and s_nationkey = n_nationkey 
	and n_name = 'UNITED STATES'
order by 
	s_name;
 ?column? |          s_name           |                s_address                 
----------+---------------------------+------------------------------------------
 mpph20   | Supplier#000000010        | Saygah3gYWMp72i PY
 mpph20   | Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 mpph20   | Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 mpph20   | Supplier#000000049        | Nvq 6macF4GtJvz
 mpph20   | Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 mpph20   | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					part
				where
					p_name like 'medium%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= date '1996-01-01'
					and l_shipdate < date '1996-01-01' + interval '1 year'
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
order by
	s_name;select  'mpph21',
          s_name           |                s_address                 
---------------------------+------------------------------------------
 Supplier#000000010        | Saygah3gYWMp72i PY
 Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 Supplier#000000049        | Nvq 6macF4GtJvz
 Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

	s_name, 
	count(distinct(l1.l_orderkey::text||l1.l_linenumber::text)) as numwait 
from 
	supplier, 
	orders, 
	nation, 
	lineitem l1 
		left join lineitem l2 
			on (l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) 
		left join (
			select 
				l3.l_orderkey,
				l3.l_suppkey 
			from 
				lineitem l3 
			where 
				l3.l_receiptdate > l3.l_commitdate) l4 
			on (l4.l_orderkey = l1.l_orderkey and l4.l_suppkey <> l1.l_suppkey) 
where 
	s_suppkey = l1.l_suppkey 
	and o_orderkey = l1.l_orderkey 
	and o_orderstatus = 'F' 
	and l1.l_receiptdate > l1.l_commitdate 
	and l2.l_orderkey is not null 
	and l4.l_orderkey is null 
	and s_nationkey = n_nationkey 
	and n_name = 'MOZAMBIQUE' 
group by 
	s_name 
order by 
	numwait desc, 
	s_name
LIMIT 100;
 ?column? |          s_name           | numwait 
----------+---------------------------+---------
 mpph21   | Supplier#000000056        |      18
 mpph21   | Supplier#000000073        |      13
 mpph21   | Supplier#000000018        |      12
 mpph21   | Supplier#000000058        |      10
 mpph21   | Supplier#000000030        |       9
 mpph21   | Supplier#000000093        |       9
 mpph21   | Supplier#000000031        |       6
(7 rows)

select  'mpph22',
	cntrycode, 
	count(*) as numcust, 
	sum(c_acctbal) as totacctbal 
from 
	( 
		select 
			substring(c_phone from 1 for 2) as cntrycode, 
			c_acctbal 
		from 
			customer left join orders 
				on c_custkey = o_custkey 
		where 
			substring(c_phone from 1 for 2) in 
				('11', '28', '21', '26', '19', '13', '22') 
			and c_acctbal > ( 
				select 
					avg(c_acctbal) 
				from 
					customer 
				where 
					c_acctbal > 0.00 
					and substring(c_phone from 1 for 2) in 
						('11', '28', '21', '26', '19', '13', '22') 
			) 
			and o_custkey is null 
	) as custsale 
group by 
	cntrycode 
order by 
	cntrycode;
 ?column? | cntrycode | numcust | totacctbal 
----------+-----------+---------+------------
 mpph22   | 11        |      11 |   82845.34
 mpph22   | 13        |      10 |   75359.29
 mpph22   | 19        |      17 |  132118.07
 mpph22   | 21        |       9 |   73087.05
 mpph22   | 22        |       9 |   65544.55
 mpph22   | 26        |       6 |   47747.11
 mpph22   | 28        |      10 |   79310.33
(7 rows)

select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('11', '28', '21', '26', '19', '13', '22')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('11', '28', '21', '26', '19', '13', '22')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;
 cntrycode | numcust | totacctbal 
-----------+---------+------------
 11        |      11 |   82845.34
 13        |      10 |   75359.29
 19        |      17 |  132118.07
 21        |       9 |   73087.05
 22        |       9 |   65544.55
 26        |       6 |   47747.11
 28        |      10 |   79310.33
(7 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	part, 
	partsupp left join supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

\c mpph_co
select 'mpph00-1',count(*), sum(n_nationkey), min(n_nationkey), max(n_nationkey) from nation;
 ?column? | count | sum | min | max 
----------+-------+-----+-----+-----
 mpph00-1 |    25 | 300 |   0 |  24
(1 row)

select 'mpph00-2',count(*), sum(r_regionkey), min(r_regionkey), max(r_regionkey) from region;
 ?column? | count | sum | min | max 
----------+-------+-----+-----+-----
 mpph00-2 |     5 |  10 |   0 |   4
(1 row)

select 'mpph00-3',count(*), sum(p_partkey), min(p_partkey), max(p_partkey) from part;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-3 |  2000 | 2001000 |   1 | 2000
(1 row)

select 'mpph00-4',count(*), sum(s_suppkey), min(s_suppkey), max(s_suppkey) from supplier;
 ?column? | count | sum  | min | max 
----------+-------+------+-----+-----
 mpph00-4 |   100 | 5050 |   1 | 100
(1 row)

select 'mpph00-5',count(*), sum(ps_partkey + ps_suppkey), min(ps_partkey + ps_suppkey), max(ps_partkey + ps_suppkey) from partsupp;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-5 |  8000 | 8408000 |   3 | 2099
(1 row)

select 'mpph00-6',count(*), sum(c_custkey), min(c_custkey), max(c_custkey) from customer;
 ?column? | count |   sum   | min | max  
----------+-------+---------+-----+------
 mpph00-6 |  1500 | 1125750 |   1 | 1500
(1 row)

select 'mpph00-7',count(*), sum(o_orderkey), min(o_orderkey), max(o_orderkey) from orders;
 ?column? | count |    sum    | min |  max  
----------+-------+-----------+-----+-------
 mpph00-7 | 15000 | 449872500 |   1 | 60000
(1 row)

select 'mpph00-8',count(*), sum(l_linenumber), min(l_linenumber), max(l_linenumber) from lineitem;
 ?column? | count |  sum   | min | max 
----------+-------+--------+-----+-----
 mpph00-8 | 60175 | 180782 |   1 |   7
(1 row)

select  'mpph1',
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '108 day'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
 ?column? | l_returnflag | l_linestatus |  sum_qty  | sum_base_price | sum_disc_price |    sum_charge     |       avg_qty       |     avg_price      |        avg_disc        | count_order 
----------+--------------+--------------+-----------+----------------+----------------+-------------------+---------------------+--------------------+------------------------+-------------
 mpph1    | A            | F            | 380456.00 |   532348211.65 | 505822441.4861 |  526165934.000839 | 25.5751546114546921 | 35785.709306937349 | 0.05008133906964237698 |       14876
 mpph1    | N            | F            |   8971.00 |    12384801.37 |  11798257.2080 |   12282485.056933 | 25.7787356321839080 | 35588.509683908046 | 0.04775862068965517241 |         348
 mpph1    | N            | O            | 733323.00 |  1028186527.78 | 977118238.4241 | 1016280268.835844 | 25.4466999791796794 | 35678.621964744257 | 0.04991255465334166146 |       28818
 mpph1    | R            | F            | 381449.00 |   534594445.35 | 507996454.4067 |  528524219.358903 | 25.5971681653469333 | 35874.006532680177 | 0.04982753992752650651 |       14902
(4 rows)

select  'mpph2',
	s.s_acctbal,
	s.s_name,
	n.n_name,
	p.p_partkey,
	p.p_mfgr,
	s.s_address,
	s.s_phone,
	s.s_comment 
from 
	supplier s, 
	partsupp ps, 
	nation n, 
	region r, 
	part p, 
	(select p_partkey, min(ps_supplycost) as min_ps_cost 
		from 
			part, 
			partsupp , 	
			supplier,
			nation, 
			region 
		where 
			p_partkey=ps_partkey 
			and s_suppkey = ps_suppkey 
			and s_nationkey = n_nationkey 
			and n_regionkey = r_regionkey 
			and r_name = 'EUROPE' 
		group by p_partkey ) g 
where 
	p.p_partkey = ps.ps_partkey 
	and g.p_partkey = p.p_partkey 
	and g. min_ps_cost = ps.ps_supplycost 
	and s.s_suppkey = ps.ps_suppkey 
	and p.p_size = 45 
	and p.p_type like '%NICKEL' 
	and s.s_nationkey = n.n_nationkey 
	and n.n_regionkey = r.r_regionkey 
	and r.r_name = 'EUROPE' 
order by 
	s.s_acctbal desc,
	n.n_name,
	s.s_name,
	p.p_partkey
LIMIT 100;
 ?column? | s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
----------+-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
 mpph2    |   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
 mpph2    |   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
 mpph2    |   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 45
	and p_type like '%NICKEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
 s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select  'mpph3',
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'MACHINERY'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-15'
	and l_shipdate > date '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
 ?column? | l_orderkey |   revenue   | o_orderdate | o_shippriority 
----------+------------+-------------+-------------+----------------
 mpph3    |      12641 | 222127.6271 | 02-23-1995  |              0
 mpph3    |      39878 | 219714.3069 | 03-06-1995  |              0
 mpph3    |      34243 | 214308.7196 | 02-12-1995  |              0
 mpph3    |       7171 | 202398.1900 | 02-14-1995  |              0
 mpph3    |      55271 | 195237.8000 | 03-12-1995  |              0
 mpph3    |      50145 | 189500.1602 | 02-27-1995  |              0
 mpph3    |      12867 | 185769.1004 | 03-12-1995  |              0
 mpph3    |      12066 | 180776.3231 | 02-07-1995  |              0
 mpph3    |      41926 | 180459.9518 | 02-06-1995  |              0
 mpph3    |      46307 | 180383.2464 | 02-07-1995  |              0
(10 rows)

select  'mpph4',
        o_orderpriority,
        count(*) as order_count
from
        orders
where
        o_orderdate >= date '1994-05-01'
        and o_orderdate < date '1994-05-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
 ?column? | o_orderpriority | order_count 
----------+-----------------+-------------
 mpph4    | 1-URGENT        |         108
 mpph4    | 2-HIGH          |         117
 mpph4    | 3-MEDIUM        |          95
 mpph4    | 4-NOT SPECIFIED |         111
 mpph4    | 5-LOW           |         116
(5 rows)

select  'mpph5',
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '1 year'
group by
	n_name
order by
	revenue desc;
 ?column? |          n_name           |   revenue   
----------+---------------------------+-------------
 mpph5    | UNITED STATES             | 721432.9139
 mpph5    | CANADA                    | 451731.0802
 mpph5    | PERU                      | 317553.7203
 mpph5    | BRAZIL                    | 275951.7747
 mpph5    | ARGENTINA                 | 225713.4702
(5 rows)

select  'mpph6',
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= date '1996-01-01'
	and l_shipdate < date '1996-01-01' + interval '1 year'
	and l_discount between 0.04 - 0.01 and 0.04 + 0.01
	and l_quantity < 24;
 ?column? |   revenue   
----------+-------------
 mpph6    | 740117.7050
(1 row)

select  'mpph7',
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'MOZAMBIQUE')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
 ?column? |        supp_nation        |        cust_nation        | l_year |   revenue    
----------+---------------------------+---------------------------+--------+--------------
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1995 |  749611.6213
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1996 |  838743.2524
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1995 |  669933.3036
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1996 | 1084686.2375
(4 rows)

select  'mpph8',
	o_year,
	sum(case
		when nation = 'PERU' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'MEDIUM POLISHED TIN'
	) as all_nations
group by
	o_year
order by
	o_year;
 ?column? | o_year |         mkt_share          
----------+--------+----------------------------
 mpph8    |   1995 | 0.000000000000000000000000
 mpph8    |   1996 |     0.17380660267693394854
(2 rows)

select  'mpph9',
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%tan%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
 ?column? |          nation           | o_year | sum_profit  
----------+---------------------------+--------+-------------
 mpph9    | ALGERIA                   |   1998 | 203717.6183
 mpph9    | ALGERIA                   |   1997 | 277895.7940
 mpph9    | ALGERIA                   |   1996 | 285313.9627
 mpph9    | ALGERIA                   |   1995 | 309375.7934
 mpph9    | ALGERIA                   |   1994 | 288152.6449
 mpph9    | ALGERIA                   |   1993 | 321222.9401
 mpph9    | ALGERIA                   |   1992 | 436020.6807
 mpph9    | ARGENTINA                 |   1998 | 217919.0097
 mpph9    | ARGENTINA                 |   1997 |  47720.1989
 mpph9    | ARGENTINA                 |   1996 | 373086.6814
 mpph9    | ARGENTINA                 |   1995 | 256403.9057
 mpph9    | ARGENTINA                 |   1994 | 172411.8182
 mpph9    | ARGENTINA                 |   1993 | 414051.7103
 mpph9    | ARGENTINA                 |   1992 | 497745.7196
 mpph9    | BRAZIL                    |   1998 |   9402.1360
 mpph9    | BRAZIL                    |   1996 | 130680.4872
 mpph9    | BRAZIL                    |   1995 |  47629.8480
 mpph9    | BRAZIL                    |   1994 |  22440.1440
 mpph9    | BRAZIL                    |   1993 | 106237.4759
 mpph9    | BRAZIL                    |   1992 | 116994.4770
 mpph9    | CANADA                    |   1998 |  67660.5389
 mpph9    | CANADA                    |   1997 | 167179.5520
 mpph9    | CANADA                    |   1996 | 147802.3006
 mpph9    | CANADA                    |   1995 |  84817.9292
 mpph9    | CANADA                    |   1994 |  49027.1082
 mpph9    | CANADA                    |   1993 | 157886.0056
 mpph9    | CANADA                    |   1992 | 191231.3590
 mpph9    | CHINA                     |   1998 | 382876.9927
 mpph9    | CHINA                     |   1997 | 787527.2369
 mpph9    | CHINA                     |   1996 | 605901.5293
 mpph9    | CHINA                     |   1995 | 587705.6412
 mpph9    | CHINA                     |   1994 | 917527.5948
 mpph9    | CHINA                     |   1993 | 839365.4133
 mpph9    | CHINA                     |   1992 | 748324.7469
 mpph9    | EGYPT                     |   1998 | 220523.2078
 mpph9    | EGYPT                     |   1997 | 554962.2792
 mpph9    | EGYPT                     |   1996 | 526118.5876
 mpph9    | EGYPT                     |   1995 | 406448.9115
 mpph9    | EGYPT                     |   1994 | 404925.7193
 mpph9    | EGYPT                     |   1993 | 296691.1725
 mpph9    | EGYPT                     |   1992 | 449161.6055
 mpph9    | ETHIOPIA                  |   1998 | 178828.6942
 mpph9    | ETHIOPIA                  |   1997 | 322949.1543
 mpph9    | ETHIOPIA                  |   1996 | 179589.0062
 mpph9    | ETHIOPIA                  |   1995 | 215017.5362
 mpph9    | ETHIOPIA                  |   1994 | 509710.4645
 mpph9    | ETHIOPIA                  |   1993 | 251330.1758
 mpph9    | ETHIOPIA                  |   1992 | 225397.2384
 mpph9    | FRANCE                    |   1998 | 210901.9632
 mpph9    | FRANCE                    |   1997 | 234428.9324
 mpph9    | FRANCE                    |   1996 | 283026.6644
 mpph9    | FRANCE                    |   1995 | 428615.5897
 mpph9    | FRANCE                    |   1994 | 233410.4344
 mpph9    | FRANCE                    |   1993 | 420330.4447
 mpph9    | FRANCE                    |   1992 | 359496.0042
 mpph9    | GERMANY                   |   1998 | 229863.3768
 mpph9    | GERMANY                   |   1997 | 519160.2856
 mpph9    | GERMANY                   |   1996 | 533764.1221
 mpph9    | GERMANY                   |   1995 | 621744.7373
 mpph9    | GERMANY                   |   1994 | 340785.3795
 mpph9    | GERMANY                   |   1993 | 673651.1393
 mpph9    | GERMANY                   |   1992 | 524002.5977
 mpph9    | INDIA                     |   1998 | 334403.8655
 mpph9    | INDIA                     |   1997 | 156434.8865
 mpph9    | INDIA                     |   1996 | 265093.2063
 mpph9    | INDIA                     |   1995 | 137842.0462
 mpph9    | INDIA                     |   1994 | 262710.5074
 mpph9    | INDIA                     |   1993 | 328441.1285
 mpph9    | INDIA                     |   1992 | 199589.6727
 mpph9    | INDONESIA                 |   1998 | 155973.1013
 mpph9    | INDONESIA                 |   1997 | 316792.0784
 mpph9    | INDONESIA                 |   1996 | 422245.5263
 mpph9    | INDONESIA                 |   1995 | 235242.8814
 mpph9    | INDONESIA                 |   1994 | 326775.3396
 mpph9    | INDONESIA                 |   1993 | 327711.7699
 mpph9    | INDONESIA                 |   1992 | 243688.5923
 mpph9    | IRAN                      |   1998 |  27198.8568
 mpph9    | IRAN                      |   1997 | 174737.8001
 mpph9    | IRAN                      |   1996 |  50121.8822
 mpph9    | IRAN                      |   1995 |  70977.8022
 mpph9    | IRAN                      |   1994 | 104593.0442
 mpph9    | IRAN                      |   1993 |  25867.0544
 mpph9    | IRAN                      |   1992 |  82988.9337
 mpph9    | IRAQ                      |   1998 | 157348.1240
 mpph9    | IRAQ                      |   1997 | 227619.0410
 mpph9    | IRAQ                      |   1996 | 114431.2136
 mpph9    | IRAQ                      |   1995 |  83702.7028
 mpph9    | IRAQ                      |   1994 | 189246.3076
 mpph9    | IRAQ                      |   1993 | 172977.0040
 mpph9    | IRAQ                      |   1992 | 165679.6544
 mpph9    | JAPAN                     |   1998 | 301448.7416
 mpph9    | JAPAN                     |   1997 | 274224.7673
 mpph9    | JAPAN                     |   1996 | 365055.9942
 mpph9    | JAPAN                     |   1995 | 273486.9553
 mpph9    | JAPAN                     |   1994 | 306480.9939
 mpph9    | JAPAN                     |   1993 | 309841.9310
 mpph9    | JAPAN                     |   1992 | 257133.6723
 mpph9    | JORDAN                    |   1998 |  51101.6440
 mpph9    | JORDAN                    |   1996 |   6016.6285
 mpph9    | JORDAN                    |   1995 |  58278.1892
 mpph9    | JORDAN                    |   1994 |  59604.3204
 mpph9    | JORDAN                    |   1993 | 110544.8190
 mpph9    | KENYA                     |   1998 | 239097.5320
 mpph9    | KENYA                     |   1997 | 177292.9690
 mpph9    | KENYA                     |   1996 | 597636.7126
 mpph9    | KENYA                     |   1995 | 434837.8428
 mpph9    | KENYA                     |   1994 | 511118.7047
 mpph9    | KENYA                     |   1993 | 181482.4886
 mpph9    | KENYA                     |   1992 | 442814.6201
 mpph9    | MOROCCO                   |   1998 |  94153.7562
 mpph9    | MOROCCO                   |   1997 |   1952.7200
 mpph9    | MOROCCO                   |   1996 | 184609.4769
 mpph9    | MOROCCO                   |   1995 | 138773.7720
 mpph9    | MOROCCO                   |   1994 | 141735.9952
 mpph9    | MOROCCO                   |   1993 | 240971.4009
 mpph9    | MOROCCO                   |   1992 |  76485.6974
 mpph9    | MOZAMBIQUE                |   1998 | 315271.5330
 mpph9    | MOZAMBIQUE                |   1997 | 593511.8009
 mpph9    | MOZAMBIQUE                |   1996 | 463830.0035
 mpph9    | MOZAMBIQUE                |   1995 | 463982.1278
 mpph9    | MOZAMBIQUE                |   1994 | 402790.4493
 mpph9    | MOZAMBIQUE                |   1993 | 765203.5080
 mpph9    | MOZAMBIQUE                |   1992 | 552780.7126
 mpph9    | PERU                      |   1998 | 291043.9094
 mpph9    | PERU                      |   1997 | 332386.6526
 mpph9    | PERU                      |   1996 | 271308.8627
 mpph9    | PERU                      |   1995 | 136468.6570
 mpph9    | PERU                      |   1994 | 231696.8464
 mpph9    | PERU                      |   1993 | 319175.9000
 mpph9    | PERU                      |   1992 | 296178.1348
 mpph9    | ROMANIA                   |   1998 | 366693.1531
 mpph9    | ROMANIA                   |   1997 | 313915.6675
 mpph9    | ROMANIA                   |   1996 | 257449.7931
 mpph9    | ROMANIA                   |   1995 | 613689.1994
 mpph9    | ROMANIA                   |   1994 | 514683.8323
 mpph9    | ROMANIA                   |   1993 | 301818.9752
 mpph9    | ROMANIA                   |   1992 | 445559.9618
 mpph9    | RUSSIA                    |   1998 | 215635.7552
 mpph9    | RUSSIA                    |   1997 | 263377.9773
 mpph9    | RUSSIA                    |   1996 | 292798.2473
 mpph9    | RUSSIA                    |   1995 | 202559.9044
 mpph9    | RUSSIA                    |   1994 | 287175.8782
 mpph9    | RUSSIA                    |   1993 | 163995.8157
 mpph9    | RUSSIA                    |   1992 | 356477.2999
 mpph9    | SAUDI ARABIA              |   1998 |  22338.7375
 mpph9    | SAUDI ARABIA              |   1997 |  89352.2847
 mpph9    | SAUDI ARABIA              |   1996 | 172227.1252
 mpph9    | SAUDI ARABIA              |   1995 | 104670.1059
 mpph9    | SAUDI ARABIA              |   1994 |  39327.6690
 mpph9    | SAUDI ARABIA              |   1993 |  76176.8010
 mpph9    | SAUDI ARABIA              |   1992 |  71000.2760
 mpph9    | UNITED KINGDOM            |   1998 |  57011.9084
 mpph9    | UNITED KINGDOM            |   1997 |  86313.0141
 mpph9    | UNITED KINGDOM            |   1996 |  93430.0955
 mpph9    | UNITED KINGDOM            |   1995 | 105005.8744
 mpph9    | UNITED KINGDOM            |   1994 | 111953.2358
 mpph9    | UNITED KINGDOM            |   1993 | 161721.5622
 mpph9    | UNITED KINGDOM            |   1992 | 173519.0108
 mpph9    | UNITED STATES             |   1998 | 382856.8948
 mpph9    | UNITED STATES             |   1997 | 494438.3396
 mpph9    | UNITED STATES             |   1996 | 548337.7007
 mpph9    | UNITED STATES             |   1995 | 720764.4099
 mpph9    | UNITED STATES             |   1994 | 695834.7785
 mpph9    | UNITED STATES             |   1993 | 593012.3919
 mpph9    | UNITED STATES             |   1992 | 801814.0301
 mpph9    | VIETNAM                   |   1998 | 253199.9819
 mpph9    | VIETNAM                   |   1997 | 551578.3779
 mpph9    | VIETNAM                   |   1996 | 309940.0530
 mpph9    | VIETNAM                   |   1995 | 491467.2046
 mpph9    | VIETNAM                   |   1994 | 510626.2215
 mpph9    | VIETNAM                   |   1993 | 786734.2542
 mpph9    | VIETNAM                   |   1992 | 511062.6378
(172 rows)

select  'mpph10',
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1994-10-01'
	and o_orderdate < date '1994-10-01' + interval '3 month'
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 ?column? | c_custkey |       c_name       |   revenue   | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                      c_comment                                                      
----------+-----------+--------------------+-------------+-----------+---------------------------+------------------------------------------+-----------------+---------------------------------------------------------------------------------------------------------------------
 mpph10   |       643 | Customer#000000643 | 379216.9236 |   5184.70 | ALGERIA                   | 9T 2avhfyF PQ                            | 10-978-597-2747 | fily along the quickly ironic ideas. final, final
 mpph10   |      1255 | Customer#000001255 | 348227.6139 |   6487.71 | KENYA                     | UC6I32JjBU62t4WgDe e2pDYbuM3VAt4MPM      | 24-359-633-2713 | s deposits sleep. blithely ironic dependencies wake. blithely even theodolites sleep. blithely 
 mpph10   |      1144 | Customer#000001144 | 344762.9152 |   4189.04 | ARGENTINA                 | DGLUWG9evYLNbYhOXVzqZ LdfIMVfBjDf        | 11-336-453-4489 |  ideas. even, regular excuses after the ironic requests cajole blithe
 mpph10   |       871 | Customer#000000871 | 336419.8098 |   -395.89 | SAUDI ARABIA              | KcLmBKitbx7NvU7bpu9clIyccxWG             | 30-933-714-8982 | ts. blithely silent courts doze. regular atta
 mpph10   |       421 | Customer#000000421 | 335198.8566 |   7073.17 | JORDAN                    | it3mUlkZAe9J8gmy                         | 23-918-228-2560 | lithely final deposits haggle furiously above the
 mpph10   |        61 | Customer#000000061 | 332777.6898 |   1536.24 | PERU                      | 9kndve4EAJxhg3veF BfXr7AqOsT39o gtqjaYE  | 27-626-559-8599 | egular packages shall have to impress along the 
 mpph10   |      1121 | Customer#000001121 | 320274.8995 |   3942.11 | SAUDI ARABIA              | o2uc3AHYz,m 3vYg8YxBwI0XuG               | 30-197-936-4724 | usly? final theodolites are carefully 
 mpph10   |       532 | Customer#000000532 | 296758.8028 |   1725.68 | MOROCCO                   | xwWO3lWjgVJTZwhnltyH6zj5ddkzgH8RbF       | 25-875-978-2232 | usly regular deposits kindle. quickly even depos
 mpph10   |       584 | Customer#000000584 | 286297.8180 |   8825.71 | MOROCCO                   | jebKvptmHtS9,YE1qOjl2AOw38P,8skngJZh     | 25-352-778-1041 | ages boost regular deposits. blithely stealthy depo
 mpph10   |       892 | Customer#000000892 | 284479.7745 |   4799.98 | INDONESIA                 | N KwiRAwIk6KL9WJ6vt0G                    | 19-589-784-1249 | ses are carefully. quickly regular theodolites cajole. carefully express accounts wake sly
 mpph10   |       169 | Customer#000000169 | 277234.4946 |   4483.83 | CHINA                     | NjhmHa7xrcjE                             | 28-362-499-3728 | fully unusual pinto beans. blithely express asymptotes lose carefully regular instructions? accounts b
 mpph10   |      1036 | Customer#000001036 | 270725.2873 |   1766.23 | INDIA                     | fxujgj8DOFO6oKrH                         | 18-791-577-7691 | ins sleep. slyly express platelets cajol
 mpph10   |       608 | Customer#000000608 | 268304.6758 |   2256.36 | MOZAMBIQUE                | luMI1JpfrrILCEeTgz8k98z                  | 26-767-193-8671 | ld packages. special requests along the accounts are after the carefully unusual deposits. blithely quiet excuses c
 mpph10   |       635 | Customer#000000635 | 261889.3542 |   8216.79 | BRAZIL                    | Ftqi0UYvzz56Ov,J6,ySp5WE4vJ2rtY          | 12-399-186-7550 | efully bold deposits doubt above the clos
 mpph10   |      1279 | Customer#000001279 | 261726.8460 |   7915.06 | KENYA                     | fkrzLacsqCnwUwgjjttKmY                   | 24-742-587-6985 | tes are. ideas above the carefully ironic d
 mpph10   |      1483 | Customer#000001483 | 256807.2933 |   4409.70 | GERMANY                   | ZjY1C b6cOnY3                            | 17-202-113-4814 | nts sleep around the carefully express theodolites. requests nag 
 mpph10   |        71 | Customer#000000071 | 251773.7061 |   -611.19 | GERMANY                   | TlGalgdXWBmMV,6agLyWYDyIz9MKzcY8gl,w6t1B | 17-710-812-5403 | g courts across the regular, final pinto beans are blithely pending ac
 mpph10   |       664 | Customer#000000664 | 244482.6132 |   8878.22 | MOROCCO                   | viRe1P6HiyL4LXpU7HPwu                    | 25-329-655-5068 | yly ironic requests cajole pending pla
 mpph10   |       883 | Customer#000000883 | 238622.1581 |    479.96 | CANADA                    | qVQ8rWNU5KZYDcS                          | 13-526-239-6950 | uctions are carefully across the regular, regular asymptote
 mpph10   |      1288 | Customer#000001288 | 236676.5999 |   6603.43 | CANADA                    | wQDTTCkSGxic2d66                         | 13-533-256-9320 | equests detect atop the ironic deposits. final requests according to the blithely sp
(20 rows)

select  'mpph11',
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ROMANIA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ROMANIA'
		)
order by
	value desc;
 ?column? | ps_partkey |    value    
----------+------------+-------------
 mpph11   |        917 | 12344895.22
 mpph11   |        685 | 11950940.60
 mpph11   |       1081 | 10580686.59
 mpph11   |       1011 |  9608892.80
 mpph11   |        623 |  9343081.80
 mpph11   |        787 |  8569925.48
 mpph11   |       1185 |  8073895.00
 mpph11   |        367 |  7883443.69
 mpph11   |        109 |  7657641.60
 mpph11   |       1451 |  7613526.60
 mpph11   |       1899 |  7550881.80
 mpph11   |       1842 |  7505106.20
 mpph11   |        213 |  7479470.28
 mpph11   |        161 |  7398630.95
 mpph11   |       1416 |  7287490.02
 mpph11   |       1309 |  7213260.60
 mpph11   |        949 |  7197510.84
 mpph11   |       1323 |  7140115.71
 mpph11   |       1046 |  7046743.50
 mpph11   |         69 |  6970845.15
 mpph11   |       1581 |  6760133.10
 mpph11   |        862 |  6658234.84
 mpph11   |       1283 |  6609824.32
 mpph11   |       1277 |  6599037.12
 mpph11   |        828 |  6565785.62
 mpph11   |       1536 |  6561151.80
 mpph11   |        207 |  6537250.98
 mpph11   |       1085 |  6537104.27
 mpph11   |        751 |  6531660.40
 mpph11   |        360 |  6530297.41
 mpph11   |       1984 |  6495512.50
 mpph11   |        765 |  6460546.80
 mpph11   |       1917 |  6227301.68
 mpph11   |       1716 |  6116013.75
 mpph11   |        730 |  6100067.88
 mpph11   |        994 |  6032702.08
 mpph11   |       1144 |  6012205.92
 mpph11   |       1108 |  5914872.72
 mpph11   |       1950 |  5912352.20
 mpph11   |       1963 |  5873329.44
 mpph11   |         26 |  5867999.40
 mpph11   |        983 |  5846645.17
 mpph11   |       1808 |  5835183.38
 mpph11   |        504 |  5770344.51
 mpph11   |       1016 |  5718859.87
 mpph11   |       1494 |  5687809.60
 mpph11   |       1551 |  5668132.44
 mpph11   |        262 |  5625893.82
 mpph11   |        465 |  5537420.64
 mpph11   |        125 |  5533747.40
 mpph11   |       1972 |  5526059.28
 mpph11   |       1125 |  5514223.46
 mpph11   |        601 |  5513532.30
 mpph11   |        886 |  5450951.91
 mpph11   |        173 |  5409250.08
 mpph11   |       1752 |  5389034.04
 mpph11   |       1644 |  5387317.60
 mpph11   |        526 |  5350481.57
 mpph11   |        895 |  5346555.18
 mpph11   |       1576 |  5301661.68
 mpph11   |        692 |  5269557.57
 mpph11   |        951 |  5264770.02
 mpph11   |        861 |  5214617.22
 mpph11   |       1545 |  5196334.26
 mpph11   |       1356 |  5192649.28
 mpph11   |        789 |  5162645.80
 mpph11   |       1516 |  5107050.00
 mpph11   |       1616 |  5091834.00
 mpph11   |       1116 |  4992110.70
 mpph11   |        551 |  4982558.21
 mpph11   |       1887 |  4934262.24
 mpph11   |        885 |  4876658.57
 mpph11   |        116 |  4852263.60
 mpph11   |        251 |  4747015.56
 mpph11   |        394 |  4624460.10
 mpph11   |       1091 |  4589240.04
 mpph11   |        329 |  4558084.80
 mpph11   |        632 |  4494879.28
 mpph11   |       1485 |  4482428.50
 mpph11   |       1725 |  4340873.16
 mpph11   |        816 |  4326623.61
 mpph11   |        699 |  4310431.00
 mpph11   |        403 |  4283221.60
 mpph11   |       1768 |  4251602.98
 mpph11   |       1158 |  4229896.16
 mpph11   |        591 |  4216726.24
 mpph11   |       1248 |  4157093.60
 mpph11   |       1679 |  4156156.64
 mpph11   |        663 |  4142402.22
 mpph11   |       1719 |  4101486.48
 mpph11   |        395 |  4052997.76
 mpph11   |       1351 |  4045565.12
 mpph11   |        531 |  4042060.39
 mpph11   |       1951 |  4023967.36
 mpph11   |       1294 |  4009307.81
 mpph11   |        616 |  4004057.26
 mpph11   |        316 |  3986943.88
 mpph11   |       1928 |  3964898.76
 mpph11   |       1337 |  3951488.10
 mpph11   |       1851 |  3918641.34
 mpph11   |        521 |  3913058.16
 mpph11   |        883 |  3908087.82
 mpph11   |        961 |  3814756.38
 mpph11   |        366 |  3812257.88
 mpph11   |       1875 |  3800216.84
 mpph11   |        668 |  3772880.16
 mpph11   |        107 |  3756380.24
 mpph11   |       1061 |  3747377.84
 mpph11   |         16 |  3745783.12
 mpph11   |        294 |  3744033.70
 mpph11   |       1561 |  3711744.00
 mpph11   |       1574 |  3702071.64
 mpph11   |       1732 |  3695765.58
 mpph11   |        564 |  3680200.80
 mpph11   |       1371 |  3677874.16
 mpph11   |        516 |  3664770.45
 mpph11   |       1585 |  3641002.20
 mpph11   |        755 |  3635116.80
 mpph11   |        959 |  3620453.76
 mpph11   |        190 |  3559078.95
 mpph11   |       1194 |  3479709.09
 mpph11   |        416 |  3452131.59
 mpph11   |        333 |  3446486.38
 mpph11   |        377 |  3359789.30
 mpph11   |       1455 |  3342304.35
 mpph11   |        289 |  3270429.10
 mpph11   |        689 |  3260147.55
 mpph11   |       1919 |  3239067.00
 mpph11   |       1603 |  3194711.46
 mpph11   |       1438 |  3163393.12
 mpph11   |       1777 |  3107373.72
 mpph11   |         11 |  3035887.92
 mpph11   |       1340 |  3030301.09
 mpph11   |       1287 |  2985392.48
 mpph11   |       1347 |  2983078.12
 mpph11   |       1205 |  2971470.28
 mpph11   |        285 |  2967973.75
 mpph11   |        357 |  2967100.97
 mpph11   |        429 |  2962631.88
 mpph11   |         91 |  2951493.40
 mpph11   |       1161 |  2928475.76
 mpph11   |        914 |  2927894.16
 mpph11   |       1962 |  2925555.12
 mpph11   |       1483 |  2918425.86
 mpph11   |        561 |  2904720.39
 mpph11   |        258 |  2895651.20
 mpph11   |        194 |  2840047.13
 mpph11   |       1671 |  2818290.28
 mpph11   |       1477 |  2777362.76
 mpph11   |       1505 |  2766157.98
 mpph11   |        332 |  2741984.16
 mpph11   |        301 |  2737431.90
 mpph11   |        729 |  2706503.68
 mpph11   |        654 |  2662180.27
 mpph11   |        142 |  2647051.80
 mpph11   |        164 |  2643604.15
 mpph11   |       1662 |  2642551.92
 mpph11   |       1554 |  2639338.38
 mpph11   |        280 |  2631317.56
 mpph11   |       1541 |  2603175.96
 mpph11   |       1610 |  2463001.95
 mpph11   |        407 |  2460304.47
 mpph11   |        199 |  2442107.46
 mpph11   |        534 |  2420752.38
 mpph11   |       1313 |  2408870.75
 mpph11   |       1759 |  2387379.32
 mpph11   |       1115 |  2321227.26
 mpph11   |       1251 |  2311454.53
 mpph11   |       1285 |  2260852.77
 mpph11   |        159 |  2256004.65
 mpph11   |       1973 |  2243745.69
 mpph11   |       1638 |  2232762.96
 mpph11   |       1774 |  2217104.85
 mpph11   |        556 |  2195013.90
 mpph11   |       1694 |  2163305.16
 mpph11   |        819 |  2152055.50
 mpph11   |        992 |  2121582.28
 mpph11   |        785 |  2121133.75
 mpph11   |       1985 |  2069183.28
 mpph11   |        794 |  2059945.54
 mpph11   |        498 |  2055444.32
 mpph11   |       1385 |  2051890.11
 mpph11   |       1916 |  2032768.96
 mpph11   |        361 |  2017055.81
 mpph11   |         76 |  2012711.58
 mpph11   |       1873 |  2000792.40
 mpph11   |         94 |  1986087.48
 mpph11   |       1651 |  1980440.40
 mpph11   |       1059 |  1959087.04
 mpph11   |       1122 |  1942108.90
 mpph11   |        261 |  1928153.10
 mpph11   |       1861 |  1928114.84
 mpph11   |        461 |  1877992.32
 mpph11   |        224 |  1863852.24
 mpph11   |       1242 |  1851493.60
 mpph11   |       1634 |  1743866.22
 mpph11   |        761 |  1741958.65
 mpph11   |       1080 |  1741751.34
 mpph11   |        338 |  1724805.12
 mpph11   |        661 |  1709946.82
 mpph11   |        388 |  1696006.86
 mpph11   |        231 |  1655972.00
 mpph11   |        525 |  1633729.79
 mpph11   |       1906 |  1626282.30
 mpph11   |         85 |  1599847.56
 mpph11   |         60 |  1579401.77
 mpph11   |        926 |  1570368.78
 mpph11   |       1511 |  1569870.02
 mpph11   |       1113 |  1516263.20
 mpph11   |       1089 |  1477486.65
 mpph11   |       1422 |  1435904.00
 mpph11   |        458 |  1433040.45
 mpph11   |       1907 |  1421100.55
 mpph11   |        323 |  1419854.80
 mpph11   |        851 |  1400193.30
 mpph11   |         44 |  1353557.34
 mpph11   |        595 |  1350125.70
 mpph11   |       1822 |  1337990.67
 mpph11   |          1 |  1333528.04
 mpph11   |       1710 |  1331788.48
 mpph11   |         61 |  1322305.60
 mpph11   |        798 |  1313571.96
 mpph11   |        784 |  1309867.02
 mpph11   |        651 |  1307083.56
 mpph11   |       1468 |  1302397.20
 mpph11   |       1149 |  1289607.35
 mpph11   |       1179 |  1242058.40
 mpph11   |        818 |  1225981.68
 mpph11   |       1189 |  1204828.08
 mpph11   |        797 |  1181263.32
 mpph11   |       1375 |  1178128.60
 mpph11   |       1015 |  1164198.48
 mpph11   |       1994 |  1149222.96
 mpph11   |         66 |  1148101.44
 mpph11   |       1929 |  1131697.92
 mpph11   |        240 |  1126682.48
 mpph11   |       1378 |  1121941.05
 mpph11   |        762 |  1109467.26
 mpph11   |        586 |  1108200.58
 mpph11   |        716 |  1107627.42
 mpph11   |        752 |  1102384.63
 mpph11   |       1220 |  1083540.00
 mpph11   |       1675 |  1064600.76
 mpph11   |       1380 |  1020105.06
 mpph11   |        204 |  1014095.32
 mpph11   |       1214 |  1013602.86
 mpph11   |       1186 |  1006354.08
 mpph11   |        927 |  1003227.51
 mpph11   |       1473 |   997508.48
 mpph11   |       1701 |   994231.40
 mpph11   |        168 |   988803.90
 mpph11   |        852 |   977609.14
 mpph11   |        235 |   977200.14
 mpph11   |        501 |   961161.66
 mpph11   |       1620 |   950561.25
 mpph11   |       1709 |   927244.00
 mpph11   |       1565 |   921078.22
 mpph11   |        960 |   913060.80
 mpph11   |        385 |   910892.90
 mpph11   |       1434 |   905713.25
 mpph11   |        658 |   894649.92
 mpph11   |       1865 |   886024.01
 mpph11   |        487 |   883607.88
 mpph11   |       1279 |   877210.28
 mpph11   |       1211 |   875261.76
 mpph11   |        555 |   869246.77
 mpph11   |       1521 |   866284.81
 mpph11   |        427 |   839771.02
 mpph11   |       1628 |   832363.52
 mpph11   |        297 |   832286.88
 mpph11   |       1051 |   824164.90
 mpph11   |        185 |   794405.50
 mpph11   |       1412 |   793718.80
 mpph11   |        432 |   782403.82
 mpph11   |        216 |   776184.13
 mpph11   |       1056 |   772092.44
 mpph11   |        494 |   768524.43
 mpph11   |       1446 |   746482.32
 mpph11   |       1661 |   733795.56
 mpph11   |       1274 |   711073.48
 mpph11   |        451 |   676703.28
 mpph11   |       1685 |   661635.90
 mpph11   |       1143 |   660014.26
 mpph11   |       1318 |   655995.66
 mpph11   |       1531 |   649589.40
 mpph11   |       1514 |   627482.08
 mpph11   |       1612 |   626730.56
 mpph11   |        948 |   622068.66
 mpph11   |        571 |   619871.04
 mpph11   |       1767 |   614422.00
 mpph11   |        351 |   601983.45
 mpph11   |       1499 |   594599.22
 mpph11   |       1941 |   594211.48
 mpph11   |       1153 |   584114.56
 mpph11   |       1257 |   580110.85
 mpph11   |       1461 |   576845.88
 mpph11   |       1361 |   570409.02
 mpph11   |       1250 |   567963.36
 mpph11   |        422 |   530847.10
 mpph11   |       1653 |   525077.35
 mpph11   |       1669 |   513932.46
 mpph11   |       1596 |   505225.82
 mpph11   |        850 |   483358.05
 mpph11   |       1151 |   481433.04
 mpph11   |         86 |   471697.70
 mpph11   |        894 |   465151.80
 mpph11   |         19 |   464872.80
 mpph11   |        474 |   455889.28
 mpph11   |        493 |   455628.44
 mpph11   |        267 |   453340.80
 mpph11   |       1856 |   450086.28
 mpph11   |       1830 |   446553.54
 mpph11   |        456 |   439968.00
 mpph11   |        305 |   421891.68
 mpph11   |       1594 |   417994.09
 mpph11   |       1894 |   414577.35
 mpph11   |       1240 |   413718.76
 mpph11   |         35 |   398837.24
 mpph11   |       1180 |   391898.15
 mpph11   |       1794 |   355474.42
 mpph11   |       1024 |   319659.12
 mpph11   |        594 |   315583.24
 mpph11   |         10 |   314550.82
 mpph11   |       1953 |   314372.14
 mpph11   |       1261 |   312283.65
 mpph11   |       1832 |   308459.25
 mpph11   |       1785 |   300945.33
 mpph11   |        138 |   298832.01
 mpph11   |        753 |   297884.88
 mpph11   |       1790 |   277454.80
 mpph11   |        133 |   262568.64
 mpph11   |         51 |   260089.38
 mpph11   |        620 |   246511.60
 mpph11   |       1961 |   232870.27
 mpph11   |       1224 |   227429.47
 mpph11   |        183 |   225827.28
 mpph11   |       1735 |   219074.20
 mpph11   |       1816 |   218339.50
 mpph11   |       1743 |   217085.97
 mpph11   |        985 |   182239.20
 mpph11   |       1761 |   182100.00
 mpph11   |        464 |   179639.88
 mpph11   |        817 |   170795.52
 mpph11   |        485 |   170664.12
 mpph11   |       1818 |   161250.35
 mpph11   |        630 |   158427.72
 mpph11   |       1571 |   156406.05
 mpph11   |       1094 |   155577.60
 mpph11   |        436 |   147283.92
 mpph11   |        916 |   146788.80
 mpph11   |        310 |   145905.18
 mpph11   |       1751 |   140193.69
 mpph11   |        993 |   136907.25
 mpph11   |       1050 |   136152.30
 mpph11   |       1394 |   120166.11
 mpph11   |       1177 |   115967.72
 mpph11   |        151 |   110222.90
(357 rows)

select  'mpph12',
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('RAIL', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1993-01-01'
	and l_receiptdate < date '1993-01-01' + interval '1 year'
group by
	l_shipmode
order by
	l_shipmode;
 ?column? | l_shipmode | high_line_count | low_line_count 
----------+------------+-----------------+----------------
 mpph12   | MAIL       |              41 |             99
 mpph12   | RAIL       |              54 |            102
(2 rows)

select  'mpph13',
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%express%deposits%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;
 ?column? | c_count | custdist 
----------+---------+----------
 mpph13   |       0 |      500
 mpph13   |      11 |       66
 mpph13   |      10 |       64
 mpph13   |       8 |       63
 mpph13   |      12 |       61
 mpph13   |       9 |       60
 mpph13   |      20 |       58
 mpph13   |      13 |       58
 mpph13   |      14 |       53
 mpph13   |      15 |       48
 mpph13   |       7 |       47
 mpph13   |      18 |       43
 mpph13   |      17 |       40
 mpph13   |      21 |       38
 mpph13   |      16 |       38
 mpph13   |      19 |       36
 mpph13   |       6 |       35
 mpph13   |      22 |       34
 mpph13   |      24 |       32
 mpph13   |      23 |       30
 mpph13   |      25 |       22
 mpph13   |      26 |       19
 mpph13   |       5 |       13
 mpph13   |      27 |       10
 mpph13   |      28 |        9
 mpph13   |       4 |        7
 mpph13   |      32 |        4
 mpph13   |      30 |        4
 mpph13   |      29 |        3
 mpph13   |       3 |        2
 mpph13   |       2 |        2
 mpph13   |      31 |        1
(32 rows)

select  'mpph14',
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1993-01-01'
	and l_shipdate < date '1993-01-01' + interval '1 month';
 ?column? |    promo_revenue    
----------+---------------------
 mpph14   | 11.5452471385458443
(1 row)

create view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= date '1993-01-01'
		and l_shipdate < date '1993-01-01' + interval '3 month'
	group by
		l_suppkey;
select  'mpph15',
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;
 ?column? | s_suppkey |          s_name           |          s_address          |     s_phone     | total_revenue 
----------+-----------+---------------------------+-----------------------------+-----------------+---------------
 mpph15   |        84 | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx | 34-869-118-7803 |  1134618.0543
(1 row)

drop view revenue0;
select 'mpph16',
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	part, 
	partsupp left join supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
 ?column? |  p_brand   |          p_type           | p_size | supplier_cnt 
----------+------------+---------------------------+--------+--------------
 mpph16   | Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 mpph16   | Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 mpph16   | Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 mpph16   | Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 mpph16   | Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 mpph16   | Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 mpph16   | Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 mpph16   | Brand#11   | SMALL PLATED COPPER       |     46 |            4
 mpph16   | Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 mpph16   | Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 mpph16   | Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 mpph16   | Brand#11   | STANDARD PLATED TIN       |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 mpph16   | Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 mpph16   | Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 mpph16   | Brand#12   | LARGE PLATED COPPER       |     46 |            4
 mpph16   | Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 mpph16   | Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 mpph16   | Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 mpph16   | Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 mpph16   | Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 mpph16   | Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 mpph16   | Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 mpph16   | Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 mpph16   | Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 mpph16   | Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 mpph16   | Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 mpph16   | Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 mpph16   | Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 mpph16   | Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 mpph16   | Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 mpph16   | Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 mpph16   | Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 mpph16   | Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 mpph16   | Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 mpph16   | Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 mpph16   | Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 mpph16   | Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 mpph16   | Brand#15   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 mpph16   | Brand#15   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 mpph16   | Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 mpph16   | Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 mpph16   | Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 mpph16   | Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 mpph16   | Brand#21   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 mpph16   | Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 mpph16   | Brand#21   | PROMO PLATED COPPER       |     20 |            4
 mpph16   | Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 mpph16   | Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 mpph16   | Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 mpph16   | Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 mpph16   | Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 mpph16   | Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 mpph16   | Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 mpph16   | Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 mpph16   | Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 mpph16   | Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 mpph16   | Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 mpph16   | Brand#23   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 mpph16   | Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 mpph16   | Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 mpph16   | Brand#23   | SMALL PLATED TIN          |     42 |            4
 mpph16   | Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 mpph16   | Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 mpph16   | Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 mpph16   | Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 mpph16   | Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 mpph16   | Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 mpph16   | Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 mpph16   | Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 mpph16   | Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 mpph16   | Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 mpph16   | Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 mpph16   | Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 mpph16   | Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 mpph16   | Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 mpph16   | Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 mpph16   | Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 mpph16   | Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 mpph16   | Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 mpph16   | Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 mpph16   | Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 mpph16   | Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 mpph16   | Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 mpph16   | Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 mpph16   | Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 mpph16   | Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#32   | SMALL PLATED BRASS        |     31 |            4
 mpph16   | Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 mpph16   | Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 mpph16   | Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 mpph16   | Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 mpph16   | Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 mpph16   | Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 mpph16   | Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 mpph16   | Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 mpph16   | Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 mpph16   | Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 mpph16   | Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 mpph16   | Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 mpph16   | Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 mpph16   | Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 mpph16   | Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 mpph16   | Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 mpph16   | Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 mpph16   | Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 mpph16   | Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 mpph16   | Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 mpph16   | Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 mpph16   | Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 mpph16   | Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 mpph16   | Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#42   | PROMO POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     24 |            4
 mpph16   | Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 mpph16   | Brand#43   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#43   | LARGE PLATED TIN          |     24 |            4
 mpph16   | Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 mpph16   | Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 mpph16   | Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 mpph16   | Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 mpph16   | Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 mpph16   | Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 mpph16   | Brand#45   | LARGE PLATED STEEL        |     22 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#45   | SMALL PLATED COPPER       |     15 |            4
 mpph16   | Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 mpph16   | Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 mpph16   | Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 mpph16   | Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 mpph16   | Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 mpph16   | Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 mpph16   | Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 mpph16   | Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 mpph16   | Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 mpph16   | Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 mpph16   | Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 mpph16   | Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 mpph16   | Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 mpph16   | Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 mpph16   | Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#52   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 mpph16   | Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 mpph16   | Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 mpph16   | Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 mpph16   | Brand#53   | SMALL PLATED STEEL        |     31 |            4
 mpph16   | Brand#53   | SMALL POLISHED TIN        |     42 |            4
 mpph16   | Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 mpph16   | Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 mpph16   | Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 mpph16   | Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 mpph16   | Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 mpph16   | Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 mpph16   | Brand#54   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 mpph16   | Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 mpph16   | Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 mpph16   | Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 mpph16   | Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 mpph16   | Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 mpph16   | Brand#55   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 mpph16   | Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 mpph16   | Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 mpph16   | Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;select 'mpph17',
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

      sum(l_extendedprice) / 7.0 as avg_yearly
from
      lineitem,
      (
          select
              p_partkey as x_partkey,
              0.2 * avg(l_quantity) as x_avg_20
          from
              part,
              lineitem
          where
              p_partkey = l_partkey
              and p_brand = 'Brand#32'
              and p_container = 'JUMBO PACK'
          group by
              p_partkey
      ) x
where
      x_partkey = l_partkey
and l_quantity < x_avg_20;
 ?column? |      avg_yearly       
----------+-----------------------
 mpph17   | 1278.3700000000000000
(1 row)

select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#32'
	and p_container = 'JUMBO PACK'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);
      avg_yearly       
-----------------------
 1278.3700000000000000
(1 row)

select  'mpph18',
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
 ?column? |       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice |  sum   
----------+--------------------+-----------+------------+-------------+--------------+--------
 mpph18   | Customer#000000667 |       667 |      29158 | 10-21-1995  |    439687.23 | 305.00
 mpph18   | Customer#000000178 |       178 |       6882 | 04-09-1997  |    422359.65 | 303.00
(2 rows)

select  'mpph19',
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#53'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);select  'mpph20',
 ?column? |  revenue   
----------+------------
 mpph19   | 10604.0448
(1 row)

	s_name,
	s_address 
from 
	supplier, 
	nation 
where 
	s_suppkey in( 
		select 
			ps_suppkey 
		from 
			partsupp, 
			( 
				select 
					sum(l_quantity) as qty_sum, l_partkey, l_suppkey 
				from 
					lineitem 
				where 
					l_shipdate >= date '1996-01-01' 
					and l_shipdate < date '1996-01-01' + interval '1 year' 
				group by l_partkey, l_suppkey ) g 
		where 
			g.l_partkey = ps_partkey 
			and g.l_suppkey = ps_suppkey 
			and ps_availqty > 0.5 * g.qty_sum 
			and ps_partkey in ( select p_partkey from part where p_name like 'medium%' ) 
		) 
	and s_nationkey = n_nationkey 
	and n_name = 'UNITED STATES'
order by 
	s_name;
 ?column? |          s_name           |                s_address                 
----------+---------------------------+------------------------------------------
 mpph20   | Supplier#000000010        | Saygah3gYWMp72i PY
 mpph20   | Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 mpph20   | Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 mpph20   | Supplier#000000049        | Nvq 6macF4GtJvz
 mpph20   | Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 mpph20   | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					part
				where
					p_name like 'medium%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= date '1996-01-01'
					and l_shipdate < date '1996-01-01' + interval '1 year'
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
order by
	s_name;select  'mpph21',
          s_name           |                s_address                 
---------------------------+------------------------------------------
 Supplier#000000010        | Saygah3gYWMp72i PY
 Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 Supplier#000000049        | Nvq 6macF4GtJvz
 Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

	s_name, 
	count(distinct(l1.l_orderkey::text||l1.l_linenumber::text)) as numwait 
from 
	supplier, 
	orders, 
	nation, 
	lineitem l1 
		left join lineitem l2 
			on (l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) 
		left join (
			select 
				l3.l_orderkey,
				l3.l_suppkey 
			from 
				lineitem l3 
			where 
				l3.l_receiptdate > l3.l_commitdate) l4 
			on (l4.l_orderkey = l1.l_orderkey and l4.l_suppkey <> l1.l_suppkey) 
where 
	s_suppkey = l1.l_suppkey 
	and o_orderkey = l1.l_orderkey 
	and o_orderstatus = 'F' 
	and l1.l_receiptdate > l1.l_commitdate 
	and l2.l_orderkey is not null 
	and l4.l_orderkey is null 
	and s_nationkey = n_nationkey 
	and n_name = 'MOZAMBIQUE' 
group by 
	s_name 
order by 
	numwait desc, 
	s_name
LIMIT 100;
 ?column? |          s_name           | numwait 
----------+---------------------------+---------
 mpph21   | Supplier#000000056        |      18
 mpph21   | Supplier#000000073        |      13
 mpph21   | Supplier#000000018        |      12
 mpph21   | Supplier#000000058        |      10
 mpph21   | Supplier#000000030        |       9
 mpph21   | Supplier#000000093        |       9
 mpph21   | Supplier#000000031        |       6
(7 rows)

select  'mpph22',
	cntrycode, 
	count(*) as numcust, 
	sum(c_acctbal) as totacctbal 
from 
	( 
		select 
			substring(c_phone from 1 for 2) as cntrycode, 
			c_acctbal 
		from 
			customer left join orders 
				on c_custkey = o_custkey 
		where 
			substring(c_phone from 1 for 2) in 
				('11', '28', '21', '26', '19', '13', '22') 
			and c_acctbal > ( 
				select 
					avg(c_acctbal) 
				from 
					customer 
				where 
					c_acctbal > 0.00 
					and substring(c_phone from 1 for 2) in 
						('11', '28', '21', '26', '19', '13', '22') 
			) 
			and o_custkey is null 
	) as custsale 
group by 
	cntrycode 
order by 
	cntrycode;
 ?column? | cntrycode | numcust | totacctbal 
----------+-----------+---------+------------
 mpph22   | 11        |      11 |   82845.34
 mpph22   | 13        |      10 |   75359.29
 mpph22   | 19        |      17 |  132118.07
 mpph22   | 21        |       9 |   73087.05
 mpph22   | 22        |       9 |   65544.55
 mpph22   | 26        |       6 |   47747.11
 mpph22   | 28        |      10 |   79310.33
(7 rows)

select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('11', '28', '21', '26', '19', '13', '22')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('11', '28', '21', '26', '19', '13', '22')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;
 cntrycode | numcust | totacctbal 
-----------+---------+------------
 11        |      11 |   82845.34
 13        |      10 |   75359.29
 19        |      17 |  132118.07
 21        |       9 |   73087.05
 22        |       9 |   65544.55
 26        |       6 |   47747.11
 28        |      10 |   79310.33
(7 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	part, 
	partsupp left join supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

