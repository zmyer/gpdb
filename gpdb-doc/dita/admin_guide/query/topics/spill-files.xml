<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Composite//EN" "ditabase.dtd">

<topic id="topic_bvh_cg4_t4">
  <title>Managing Spill Files Generated by Queries</title>
  <abstract><shortdesc>Greenplum Database creates spill files, also known as workfiles, on disk if
      it does not have sufficient memory to execute an SQL query in memory. </shortdesc>The default
    value of 100,000 spill files is sufficient for the majority of queries. However, if a query
    creates more than the specified number of spill files, Greenplum Database returns this
    error:</abstract>

  <body>

    <codeblock>ERROR: number of workfiles per query limit exceeded</codeblock>

    <p>Reasons that cause a large number of spill files to be generated include:<ul
        id="ul_dl2_1j4_t4">
        <li>Data skew is present in the queried data.</li>
        <li>The amount memory allocated for the query is too low.</li>
      </ul></p>

    <p>You might be able to run the query successfully by changing the query, changing the data
      distribution, or changing the system memory configuration. You can use the
        <i>gp_workfile_*</i> views to see spill file usage information. You can control the maximum
      amount of memory that can used by a query with the Greenplum Database server configuration
      parameters <codeph>max_statement_mem</codeph>, <codeph>statement_mem</codeph>, or through
      resource queues.</p>

    <p><xref href="../../managing/monitor.xml#topic1"/> contains the following information: <ul
        id="ul_pdp_kj4_t4">
        <li>Information about skew and how to check for data skew</li>
        <li>Information about using the <i>gp_workfile_* views</i></li>
      </ul></p>

    <p>For information about server configuration parameters, see the <i>Greenplum Database
        Reference Guide</i>. For information about resource queues, see <xref
        href="../../workload_mgmt.xml#topic1"/>.</p>

    <p>If you have determined that the query must create more spill files than allowed by the value
      of server configuration parameter <codeph>gp_workfile_limit_files_per_query</codeph>, you can
      increase the value of the parameter.</p>
  </body>
</topic>
